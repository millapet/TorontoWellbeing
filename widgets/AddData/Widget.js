// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/AddData/search/SearchContext":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(m,c){return m(null,{allowArcGISOnline:!0,arcgisOnlinePortal:null,orgId:null,portal:null,username:null,constructor:function(n){c.mixin(this,n)}})})},"widgets/AddData/search/util":function(){define(["dojo/_base/array"],function(m){return{checkMixedContent:function(c){"string"===typeof window.location.href&&0===window.location.href.indexOf("https://")&&"string"===typeof c&&0===c.indexOf("http://")&&
(c="https:"+c.substring("5"));return c},endsWith:function(c,n){return-1!==c.indexOf(n,c.length-n.length)},escapeForLucene:function(c){return c.replace(/(\+|\-|\&|\!|\(|\)|\{|\}|\[|\]|\^|\"|\~|\*|\?|\:|\\)/g,"\\$1")},findLayersAdded:function(c,n){var g=[],f=[],t=[],a={itemIds:f,layers:t};if(!c)return a;var u="string"===typeof n&&0<n.length;m.forEach(c.layerIds,function(a){g.push(a)});m.forEach(c.graphicsLayerIds,function(a){g.push(a)});m.forEach(g,function(a){(a=c.getLayer(a))&&"string"===typeof a.xtnItemId&&
0<a.xtnItemId.length&&(!u||a.xtnItemId===n)&&(t.push(a),-1===f.indexOf(a.xtnItemId)&&f.push(a.xtnItemId))});return a},setNodeText:function(c,n){c.innerHTML="";n&&c.appendChild(document.createTextNode(n))},setNodeTitle:function(c,n){c.title="";n&&c.setAttribute("title",n)},setNodeHTML:function(c,n){c.innerHTML="";n&&(c.innerHTML=n)}}})},"widgets/AddData/search/SearchPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SearchPane.html dojo/i18n!../nls/strings ./SearchBox ./BBoxOption ./ScopeOptions ./TypeOptions ./SortOptions ./ResultsPane ./Paging ./ResultCount".split(" "),
function(m,c,n,g,f,t,a,u,q,v){return m([t,a,u],{i18n:v,templateString:q,qDefaultFilter:null,qRequiredFilter:null,searchOnStart:!0,searchContext:null,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);n.forEach(this.getComponents(),function(a){a.searchPane=this},this)},startup:function(){this._started||(this.inherited(arguments),this.bindEvents(),this.searchOnStart&&this.search())},_onFilterPlaceholderChanged:function(){f.contains(this.filterPlaceholder,"opened")?(f.remove(this.filterPlaceholder,
"opened"),f.remove(this.filterWrapper,"show")):(this.filterWrapper.style.top=this.headerNode.clientHeight+"px",f.add(this.filterPlaceholder,"opened"),f.add(this.filterWrapper,"show"))},_onSearchBoxPlaceholderChanged:function(){},bindEvents:function(){this.own(g(this.filterPlaceholder,"click",c.hitch(this,this._onFilterPlaceholderChanged)))},buildQueryParams:function(a){var c=null;"string"===typeof this.qRequiredFilter&&0<this.qRequiredFilter.length&&(c=this.qRequiredFilter);var f={q:c,canSortByRelevance:!1};
n.forEach(this.getComponents(),function(c){c.appendQueryParams(f,a)});delete f.canSortByRelevance;null===f.q&&"string"===typeof this.qDefaultFilter&&0<this.qDefaultFilter.length&&(f.q=this.qDefaultFilter);return f},getComponents:function(){return[this.searchBox,this.bboxOption,this.scopeOptions,this.typeOptions,this.sortOptions,this.resultsPane,this.paging,this.resultCount]},resize:function(){this.contentNode.style.top=this.headerNode.clientHeight+1+"px"},search:function(){var a=this,c={},f=this.buildQueryParams(c);
if(null!==f&&null!==f.q){f&&null===f.sortField&&(f.sortOrder="desc");var u=this.searchContext.portal;c.scopeIsArcGISOnline&&this.searchContext.arcgisOnlinePortal&&(u=this.searchContext.arcgisOnlinePortal);null!==this._dfd&&this._dfd.cancel("Search aborted.",!1);var q=null;this._dfd=q=u.queryItems(f).then(function(c){q.isCanceled()||(c.queryParams||(c.queryParams={start:c.start,num:c.num},c.nextQueryParams||"undefined"===typeof c.nextStart||-1===c.nextStart||(c.nextQueryParams={start:c.nextStart})),
n.forEach(a.getComponents(),function(a){a.processResults(c)}))}).otherwise(function(a){console.warn("searchError",a)})}},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()}})})},"widgets/AddData/search/SearchBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys ./SearchComponent dojo/text!./templates/SearchBox.html dojo/i18n!../nls/strings".split(" "),function(m,c,n,g,f,t,a){return m([f],{i18n:a,templateString:t,postCreate:function(){this.inherited(arguments);
this._checkClearButton();this.own(n(this.searchTextBox,"keyup",c.hitch(this,function(a){this._checkClearButton();a.keyCode===g.ENTER&&this.search()})))},_checkClearButton:function(){},clearButtonClicked:function(){this.searchTextBox.value="";this._checkClearButton();this.search()},searchButtonClicked:function(){this.search()},appendQueryParams:function(a){var f=this.searchTextBox.value;null!==f&&(f=c.trim(f));null!==f&&0<f.length&&(a.canSortByRelevance=!0,f="("+f+")",a.q=null!==a.q&&0<a.q.length?
a.q+(" AND "+f):f)}})})},"widgets/AddData/search/SearchComponent":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin"],function(m,c,n,g){return m([c,n,g],{isSearchComponent:!0,searchPane:null,template:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments)},appendQueryParams:function(c,g){},processResults:function(c){},getConfig:function(){return this.searchPane&&this.searchPane.wabWidget&&this.searchPane.wabWidget.config?
this.searchPane.wabWidget.config:{}},getMap:function(){return this.searchPane&&this.searchPane.wabWidget?this.searchPane.wabWidget.map:null},search:function(){this.searchPane&&this.searchPane.search()}})})},"widgets/AddData/search/BBoxOption":function(){define(["dojo/_base/declare","./SearchComponent","dojo/text!./templates/BBoxOption.html","dojo/i18n!../nls/strings","dijit/form/CheckBox"],function(m,c,n,g){return m([c],{i18n:g,templateString:n,postCreate:function(){this.inherited(arguments);this.bboxToggle.set("checked",
!0)},bboxClicked:function(){this.search()},_getBBox:function(){var c;if(c=this.getMap())if(c=c.geographicExtent)return c.xmin+","+c.ymin+","+c.xmax+","+c.ymax;return null},appendQueryParams:function(c){if(this.bboxToggle.get("checked")){var f=this._getBBox();null!==f&&(c.canSortByRelevance=!0,c.bbox=f)}}})})},"widgets/AddData/search/ScopeOptions":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-class ./SearchComponent dojo/text!./templates/ScopeOptions.html dojo/i18n!../nls/strings ./util".split(" "),
function(m,c,n,g,f,t,a,u){return m([f],{i18n:a,templateString:t,curatedFilter:null,postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this.inherited(arguments),this.initOptions())},hideDropdown:function(){g.remove(this.scopePlaceholder,"opened");g.remove(this.btnGroup,"show")},initOptions:function(){var f=this.searchPane.searchContext,n="string"===typeof f.username&&0<f.username.length,m=this.getConfig().scopeOptions;this.curatedFilter=m.Curated.filter;var B=null,
f=function(f,g){var q=m[f];q&&q.allow?("string"===typeof q.label&&0<c.trim(q.label).length?u.setNodeText(g,c.trim(q.label)):n||"MyOrganization"!==f||u.setNodeText(g,a.search.scopeOptions.anonymousContent),m.defaultScope===f&&(B=g)):g.style.display="none"};f("MyContent",this.MyContentToggle);f("MyOrganization",this.MyOrganizationToggle);f("Curated",this.CuratedToggle);f("ArcGISOnline",this.ArcGISOnlineToggle);B||(m.MyOrganization.allow?B=this.MyOrganizationToggle:m.ArcGISOnline.allow?B=this.ArcGISOnlineToggle:
m.Curated.allow?B=this.CuratedToggle:m.MyContent.allow&&(B=this.MyContentToggle));B&&(g.add(B,"active"),this.scopePlaceholderText.innerHTML=B.innerHTML)},optionClicked:function(a){this.toggleClassName(a);this.hideDropdown();this.search()},scopePlaceholderClicked:function(a){a.preventDefault();g.contains(this.scopePlaceholder,"opened")?this.hideDropdown():this.showDropdown()},showDropdown:function(){g.add(this.scopePlaceholder,"opened");g.add(this.btnGroup,"show")},toggleClassName:function(a){n.forEach(this.btnGroup.children,
function(a){g.remove(a,"active")});g.add(a.target,"active");this.scopePlaceholderText.innerHTML=a.target.innerHTML},appendQueryParams:function(a,c){var f=null;n.some(this.btnGroup.children,function(a){if(g.contains(a,"active"))return f=a.getAttribute("data-option-name"),!0});"undefined"===typeof f&&(f=null);var m=null,q=this.curatedFilter,v=this.searchPane.searchContext,t=v.username,z=v.orgId;"MyContent"===f?"string"===typeof t&&0<t.length&&(m="(owner:"+u.escapeForLucene(t)+")"):"MyOrganization"===
f?"string"===typeof z&&0<z.length&&(m="(orgid:"+u.escapeForLucene(z)+")"):"Curated"===f?"string"===typeof q&&0<q.length&&(m=q):"ArcGISOnline"===f&&v.allowArcGISOnline&&(c.scopeIsArcGISOnline=!0);null!==m&&0<m.length&&(m="("+m+")",a.q=null!==a.q&&0<a.q.length?a.q+(" AND "+m):m)}})})},"widgets/AddData/search/TypeOptions":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on ./SearchComponent dojo/text!./templates/TypeOptions.html dojo/i18n!../nls/strings esri/layers/VectorTileLayer dijit/TooltipDialog dijit/form/DropDownButton jimu/dijit/CheckBox".split(" "),
function(m,c,n,g,f,t,a,u){return m([f],{i18n:a,templateString:t,postCreate:function(){this.inherited(arguments);u&&u.supported()||(console.warn("AddData: Vector Tile is not supported."),this.vectorTileNode.style.display="none");this.own(g(this.tooltipDialog,"open",n.hitch(this,function(){this.tooltipDialog.domNode.className+=" "+this.searchPane.wabWidget.appConfig.theme.name})));this.own(g(this.mapServiceToggle,"change",n.hitch(this,function(){this.search()})));this.own(g(this.featureServiceToggle,
"change",n.hitch(this,function(){this.search()})));this.own(g(this.imageServiceToggle,"change",n.hitch(this,function(){this.search()})));this.own(g(this.vectorTileServiceToggle,"change",n.hitch(this,function(){this.search()})));this.own(g(this.kmlToggle,"change",n.hitch(this,function(){this.search()})));this.own(g(this.wmsToggle,"change",n.hitch(this,function(){this.search()})))},getOptionWidgets:function(){return[this.mapServiceToggle,this.featureServiceToggle,this.imageServiceToggle,this.vectorTileServiceToggle,
this.kmlToggle,this.wmsToggle]},optionClicked:function(){},appendQueryParams:function(a){var f=function(a,c){0<a.length&&(a+=" OR ");return a+c},g="",u="",n=!1;c.forEach(this.getOptionWidgets(),function(a){var c=a.domNode.getAttribute("data-option-q");u=f(u,c);a.getValue()&&(g=f(g,c),n=!0)});n||(g=u);null!==g&&0<g.length&&(g="("+g+")",a.q=null!==a.q&&0<a.q.length?a.q+(" AND "+g):g)}})})},"esri/layers/VectorTileLayer":function(){(function(){var m=function(){var c;try{c=window.WebGLRenderingContext}catch(q){c=
!1}var g;try{for(var f=document.createElement("canvas"),m=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a=null,u=0;u<m.length;++u){try{a=f.getContext(m[u])}catch(q){}if(a)break}g=a}catch(q){g=!1}return c&&g?!0:!1}(),c=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];m&&c.push("./VectorTileLayerImpl");define(c,function(c,g,f,t,a,u){a=u?u:a.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var a=new f;a.reject(Error("esri.layers.VectorTileLayer is not supported"));
a.promise.otherwise(c.hitch(this,function(a){this._errorHandler(a)}))}});a.ACCESS_TOKEN=null;a.supported=function(){return m};g("extend-esri")&&c.setObject("layers.VectorTileLayer",a,t);return a})})()},"widgets/AddData/search/SortOptions":function(){define("dojo/_base/declare dojo/on dojo/dom-class ./SearchComponent dojo/text!./templates/SortOptions.html dojo/i18n!../nls/strings dijit/form/Select".split(" "),function(m,c,n,g,f,t){return m([g],{i18n:t,templateString:f,sortField:null,sortOrder:null,
postCreate:function(){this.inherited(arguments);this.updateSortOrderButton();var a=this;this.own(this.sortSelect.on("change",function(){var c=a.sortField=a.sortSelect.get("value");if(""===c)a.sortOrder=null;else if("title"===c||"owner"===c)a.sortOrder="asc";else if("avgrating"===c||"numviews"===c||"modified"===c)a.sortOrder="desc";a.updateSortOrderButton();a.search()}));this.own(c(this.sortSelect.dropDown,"open",function(){var a=this.domNode.parentElement;a&&n.add(a,"add-data-widget-popup")}))},sortOrderClicked:function(){"asc"===
this.sortOrder?(this.sortOrder="desc",this.updateSortOrderButton(),this.search()):"desc"===this.sortOrder&&(this.sortOrder="asc",this.updateSortOrderButton(),this.search())},updateSortOrderButton:function(){var a=this.sortOrderBtn;a.style.visibility=null!==this.sortField&&0<this.sortField.length?"visible":"hidden";"desc"===this.sortOrder?n.add(a,"descending"):n.remove(a,"descending")},appendQueryParams:function(a){a.sortField=null;a.sortOrder=null;var c=this.sortField,f=this.sortOrder;null!==c&&0<
c.length?(a.sortField=c,null!==f&&0<f.length&&(a.sortOrder=f)):a.canSortByRelevance||(a.sortField="numviews",a.sortOrder="desc")}})})},"widgets/AddData/search/ResultsPane":function(){define("dojo/_base/declare dojo/_base/array ./SearchComponent dojo/text!./templates/ResultsPane.html dojo/i18n!../nls/strings ./ItemCard ./util".split(" "),function(m,c,n,g,f,t,a){return m([n],{i18n:f,templateString:g,postCreate:function(){this.inherited(arguments)},addItem:function(a){a.placeAt(this.itemsNode)},destroyItems:function(){this.noMatchNode.style.display=
"none";this.noMatchNode.innerHTML="";this.destroyDescendants(!1)},showNoMatch:function(){a.setNodeText(this.noMatchNode,f.search.resultsPane.noMatch);this.noMatchNode.style.display="block"},processResults:function(f){this.destroyItems();var g=f.results;if(g&&0<g.length){var m=a.findLayersAdded(this.getMap(),null).itemIds;c.forEach(f.results,function(a){this.addItem(new t({item:a,canRemove:-1!==m.indexOf(a.id),resultsPane:this}))},this)}else this.showNoMatch()}})})},"widgets/AddData/search/ItemCard":function(){define("dojo/_base/declare dojo/_base/array dojo/date/locale dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemCard.html dojo/i18n!../nls/strings ./util ./LayerLoader".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D){return m([f,t,a],{i18n:q,templateString:u,canRemove:!1,item:null,resultsPane:null,_dfd:null,postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this.inherited(arguments),this.render())},addClicked:function(){var a=this,f=this.addButton;if(!g.contains(f,"disabled"))if(g.add(f,"disabled"),this.canRemove){var m=this.resultsPane.getMap();v.setNodeText(a.messageNode,q.search.item.messages.removing);var n=v.findLayersAdded(m,this.item.id).layers;
c.forEach(n,function(a){m.removeLayer(a)});this.canRemove=!1;v.setNodeText(a.messageNode,"");v.setNodeText(this.addButton,q.search.item.actions.add);g.remove(f,"disabled")}else v.setNodeText(a.messageNode,q.search.item.messages.adding),(new D).addItem(this.item,this.resultsPane.getMap()).then(function(c){c?(a.canRemove=!0,v.setNodeText(a.messageNode,""),v.setNodeText(a.addButton,q.search.item.actions.remove)):v.setNodeText(a.messageNode,q.search.item.messages.addFailed);g.remove(f,"disabled")}).otherwise(function(c){console.warn("Add layer failed.");
console.warn(c);v.setNodeText(a.messageNode,q.search.item.messages.addFailed);g.remove(f,"disabled");c&&"string"===typeof c.message&&0<c.message.length&&console.log("")})},detailsClicked:function(){var a=this.item,a=v.checkMixedContent(a.portalUrl)+"/home/item.html?id\x3d"+encodeURIComponent(a.id);window.open(a)},formatDate:function(a){"number"===typeof a&&(a=new Date(a));return n.format(a,{selector:"date",datePattern:q.search.item.dateFormat})},render:function(){v.setNodeText(this.titleNode,this.item.title);
v.setNodeTitle(this.titleNode,this.item.title);this._renderThumbnail();this._renderTypeOwnerDate();this.canRemove&&v.setNodeText(this.addButton,q.search.item.actions.remove)},_renderThumbnail:function(){var a=this.thumbnailNode,c=this.item.thumbnailUrl;a.innerHTML="";var c=v.checkMixedContent(c),f=document.createElement("IMG");f.src=c||"widgets/AddData/images/placeholder_120x80.png";a.appendChild(f)},_renderTypeOwnerDate:function(){var a,c=this.item;a=q.search.item.types[c.type];if("undefined"===
typeof a||null===a)a=c.type;a=q.search.item.typeByOwnerPattern.replace("{type}",a);a=a.replace("{owner}",c.owner);v.setNodeText(this.typeByOwnerNode,a)}})})},"widgets/AddData/search/LayerLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/json dojo/i18n!../nls/strings ./util esri/lang esri/request esri/arcgis/utils esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/DynamicLayerInfo esri/layers/FeatureLayer esri/layers/ImageParameters esri/layers/ImageServiceParameters esri/layers/KMLLayer esri/layers/LayerDrawingOptions esri/layers/MosaicRule esri/layers/RasterFunction esri/layers/VectorTileLayer esri/layers/WMSLayer esri/layers/WMSLayerInfo esri/dijit/PopupTemplate esri/InfoTemplate esri/renderers/jsonUtils esri/geometry/Extent esri/SpatialReference jimu/utils".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F,H,e,h,A,x,y,J,r,b,d,p,l,k,K){return m(null,{item:null,itemUrl:null,map:null,serviceUrl:null,constructor:function(b){c.mixin(this,b)},addItem:function(b,l){var d=new f;this.map=l;this.item=b;this.itemUrl=this._checkMixedContent(b.itemUrl);this.serviceUrl=this._checkMixedContent(b.url);if("Feature Service"===b.type)return this._addFeatureService();if("Image Service"===b.type)return this._addImageService();if("KML"===b.type)return this._addKML();if("Map Service"===
b.type)return this._addMapService();if("Vector Tile Service"===b.type)return this._addVectorTileService();if("WMS"===b.type)return this._addWMS();console.warn("Unsupported item type: ",b.type);d.resolve(null);return d},_addFeatureService:function(){var b=this,d=new f,l=this.serviceUrl,k=this.item,p={},a=null,r=[],e=[];b._readItemJsonData().then(function(d){(p=d||{},p.layers)&&0<p.layers.length&&n.forEach(p.layers,function(b){"undefined"!==typeof b.id&&null!==b.id&&(null===a&&(a=[]),a.push(b.id))});
return b._readRestInfo(l)}).then(function(d){if(!d||"string"!==typeof d.type||"Feature Layer"!==d.type&&"Table"!==d.type){var k=[];d&&d.layers&&0<d.layers.length&&n.forEach(d.layers,function(b){k.push(b)});d&&d.tables&&0<d.tables.length&&n.forEach(d.tables,function(b){k.push(b)});0<k.length?n.forEach(k,function(d){var k=!0;null!==a&&0<a.length&&(k=n.some(a,function(b){return b===d.id}));k&&(k=new z(l+"/"+d.id,{id:b._generateLayerId(),outFields:["*"]}),r.push(b._waitForLayer(k)))}):console.warn("No layers or tables...")}else d=
new z(l,{id:b._generateLayerId(),outFields:["*"]}),r.push(b._waitForLayer(d));return g(r)}).then(function(b){n.forEach(b,function(b){e.push(b)});e.reverse();return e}).then(function(){n.forEach(e,function(d){var l=b._processFeatureLayer(d,k,p);d.arcgisProps={title:l.title};d._titleForLegend=l.title;q.isDefined(d.title)||(d.title=l.title);b._addLayer(d)})}).then(function(){d.resolve(e)}).otherwise(function(b){d.reject(b)});return d},_addImageService:function(){var b=this,d=new f;b._readItemJsonData().then(function(d){return b._newImageServiceLayer(d||
{})}).then(function(l){b._addLayer(l);d.resolve(l)}).otherwise(function(b){d.reject(b)});return d},_addKML:function(){var b=this,d=new f;b._newKMLLayer().then(function(l){l&&(l.title=b.item.title);b._addLayer(l);d.resolve(l)}).otherwise(function(b){d.reject(b)});return d},_addMapService:function(){var b=this,d=new f;b._readItemJsonData().then(function(d){return b._newMapServiceLayer(d||{})}).then(function(l){b._addLayer(l);d.resolve(l)}).otherwise(function(b){d.reject(b)});return d},_addVectorTileService:function(){var b=
this,d=new f;b._newVectorTileLayer().then(function(l){b._addLayer(l);d.resolve(l)}).otherwise(function(b){d.reject(b)});return d},_addWMS:function(){var b=this,d=new f;b._readItemJsonData().then(function(d){return b._newWMSLayer(d||{})}).then(function(l){l&&(l.title=b.item.title);b._addLayer(l);d.resolve(l)}).otherwise(function(b){d.reject(b)});return d},_addLayer:function(b){var d=this.item;b&&(b.xtnItemId=d.id,b.xtnAddData=!0,!b.arcgisProps&&d&&(b.arcgisProps={title:d.title},b._titleForLegend=d.title),
q.isDefined(b.title)||(b.title=d.title),b._wabProperties={itemLayerInfo:{itemId:d.id,itemUrl:this.itemUrl,portalUrl:d.portalUrl}},this.map.addLayer(b))},_checkMixedContent:function(b){return u.checkMixedContent(b)},_checkUrl:function(b){return D._checkUrl(b)},_checkVectorTileUrl:function(b,d){var l=new f;if(function(b,d){return-1!==b.indexOf(d,b.length-d.length)}(b,".json"))return d.styleUrl=b,l.resolve(b),l;var k={url:null,content:{},handleAs:"json",callbackParamName:"callback"};this.itemUrl?(k.url=
this.itemUrl+"/resources/styles/root.json",v(k,{}).then(function(){d.styleUrl=k.url;l.resolve(k.url)}).otherwise(function(){k.url=b+"/resources/styles/root.json";v(k,{}).then(function(){d.styleUrl=k.url;l.resolve(k.url)}).otherwise(function(){d.url=b;l.resolve(b)})})):(k.url=b+"/resources/styles/root.json",v(k,{}).then(function(){d.styleUrl=k.url;l.resolve(k.url)}).otherwise(function(){d.url=b;l.resolve(b)}));return l},_generateLayerId:function(){return this._generateLayerIds(1)[0]},_generateLayerIds:function(b){var d,
l=[];for(d=0;d<b;d++)l.push(this._generateRandomId());return l},_generateRandomId:function(){var b=null,b="function"===typeof Date.now?Date.now():(new Date).getTime(),d=(""+Math.random()).replace("0.","r");return(b+""+d).replace(/-/g,"")},_makeFeatureLayerTitle:function(b,d,l){var k,p,C;try{if(d&&l&&d===l||d&&l&&(k=l.indexOf(d),0===k&&(p=l.substring(k+d.length+1),13<=p.length&&(C=/^\d+$/,C.test(p)))))return d}catch(P){}return b.replace("{serviceName}",d).replace("{layerName}",l)},_newImageServiceLayer:function(d){var l=
new f,k=this._generateLayerId(),p=this.serviceUrl,a={mapLayerId:k,bandIds:null,format:null,compressionQuality:null,opacity:1,visibility:!0};q.isDefined(d.visibility)&&!1===d.visibility&&(a.visibility=!1);q.isDefined(d.opacity)&&(a.opacity=d.opacity);q.isDefined(d.minScale)&&!q.isDefined(a.minScale)&&(a.minScale=d.minScale);q.isDefined(d.maxScale)&&!q.isDefined(a.maxScale)&&(a.maxScale=d.maxScale);q.isDefined(d.refreshInterval)&&!q.isDefined(a.refreshInterval)&&(a.refreshInterval=d.refreshInterval);
!d.popupInfo||a.popupInfo||a.disablePopup||(a.popupInfo=d.popupInfo);d.renderingRule&&!a.renderingRule&&(a.renderingRule=d.renderingRule,d.renderingRule.functionName&&(a.renderingRule.rasterFunction=d.renderingRule.functionName));d.bandIds&&!a.bandIds&&(a.bandIds=d.bandIds);d.mosaicRule&&!a.mosaicRule&&(a.mosaicRule=d.mosaicRule);d.format&&!a.format&&(a.format=d.format);q.isDefined(d.compressionQuality)&&!q.isDefined(a.compressionQuality)&&(a.compressionQuality=d.compressionQuality);!d.layerDefinition||
!d.layerDefinition.definitionExpression||q.isDefined(a.layerDefinition)&&q.isDefined(a.layerDefinition.definitionExpression)||(a.layerDefinition=a.layerDefinition||{},a.layerDefinition.definitionExpression=d.layerDefinition.definitionExpression);d=new H;null!==a.bandIds&&(d.bandIds=a.bandIds);null!==a.format&&(d.format=a.format,null!==a.compressionQuality&&(d.compressionQuality=a.compressionQuality));a.renderingRule&&a.renderingRule.rasterFunction&&(k=new x(a.renderingRule),d.renderingRule=k);a.mosaicRule&&
(k=new A(a.mosaicRule),d.mosaicRule=k);q.isDefined(a.noData)&&(d.noData=a.noData);q.isDefined(a.noDataInterpretation)&&(d.noDataInterpretation=a.noDataInterpretation);q.isDefined(a.interpolation)&&(d.interpolation=a.interpolation);d={imageServiceParameters:d,opacity:a.opacity,visible:a.visibility};q.isDefined(a.mapLayerId)&&(d.id=a.mapLayerId);q.isDefined(a.minScale)&&(d.minScale=a.minScale);q.isDefined(a.maxScale)&&(d.maxScale=a.maxScale);q.isDefined(a.refreshInterval)&&(d.refreshInterval=a.refreshInterval);
q.isDefined(a.resourceInfo)&&(d.resourceInfo=a.resourceInfo);p=new G(this._checkUrl(p),d);this._waitForLayer(p).then(function(d){a.layerDefinition&&a.layerDefinition.definitionExpression&&d.setDefinitionExpression(a.layerDefinition.definitionExpression,!0);!a.disablePopup&&a.popupInfo&&d.setInfoTemplate(new b(a.popupInfo));l.resolve(d)},function(b){l.reject(b)});return l},_newInfoTemplate:function(l,k){if(l)try{return new b({description:l.description,title:l.title,showAttachments:l.showAttachments,
fieldInfos:l.fieldInfos,mediaInfos:l.mediaInfos})}catch(L){console.error(L)}l=new d;q.isDefined(k)&&l.setTitle(k);return l},_newKMLLayer:function(){var b={id:this._generateLayerId()},b=new e(this.serviceUrl,b);return this._waitForLayer(b)},_newMapServiceLayer:function(b){var d=this,l=new f,k=this.serviceUrl,p=this._generateLayerId();v({url:k,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{}).then(function(a){var r=null,r={id:p};if(a.tileInfo)r=new w(k,r);else if(a&&a.supportedImageFormatTypes&&
-1!==a.supportedImageFormatTypes.indexOf("PNG32")&&(r.imageParameters=new F,r.imageParameters.format="png32"),r=new B(k,r),b&&b.layers&&0<b.layers.length){var e=[],C,K=[],y,H=[],I;n.forEach(b.layers,function(d){d.layerDefinition&&d.layerDefinition.definitionExpression&&(e[d.id]=d.layerDefinition.definitionExpression);if(d.layerDefinition&&d.layerDefinition.source){C=null;I=d.layerDefinition.source;if("mapLayer"===I.type){var l=n.filter(a.layers,function(b){return b.id===I.mapLayerId});l.length&&(C=
c.mixin(l[0],d))}else C=c.mixin({},d);C&&(C.source=I,delete C.popupInfo,C=new E(C),b.visibleLayers&&(l="string"===typeof b.visibleLayers?b.visibleLayers.split(","):b.visibleLayers,-1<n.indexOf(l,d.id)?C.defaultVisibility=!0:C.defaultVisibility=!1),K.push(C))}d.layerDefinition&&d.layerDefinition.source&&d.layerDefinition.drawingInfo&&(y=new h(d.layerDefinition.drawingInfo),H[d.id]=y)});0<e.length&&r.setLayerDefinitions(e);0<K.length&&(r.setDynamicLayerInfos(K,!0),0<H.length&&r.setLayerDrawingOptions(H,
!0))}d._waitForLayer(r).then(function(k){var p=null;n.forEach(k.layerInfos,function(l){var k=null;b&&n.some(b.layers,function(b){if(l.id===b.id)return k=b,!0});var a=null;k&&k.popupInfo&&(a=k.popupInfo);a&&(null===p&&(p={}),p[l.id]={infoTemplate:d._newInfoTemplate(a,l.name)})});null===k.infoTemplates&&(p?k.infoTemplates=p:d._setDynamicLayerInfoTemplates(k));l.resolve(k)},function(b){l.reject(b)})},function(b){l.reject(b)});return l},_getVisibleFeatureLayers:function(b,d){if(!b||!d||0===d.length)return[];
d=","+d+",";var l=[],k,p=",";for(k=0;k<b.length;k++)if(null!==b[k].subLayerIds){if(-1===d.indexOf(","+b[k].id+",")||-1<p.indexOf(","+b[k].id+","))p+=b[k].subLayerIds.toString()+","}else-1<d.indexOf(","+b[k].id+",")&&-1===p.indexOf(","+b[k].id+",")&&l.push(b[k].id);return l},_newPopupInfo:function(b,d){if(b&&b.fields){var l={title:b.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]};"string"===typeof d&&0<d.length&&(l.title=d);n.forEach(b.fields,function(b){var d=K.getDefaultPortalFieldInfo(b);
d.visible=!0;d.isEditable=b.editable;l.fieldInfos.push(d)});return l}return null},_newVectorTileLayer:function(){var b=this,d=new f,l={},k=this.serviceUrl,p=this._generateLayerId();"string"===typeof k&&0<k.length?this._checkVectorTileUrl(k,l).then(function(l){"string"===typeof l&&0<l.length?(l=b._checkMixedContent(l),l=new y(l,{id:p,opacity:1,visible:!0}),b._waitForLayer(l).then(function(b){d.resolve(b)},function(b){d.reject(b)})):d.resolve(null)},function(b){d.reject(b)}):d.resolve(null);return d},
_newWMSLayer:function(b){var d=this,p=this.item,a=!1,e=null,h={id:this._generateLayerId()};if(b){var K=[],C=[];n.forEach(b.layers,function(b){a=!0;C.push(new r({name:b.name,title:b.title,legendURL:b.legendURL,queryable:b.queryable,showPopup:b.showPopup}));K.push(b.name)},this);b.visibleLayers&&(K=b.visibleLayers);h={customLayerParameters:b.customLayerParameters,customParameters:b.customParameters,layerInfos:C,version:b.version,maxWidth:b.maxWidth,maxHeight:b.maxHeight,featureInfoFormat:b.featureInfoFormat,
getFeatureInfoURL:b.featureInfoUrl,getMapURL:b.mapUrl,spatialReferences:b.spatialReferences,title:b.title,copyright:b.copyright,minScale:b.minScale||0,maxScale:b.maxScale||0,format:b.format};p&&p.extent&&(p=new l(p.extent[0][0],p.extent[0][1],p.extent[1][0],p.extent[1][1],new k({wkid:4326})),h.extent=p);b.spatialReferences&&0<b.spatialReferences.length&&(e=b.spatialReferences[0]);h={id:this._generateLayerId(),visibleLayers:K,format:"png",transparent:b.firstLayer?!1:!0,opacity:b.opacity,visible:null!==
b.visibility?b.visibility:!0,resourceInfo:h,refreshInterval:b.refreshInterval}}b=new J(this.serviceUrl,h);b=this._waitForLayer(b);b.then(function(b){a||d._setWMSVisibleLayers(b);e&&b.spatialReference&&(b.spatialReference.wkid=e)});return b},_processFeatureLayer:function(d,l,k){var r=this,e=a.search.featureLayerTitlePattern,h=null;k&&k.layers&&0<k.layers.length?n.some(k.layers,function(k){var a,K,c,C=!1;if(k.id===d.layerId){k.popupInfo&&(a=k.popupInfo,a=t.parse(t.stringify(a)),a=new b(a),d.setInfoTemplate(a),
C=!0);q.isDefined(k.showLabels)&&d.setShowLabels(k.showLabels);q.isDefined(k.refreshInterval)&&d.setRefreshInterval(k.refreshInterval);q.isDefined(k.showLegend)&&console.log("");q.isDefined(k.timeAnimation)&&!1===k.timeAnimation&&console.log("");if(a=k.layerDefinition)a.definitionExpression&&d.setDefinitionExpression(a.definitionExpression),a.displayField&&d.displayField(a.displayField),a.drawingInfo&&(a.drawingInfo.renderer&&(K=t.parse(t.stringify(a.drawingInfo.renderer)),c=p.fromJson(K),K.type&&
"classBreaks"===K.type&&(c.isMaxInclusive=!0),d.setRenderer(c)),q.isDefined(a.drawingInfo.transparency)&&d.setOpacity(1-a.drawingInfo.transparency/100)),q.isDefined(a.minScale)&&d.setMinScale(a.minScale),q.isDefined(a.maxScale)&&d.setMaxScale(a.maxScale),q.isDefined(a.defaultVisibility)&&!1===a.defaultVisibility&&d.setVisibility(!1);C||r._setFeatureLayerInfoTemplate(d,k.popupInfo);h={url:d.url,id:d.id,itemId:l.id,title:r._makeFeatureLayerTitle(e,l.title,d.name)};return!0}}):(h={url:d.url,id:d.id,
itemId:l.id,title:r._makeFeatureLayerTitle(e,l.title,d.name)},r._setFeatureLayerInfoTemplate(d,null,h.title));return h},_readItemJsonData:function(){return v({url:this.itemUrl+"/data",content:{f:"json"},handleAs:"json"},{})},_readRestInfo:function(b){return v({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{})},_setDynamicLayerInfoTemplates:function(b){var d=this,l=null,k=[],p=function(k){var p=d._readRestInfo(b.url+"/"+k.id);p.then(function(b){try{var p=d._newPopupInfo(b);
p&&(l[k.id]={infoTemplate:d._newInfoTemplate(p)})}catch(M){console.warn("Error setting popup."),console.error(M)}});return p};null===b.infoTemplates&&n.forEach(b.layerInfos,function(b){null===l&&(l={});b.subLayerIds||k.push(p(b))});0<k.length&&g(k).then(function(){l&&(b.infoTemplates=l)}).otherwise(function(b){console.warn("Error reading sublayers.");console.error(b)})},_setFeatureLayerInfoTemplate:function(b,d,l){d||(d=this._newPopupInfo(b,l));d=this._newInfoTemplate(d,l);b.setInfoTemplate(d)},_setWMSVisibleLayers:function(b){var d=
[];b&&(n.some(b.layerInfos,function(b){if("string"===typeof b.name&&0<b.name.length)if(10>d.length)d.push(b.name);else return!0}),10>=d.length&&b.setVisibleLayers(d))},_waitForLayer:function(b){var d=new f,l=[];if(b.loaded)return d.resolve(b),d;if(b.loadError)return d.reject(b.loadError),d;var k=function(){n.forEach(l,function(b){b.remove()})};l.push(b.on("load",function(b){k();d.resolve(b.layer)}));l.push(b.on("error",function(b){k();b=b.error;try{b.message&&-1!==b.message.indexOf("Unable to complete")?
(console.warn("layerAccessError",b),d.reject(Error(a.search.layerInaccessible))):d.reject(b)}catch(O){d.reject(b)}}));return d}})})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(m,c,n,g,f,t){m=m(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,bandIds:null,timeExtent:null,
mosaicRule:null,renderingRule:null,renderer:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(a){var c=this.bbox||this.extent;a=(c=c&&a&&c._normalize(!0))?c.spatialReference.wkid||n.toJson(c.spatialReference.toJson()):null;var f=this.imageSpatialReference,c={bbox:c?c.xmin+","+c.ymin+","+c.xmax+","+c.ymax:null,bboxSR:a,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:f?f.wkid||n.toJson(f.toJson()):a,format:this.format,
interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?n.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?n.toJson(this.renderingRule.toJson()):null,renderer:this.renderer?n.toJson(this.renderer.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};
a=this.timeExtent;c.time=a?a.toJson().join(","):null;return t.filter(c,function(a){if(null!==a&&void 0!==a)return!0})}});c.mixin(m,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"});g("extend-esri")&&c.setObject("layers.ImageServiceParameters",m,f);return m})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../urlUtils ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F,H,e,h,A,x,y){var J=c([e],{declaredClass:"esri.layers.KMLLayer",serviceUrl:E.getProtocolForWebResource()+"//utility.arcgis.com/sharing/kml",constructor:function(a,b){a||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new z({wkid:4326});this._options=g.mixin({},b);B.defaults.kmlService&&(this.serviceUrl=B.defaults.kmlService);if(a=this.linkInfo=b&&b.linkInfo)this.visible=!!a.visibility,this._waitingForMap=!!a.viewFormat;
(!a||a&&a.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=g.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(a){if(a){var b=a.type,d=a.id,p;switch(b){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(a=this["_"+b])&&(p=g.getObject("_mode._featureMap."+d,!1,a));break;case "GroundOverlay":if(a=this._groundLyr){var l=a.getImages(),b=l.length;for(a=0;a<b;a++)if(l[a].id===d){p=l[a];break}}break;case "ScreenOverlay":break;
case "NetworkLink":f.some(this._links,function(b){return b.linkInfo&&b.linkInfo.id===d?(p=b,!0):!1});break;case "Folder":b=(l=this.folders)?l.length:0;for(a=0;a<b;a++)if(l[a].id===d){p=l[a];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return p}},getLayers:function(){var a=[];this._groundLyr&&a.push(this._groundLyr);this._fLayers&&(a=a.concat(this._fLayers));this._links&&f.forEach(this._links,function(b){b.declaredClass&&a.push(b)});return a},setFolderVisibility:function(a,
b){a&&(this._fireUpdateStart(),(a.visible=b)&&(b=this._areLocalAncestorsVisible(a)),this._setState(a,b),this._fireUpdateEnd())},_eventMap:{"network-link-error":["error"]},onRefresh:function(){},onOpacityChange:function(){},onNetworkLinkError:function(){},_parseKml:function(a){var b=this;this._fireUpdateStart();this._io=w({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(a),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:t.toJson(this._outSR.toJson())},callbackParamName:"callback",
load:function(d){b._io=null;b._initLayer(d)},error:function(d){b._io=null;d=g.mixin(Error(),d);d.message="Unable to load KML: "+(d.message||"");b._fireUpdateEnd(d);b._errorHandler(d)}})},_initLayer:function(a){var b;this.loaded&&(b=[],f.forEach(this.folders,function(d){d.visible&&b.push(d.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());this.name=a.name;this.description=a.description;this.snippet=a.snippet;
this.visibility=a.visibility;this.featureInfos=a.featureInfos;var d,p,l=this.folders=a.folders,k=[],e;if(l)for(p=l.length,d=0;d<p;d++)e=l[d]=new h(l[d]),-1===e.parentFolderId&&k.push(e);var l=this._links=a.networkLinks,r;p=l?l.length:0;for(d=0;d<p;d++)l[d].viewRefreshMode&&-1!==l[d].viewRefreshMode.toLowerCase().indexOf("onregion")||(r=g.mixin({},this._options),r.linkInfo=l[d],r.id&&(r.id=r.id+"_"+d),e=l[d]=new J(l[d].href,r),e._parentLayer=this,e._parentFolderId=this._getLinkParentId(e.linkInfo.id),
e._linkErrorHandle=e.on("error,network-link-error",g.hitch(e,function(b){this._parentLayer.onNetworkLinkError(b.error)})));if((l=a.groundOverlays)&&0<l.length)for(r=g.mixin({},this._options),r.id&&(r.id+="_mapImage"),e=this._groundLyr=new x(r),p=l.length,d=0;d<p;d++)e.addImage(new A(l[d]));(a=g.getObject("featureCollection.layers",!1,a))&&0<a.length&&(this._fLayers=[],f.forEach(a,function(b,d){var l=g.getObject("featureSet.features",!1,b);l&&0<l.length&&(r=g.mixin({outFields:["*"],infoTemplate:b.popupInfo?
new H(b.popupInfo):null,editable:!1},this._options),r.id&&(r.id=r.id+"_"+d),r.webgl=!1,b.layerDefinition.capabilities="Query,Data",b=new y(b,r),b.geometryType&&(this["_"+b.geometryType]=b),this._fLayers.push(b))},this),0===this._fLayers.length&&delete this._fLayers);if(!this.loaded)for(p=k.length,d=0;d<p;d++)e=k[d],this._setState(e,e.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),f.forEach(this.folders,function(d){-1<f.indexOf(b,d.id)?this.setFolderVisibility(d,!0):this.setFolderVisibility(d,
!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();this._links&&f.forEach(this._links,function(b){b.declaredClass&&(a.addLayer(b),b._waitingForMap&&(b._waitingForMap=null,b.visible?b._parseKml(a):b._wMap=a))});var b=a.spatialReference,d=this._outSR,p;if(!b.equals(d))if(b.isWebMercator()&&4326===d.wkid)p=F.geographicToWebMercator;else if(d.isWebMercator()&&4326===b.wkid)p=F.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");
return}this._groundLyr&&(p&&f.forEach(this._groundLyr.getImages(),function(b){b.extent=p(b.extent)}),a.addLayer(this._groundLyr));(b=this._fLayers)&&0<b.length&&f.forEach(b,function(b){if(p){var d=b.graphics,l,e,h=d?d.length:0;for(l=0;l<h;l++)(e=d[l].geometry)&&d[l].setGeometry(p(e))}a.addLayer(b)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var a=this._map;this._links&&f.forEach(this._links,function(b){b.declaredClass&&b._io&&b._io.cancel();b._linkErrorHandle&&(b._linkErrorHandle.remove(),
b._linkErrorHandle=null)});a&&f.forEach(this.getLayers(),a.removeLayer,a)},_setState:function(a,b){a=a.featureInfos;var d,p,l,k=a?a.length:0,e=b?"show":"hide";for(l=0;l<k;l++)if(d=a[l],p=this.getFeature(d))if("Folder"===d.type)this._setState(p,b&&p.visible);else if("NetworkLink"===d.type)this._setInternalVisibility(p,b);else p[e]()},_areLocalAncestorsVisible:function(a){var b=a.parentFolderId;for(a=a.visible;a&&-1!==b;)b=this.getFeature({type:"Folder",id:b}),a=a&&b.visible,b=b.parentFolderId;return a},
_setInternalVisibility:function(a,b){var d=a._parentLayer,p=a._parentFolderId;for(b=b&&a.visible;b&&d;)b=b&&d.visible,-1<p&&(b=b&&d._areLocalAncestorsVisible(d.getFeature({type:"Folder",id:p}))),p=d._parentFolderId,d=d._parentLayer;this._setIntState(a,b)},_setIntState:function(a,b){a&&f.forEach(a.getLayers(),function(d){d.linkInfo?a._setIntState(d,b&&d.visible&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",id:d._parentFolderId}))):d.setVisibility(b)})},_getLinkParentId:function(a){var b=
-1;this.folders&&f.some(this.folders,function(d){return d.networkLinkIds&&-1!==f.indexOf(d.networkLinkIds,a)?(b=d.id,!0):!1});return b},_checkAutoRefresh:function(){var a=this.linkInfo;if(a)if(this.visible){if(this.loaded&&this._map){var b=a.refreshMode,d=a.refreshInterval,p=a.viewRefreshMode,a=a.viewRefreshTime;b&&-1!==b.toLowerCase().indexOf("oninterval")&&0<d&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*d));p&&-1!==p.toLowerCase().indexOf("onstop")&&0<a&&!this._extChgHandle&&
(this._extChgHandle=n.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),n.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(a){a=a||this._map;var b={},d=this.linkInfo,p=a&&a.extent,l;this._url.query&&(g.mixin(b,this._url.query),l=!!this._url.query.token);D.id&&!l&&(l=D.id.findCredential(this._url.path))&&(b.token=l.token);if(d){l=d.viewFormat;
var k=d.httpQuery,d=d.viewBoundScale;if(p&&l){var e=p,h=p,c=p.spatialReference;c&&(c.isWebMercator()?e=F.webMercatorToGeographic(p):4326===c.wkid&&(h=F.geographicToWebMercator(p)));p=e.getCenter();h=Math.max(h.getWidth(),h.getHeight());d&&(e=e.expand(d));l=l.replace(/\[bboxWest\]/ig,e.xmin).replace(/\[bboxEast\]/ig,e.xmax).replace(/\[bboxSouth\]/ig,e.ymin).replace(/\[bboxNorth\]/ig,e.ymax).replace(/\[lookatLon\]/ig,p.x).replace(/\[lookatLat\]/ig,p.y).replace(/\[lookatRange\]/ig,h).replace(/\[lookatTilt\]/ig,
0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,p.x).replace(/\[lookatTerrainLat\]/ig,p.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,p.x).replace(/\[cameraLat\]/ig,p.y).replace(/\[cameraAlt\]/ig,h).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,a.width).replace(/\[vertPixels\]/ig,a.height).replace(/\[terrainEnabled\]/ig,0);g.mixin(b,u.queryToObject(l))}k&&(k=k.replace(/\[clientVersion\]/ig,D.version).replace(/\[kmlVersion\]/ig,
2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,m.locale),g.mixin(b,u.queryToObject(k)))}a=[];for(var r in b)G.isDefined(b[r])&&a.push(r+"\x3d"+b[r]);return(a=a.join("\x26"))?"?"+a:""},setScaleRange:function(a,b){this.inherited(arguments);f.forEach(this.getLayers(),function(d){d.setScaleRange(a,b)})},setOpacity:function(a){this.opacity!=a&&(f.forEach(this.getLayers(),function(b){b.setOpacity(a)}),this.opacity=a,this.onOpacityChange(a))},_setMap:function(a,b){this.inherited(arguments);
this._map=a;var d=this._div=q.create("div",null,b);v.set(d,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return d},_unsetMap:function(a,b){this._io&&this._io.cancel();this._stopAutoRefresh();n.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var d=this._div;d&&(b.removeChild(d),q.destroy(d));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(a){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,
a),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&a&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._parseKml()},getFeatureCollection:function(a){var b,d=[];(a=this.getFeature({type:"Folder",id:a}))&&(b=f.map(a.featureInfos,function(b){if("esriGeometryPoint"===b.type||"esriGeometryPolyline"===b.type||"esriGeometryPolygon"===b.type)return b.id},this))&&0<b.length&&f.forEach(this._fLayers,function(a){var l,
k;l=a.toJson();l.featureSet.features&&0<l.featureSet.features.length&&(k=f.filter(l.featureSet.features,function(d){if(-1!==f.indexOf(b,d.attributes[a.objectIdField]))return d},this));k&&0<k.length&&(l.featureSet.features=k,d.push(l))},this);return d},getFeatureCount:function(a){a=this.getFeature({type:"Folder",id:a});var b={points:0,polylines:0,polygons:0};a&&f.forEach(a.featureInfos,function(d){"esriGeometryPoint"===d.type&&(b.points+=1);"esriGeometryPolyline"===d.type&&(b.polylines+=1);"esriGeometryPolygon"===
d.type&&(b.polygons+=1)});return b},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});a("extend-esri")&&g.setObject("layers.KMLLayer",J,D);return J})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(m,c,n,g,f){m=m(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(g){c.mixin(this,g);f.isDefined(this.visibility)&&(this.visible=
!!this.visibility)}});n("extend-esri")&&c.setObject("layers.KMLFolder",m,g);return m})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(m,c,n,g,f,t){m=m([t],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(a){f.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});n("extend-esri")&&c.setObject("layers.KMLGroundOverlay",m,g);return m})},"esri/layers/WMSLayer":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F){n=n([z],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],
[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(a,e){var h=D.urlToObject(a);h.query&&(h.query.version||h.query.Version||h.query.VERSION)&&
(this.version=h.query.version||h.query.Version||h.query.VERSION);this.url=a=this._stripParameters(a,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));this._url=D.urlToObject(a);this._getCapabilitiesURL=a;this._initLayer=g.hitch(this,this._initLayer);this._parseCapabilities=g.hitch(this,this._parseCapabilities);this._getCapabilitiesError=g.hitch(this,this._getCapabilitiesError);e?(this.customParameters=e.customParameters,
this.customLayerParameters=e.customLayerParameters,this.imageFormat=this._getImageFormat(e.format),this.imageTransparency=!1!==e.transparent,this.visibleLayers=e.visibleLayers?e.visibleLayers:[],this.version=e.version||this.version,e.resourceInfo?this._readResourceInfo(e.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=m.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);
this._createChildLayer()},setVisibleLayers:function(a){this.visibleLayers=(a=this._checkVisibleLayersList(a))?a:[];this.refresh(!0)},setImageFormat:function(a){this.imageFormat=this._getImageFormat(a);this.refresh(!0)},setImageTransparency:function(a){this.imageTransparency=a;this.refresh(!0)},setCustomParameters:function(a,e){this.customParameters=a;this.customLayerParameters=e;this.refresh(!0)},refresh:function(){this._refreshTS=Date.now();this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,
arguments)},getImageUrl:function(a,e,h,c){if(this.visibleLayers&&0!==this.visibleLayers.length){a=this._getImageParams(a,e,h);a=this._mixinCustomLayerParameters(a);e=this.getMapURL;var x;e+=-1===e.indexOf("?")?"?":"";for(x in a)a.hasOwnProperty(x)&&(e+="?"===e.substring(e.length-1,e.length)?"":"\x26",e+=x+"\x3d"+a[x]);e=this.addTimestampToURL(e);c(D.addProxy(e))}else c(this._blankImageURL)},_setMap:function(a,e,h){var c=this.inherited(arguments);a.wrapAround180?this._childLayer&&(this.suspended&&
this._childLayer.suspend(),this._childLayer._setMap(a,c)):this._childLayer=this.extentProcessor=null;return c},_unsetMap:function(a,e){this._childLayer&&this._childLayer._unsetMap(a,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new z(null,{extentProcessor:this._createExtentProcessor(1)});
this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=g.hitch(this,this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(a){return g.hitch(this,this._extentProcessor,a)},_extentProcessor:function(a,e){var h=e.extent,c=e.width,x=0;if(h){e=h.getWidth()/c;var y=h.bisect(),h=y.extents,f=h[a];f&&(c=y.marginLeft/e,x=0===a?c:c+h[0].getWidth()/e,c=Math.ceil(f.getWidth()/e),x=Math.ceil(x));h=f}return{extent:h,width:c,marginLeft:x}},_getImageParams:function(a,e,h){var c=a.spatialReference.wkid;
-1===f.indexOf(this.spatialReferences,c)&&a.spatialReference.latestWkid&&(c=a.spatialReference.latestWkid);if(f.some(this._WEB_MERCATOR,function(b){return b==c})){var x=f.filter(this.spatialReferences,function(b){return f.some(this._WEB_MERCATOR,function(d){return d==b})},this);0===x.length&&(x=f.filter(this.spatialReferences,function(b){return f.some(this._WORLD_MERCATOR,function(d){return d==b})},this));c=0<x.length?x[0]:this._WEB_MERCATOR[1]}this.spatialReferences=f.filter(this.spatialReferences,
function(b){return b!==c});this.spatialReferences.unshift(c);var x=a.xmin,y=a.xmax,J=a.ymin;a=a.ymax;var r={SERVICE:"WMS",REQUEST:"GetMap"};r.FORMAT=this.imageFormat;r.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";r.STYLES="";r.VERSION=this.version;r.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;r.WIDTH=e;r.HEIGHT=h;this.maxWidth<e&&(r.WIDTH=this.maxWidth);this.maxHeight<h&&(r.HEIGHT=this.maxHeight);e=c?c:NaN;isNaN(e)||("1.3.0"==this.version?r.CRS="EPSG:"+e:r.SRS="EPSG:"+e);"1.3.0"==
this.version&&this._useLatLong(e)?r.BBOX=J+","+x+","+a+","+y:r.BBOX=x+","+J+","+y+","+a;return r},_initLayer:function(c,e){this.spatialReference=new G(this.extent.spatialReference);this.initialExtent=new w(this.extent);this.fullExtent=new w(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);var h=g.hitch(this,function(){this.loaded=!0;this.onLoad(this);var a=this._loadCallback;a&&(delete this._loadCallback,a(this))});t("chrome")?(c=a.defaults.io,e="with-credentials"===
c.useCors?D.canUseXhr(this.getMapURL,!0):-1,(c=-1<e?c.corsEnabledServers[e]:null)&&c.withCredentials?v({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){h()}):h()):h()},_readResourceInfo:function(a){a.extent?a.layerInfos?(this.extent=a.extent,this.allExtents[0]=a.extent,this.layerInfos=a.layerInfos,this.description=a.description?a.description:"",this.copyright=a.copyright?a.copyright:"",this.title=a.title?a.title:"",this.getMapURL=a.getMapURL?a.getMapURL:
this._getCapabilitiesURL,this.getFeatureInfoURL=a.getFeatureInfoURL,this.featureInfoFormat=a.featureInfoFormat,this.version=a.version?a.version:"1.3.0",this.maxWidth=a.maxWidth?a.maxWidth:5E3,this.maxHeight=a.maxHeight?a.maxHeight:5E3,this.spatialReferences=a.spatialReferences?a.spatialReferences:[],this.imageFormat=this._getImageFormat(a.format),this.setScaleRange(a.minScale,a.maxScale),this.customLayerParameters=a.customLayerParameters||this.customLayerParameters,this.customParameters=a.customParameters||
this.customParameters,this._initLayer()):this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},_getCapabilities:function(){var a=this._url.query?this._url.query:{};a.SERVICE="WMS";a.REQUEST="GetCapabilities";this.version&&(a.VERSION=this.version);var a=this._mixinCustomParameters(a),e=this._url.path+"?",h;for(h in a)a.hasOwnProperty(h)&&(e+=
"?"==e.substring(e.length-1,e.length)?"":"\x26",e+=h+"\x3d"+a[h]);v({url:e,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(a){if(a){var e=this;this.version=this._getAttributeValue("WMS_Capabilities","version",a,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",a,"1.3.0"));var h=this._getTag("Service",a);this.title=this._getTagValue("Title",h,"");this.title||
(this.title=this._getTagValue("Name",h,""));this.copyright=this._getTagValue("AccessConstraints",h,"");this.description=this._getTagValue("Abstract",h,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",h,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",h,5E3),10);if(h=this._getTag("Layer",a)){var A=this._getLayerInfo(h),x=0,y=null,h=this._getTag("Capability",a);f.forEach(h.childNodes,function(b){"Layer"==b.nodeName&&(0===x?y=b:(1===x&&A.name&&(A.name="",A.subLayers=[],A.subLayers.push(this._getLayerInfo(y))),
A.subLayers.push(this._getLayerInfo(b))),x++)},this);if(A&&(this.layerInfos=A.subLayers,this.layerInfos&&0!==this.layerInfos.length||(this.layerInfos=[A]),this.extent=A.extent,this.extent||(A.extent=new w(this.layerInfos[0].extent.toJson()),this.extent=A.extent),this.allExtents=A.allExtents,this.allExtents&&this.allExtents.length||(A.allExtents=[],f.forEach(this.layerInfos[0].allExtents,function(b,a){b&&(A.allExtents[a]=new w(b.toJson()))}),this.allExtents=A.allExtents),this.spatialReferences=A.spatialReferences,
!this.spatialReferences.length&&0<this.layerInfos.length))for(var J=function(b){var d;for(d=0;d<b.subLayers.length;d++){var a=b.subLayers[d],k=a.spatialReferences;!k.length&&a.subLayers&&0<a.subLayers.length&&(k=J(a));if(k.length)return k}return[]},h=0;h<this.layerInfos.length;h++){var r=this.layerInfos[h];this.spatialReferences=this.layerInfos[0].spatialReferences;!this.spatialReferences.length&&r.subLayers&&0<r.subLayers.length&&(this.spatialReferences=J(r));if(this.spatialReferences.length)break}h=
function(b){return(b=c.query("DCPType",e._getTag(b,a)))&&0<b.length&&(b=c.query("HTTP",b[0]))&&0<b.length&&(b=c.query("Get",b[0]))&&0<b.length&&(b=e._getAttributeValue("OnlineResource","xlink:href",b[0],null))?(b.indexOf("\x26")===b.length-1&&(b=b.substring(0,b.length-1)),e._stripParameters(b,["service","request"])):null};r=function(b){var d=[];0===c.query("Operation",a).length?f.forEach(c.query("Format",e._getTag(b,a)),function(b){d.push(b.text?b.text:b.textContent)}):(f.forEach(c.query("Operation",
a),function(a){a.getAttribute("name")===b&&f.forEach(c.query("Format",a),function(b){d.push(b.text?b.text:b.textContent)})}),d.length||f.forEach(c.query("Format",e._getTag(b,a)),function(b){d.push(b.text?b.text:b.textContent)}));return d};this.getMapURL=h("GetMap")||this._getCapabilitiesURL;this.getMapFormats=r("GetMap");this.getMapFormats.length&&!f.some(this.getMapFormats,function(b){return-1<b.indexOf(this.imageFormat)},this)&&(this.imageFormat=this.getMapFormats[0]);if(this.getFeatureInfoURL=
h("GetFeatureInfo"))this.getFeatureInfoFormats=r("GetFeatureInfo"),-1<f.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat="text/html":-1<f.indexOf(this.getFeatureInfoFormats,"text/plain")&&(this.featureInfoFormat="text/plain");if(!this.featureInfoFormat){var b=function(d){if(d&&(d.queryable=!1,d.subLayers))for(var a=0;a<d.subLayers.length;a++)b(d.subLayers[a])};b(A)}this._initLayer()}else this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."))}else this._errorHandler(Error("GetCapabilities request for "+
this._getCapabilitiesURL+" failed. (Response is null.)"))},_getCapabilitiesError:function(a){a&&a.message&&(a.message="GetCapabilities request for "+this._getCapabilitiesURL+" failed. ("+a.message+")");this._errorHandler(a)},_getLayerInfo:function(a){if(!a)return null;var e=new F;e.name="";e.title="";e.description="";e.allExtents=[];e.spatialReferences=[];e.queryable="1"===a.getAttribute("queryable");e.subLayers=[];var h=this._getTag("LatLonBoundingBox",a);h&&(e.allExtents[0]=this._getExtent(h,4326));
var c=this._getTag("EX_GeographicBoundingBox",a),x;c&&(x=new w(0,0,0,0,new G({wkid:4326})),x.xmin=parseFloat(this._getTagValue("westBoundLongitude",c,0)),x.ymin=parseFloat(this._getTagValue("southBoundLatitude",c,0)),x.xmax=parseFloat(this._getTagValue("eastBoundLongitude",c,0)),x.ymax=parseFloat(this._getTagValue("northBoundLatitude",c,0)),e.allExtents[0]=x);h||c||(x=new w(-180,-90,180,90,new G({wkid:4326})),e.allExtents[0]=x);e.extent=e.allExtents[0];var y=-1<f.indexOf(["1.0.0","1.1.0","1.1.1"],
this.version)?"SRS":"CRS";f.forEach(a.childNodes,function(a){if("Name"==a.nodeName)e.name=(a.text?a.text:a.textContent)||"";else if("Title"==a.nodeName)e.title=(a.text?a.text:a.textContent)||"";else if("Abstract"==a.nodeName)e.description=(a.text?a.text:a.textContent)||"";else if("BoundingBox"==a.nodeName){var h=a.getAttribute(y);h&&0===h.indexOf("EPSG:")?(h=parseInt(h.substring(5),10),0===h||isNaN(h)||(a="1.3.0"==this.version?this._getExtent(a,h,this._useLatLong(h)):this._getExtent(a,h),e.allExtents[h]=
a,e.extent||(e.extent=a))):h&&0===h.indexOf("CRS:")?(h=parseInt(h.substring(4),10),0===h||isNaN(h)||(this._CRS_TO_EPSG[h]&&(h=this._CRS_TO_EPSG[h]),e.allExtents[h]=this._getExtent(a,h))):(h=parseInt(h,10),0===h||isNaN(h)||(e.allExtents[h]=this._getExtent(a,h)))}else if(a.nodeName==y)a=(a.text?a.text:a.textContent).split(" "),f.forEach(a,function(b){b=-1<b.indexOf(":")?parseInt(b.split(":")[1],10):parseInt(b,10);0===b||isNaN(b)||(this._CRS_TO_EPSG[b]&&(b=this._CRS_TO_EPSG[b]),-1==f.indexOf(e.spatialReferences,
b)&&e.spatialReferences.push(b))},this);else if("Style"!=a.nodeName||e.legendURL)"Layer"===a.nodeName&&e.subLayers.push(this._getLayerInfo(a));else if(a=this._getTag("LegendURL",a))if(a=this._getTag("OnlineResource",a))e.legendURL=a.getAttribute("xlink:href")},this);e.title=e.title||e.name;return e},_getImageFormat:function(a){switch(a?a.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},
getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(a,e,h){var c;if(a){c=new w;var f=parseFloat(a.getAttribute("minx")),y=parseFloat(a.getAttribute("miny")),g=parseFloat(a.getAttribute("maxx"));a=parseFloat(a.getAttribute("maxy"));h?(c.xmin=isNaN(y)?-1*Number.MAX_VALUE:y,c.ymin=isNaN(f)?-1*Number.MAX_VALUE:
f,c.xmax=isNaN(a)?Number.MAX_VALUE:a,c.ymax=isNaN(g)?Number.MAX_VALUE:g):(c.xmin=isNaN(f)?-1*Number.MAX_VALUE:f,c.ymin=isNaN(y)?-1*Number.MAX_VALUE:y,c.xmax=isNaN(g)?Number.MAX_VALUE:g,c.ymax=isNaN(a)?Number.MAX_VALUE:a);c.spatialReference=new G({wkid:e})}return c},_useLatLong:function(a){var e,h;for(h=0;h<this._REVERSED_LAT_LONG_RANGES.length;h++){var c=this._REVERSED_LAT_LONG_RANGES[h];if(a>=c[0]&&a<=c[1]){e=!0;break}}return e},_getTag:function(a,e){return(a=c.query(a,e))&&0<a.length?a[0]:null},
_getTagValue:function(a,e,h){return(a=c.query(a,e))&&0<a.length?a[0].text?a[0].text:a[0].textContent:h},_getAttributeValue:function(a,e,h,f){return(a=c.query(a,h))&&0<a.length?a[0].getAttribute(e):f},_checkVisibleLayersList:function(a){if(a&&0<a.length&&this.layerInfos&&0<this.layerInfos.length&&"number"==typeof a[0]){var e=[];f.forEach(a,function(a){a<this.layerInfos.length&&e.push(this.layerInfos[a].name)},this);a=e}return a},_stripParameters:function(a,e){a=D.urlToObject(a);var h,c=[];for(h in a.query)a.query.hasOwnProperty(h)&&
-1===f.indexOf(e,h.toLowerCase())&&c.push(h+"\x3d"+a.query[h]);return a.path+(c.length?"?"+c.join("\x26"):"")},_getPopupGraphic:function(a,e){var h=this.visibleLayers;if(!h||0===h.length)return null;var c=this._popupGraphic;c||(c=new B({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+
m.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),c=this._popupGraphic=new u(null,null,{},c),c._layer=this);var x=function(b){var a=[];if(b&&(b.queryable&&b.showPopup&&b.name&&a.push(b.name),b.subLayers))for(var p=0;p<b.subLayers.length;p++){var l=x(b.subLayers[p]);l.length&&(a=a.concat(l))}return a},y=x({subLayers:this.layerInfos}),y=f.filter(y,function(b){return-1<
f.indexOf(h,b)});if(y.length){var g=this.getFeatureInfoURL;a=this._getImageParams(a.extent,a.width,a.height);a=this._mixinCustomLayerParameters(a);a.REQUEST="GetFeatureInfo";a.INFO_FORMAT=this.featureInfoFormat;a.QUERY_LAYERS=y.join();a.FEATURE_COUNT=25;"1.3.0"===this.version?(a.I=Math.round(e.x),a.J=Math.round(e.y)):(a.X=Math.round(e.x),a.Y=Math.round(e.y));var g=g+(-1===g.indexOf("?")?"?":""),r;for(r in a)a.hasOwnProperty(r)&&(g+="?"===g.substring(g.length-1,g.length)?"":"\x26",g+=r+"\x3d"+a[r]);
c.attributes.QUERY_URL=g;return c}return null},_mixinCustomParameters:function(a){if(this.customParameters)for(var e in this.customParameters)a[e]=encodeURIComponent(this.customParameters[e]);return a},_mixinCustomLayerParameters:function(a){if(this.customLayerParameters||this.customParameters){var e=g.clone(this.customParameters||{});g.mixin(e,this.customLayerParameters||{});for(var h in e)"styles"===h.toLowerCase()&&delete a.STYLES,a[h]=encodeURIComponent(e[h])}return a}});t("extend-esri")&&g.setObject("layers.WMSLayer",
n,q);return n})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(m,c,n,g,f){m=m(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(c){c&&(this.name=c.name,this.title=c.title,this.description=c.description,this.extent=c.extent,this.legendURL=c.legendURL,this.subLayers=
c.subLayers?c.subLayers:[],this.allExtents=c.allExtents?c.allExtents:[],this.spatialReferences=c.spatialReferences?c.spatialReferences:[],this.queryable=!!c.queryable,this.showPopup=!!c.showPopup)},clone:function(){var c={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},a;this.extent&&(c.extent=this.extent.getExtent());c.subLayers=[];n.forEach(this.subLayers,function(a){c.subLayers.push(a.clone())});c.allExtents=[];for(a in this.allExtents)a=parseInt(a,10),isNaN(a)||
(c.allExtents[a]=this.allExtents[a].getExtent());c.spatialReferences=[];n.forEach(this.spatialReferences,function(a){c.spatialReferences.push(a)});c.queryable=this.queryable;c.showPopup=this.showPopup;return c}});g("extend-esri")&&c.setObject("layers.WMSLayerInfo",m,f);return m})},"widgets/AddData/search/Paging":function(){define("dojo/_base/declare dojo/dom-class ./SearchComponent dojo/text!./templates/Paging.html dojo/i18n!../nls/strings ./util".split(" "),function(m,c,n,g,f,t){return m([n],{i18n:f,
templateString:g,hasLess:!1,hasMore:!1,nextStart:-1,numPerPage:null,previousStart:-1,start:1,postCreate:function(){this.inherited(arguments);null===this.numPerPage&&(this.numPerPage=30);this.enableOrDisable()},startup:function(){if(!this._started){this.inherited(arguments);try{var a=this.getConfig().numPerPage,c=Number(a);"number"!==typeof c||isNaN(c)||(c=Math.floor(c),1<=c&&100>=c&&(this.numPerPage=c))}catch(q){console.warn("Error setting numPerPage:"),console.warn(q)}null===this.numPerPage&&(this.numPerPage=
30)}},enableOrDisable:function(){this.hasLess?(c.remove(this.firstButton.parentNode,"disabled"),c.remove(this.previousButton.parentNode,"disabled")):(c.add(this.firstButton.parentNode,"disabled"),c.add(this.previousButton.parentNode,"disabled"));this.hasMore?c.remove(this.nextButton.parentNode,"disabled"):c.add(this.nextButton.parentNode,"disabled")},firstButtonClicked:function(){this.hasLess&&(this.start=1,this.search())},previousButtonClicked:function(){this.hasLess&&(this.start=this.previousStart,
this.search())},nextButtonClicked:function(){this.hasMore&&(this.start=this.nextStart,this.search())},appendQueryParams:function(a){a.start=this.start;a.num=this.numPerPage},processResults:function(a){this.start=1;var c=this.numPerPage,f=a.total,g=a.queryParams.start;1>g&&(g=1);this.hasLess=!1;this.previousStart=-1;1<g&&(this.hasLess=!0,this.previousStart=g-a.queryParams.num,1>this.previousStart&&(this.previousStart=1));this.hasMore=!1;this.nextStart=-1;a.nextQueryParams&&1<a.nextQueryParams.start&&
(this.hasMore=!0,this.nextStart=a.nextQueryParams.start);a="";f>c?(f=1,1<g&&(f=Math.floor(g/c)+1),a=this.i18n.search.paging.pagePattern,a=a.replace("{page}",""+f)):(a=this.i18n.search.paging.pagePattern,a=a.replace("{page}","1"));t.setNodeText(this.pageNode,a);this.enableOrDisable()}})})},"widgets/AddData/search/ResultCount":function(){define("dojo/_base/declare dojo/number ./SearchComponent dojo/text!./templates/ResultCount.html dojo/i18n!../nls/strings ./util".split(" "),function(m,c,n,g,f,t){return m([n],
{i18n:f,templateString:g,typePlural:f.search.resultCount.itemPlural,typeSingular:f.search.resultCount.itemSingular,postCreate:function(){this.inherited(arguments)},processResults:function(a){a=a.total;var f=this.typePlural;1===a&&(f=this.typeSingular);var g=this.i18n.search.resultCount.countPattern,g=g.replace("{count}",c.format(a)),g=g.replace("{type}",f);t.setNodeText(this.messageNode,g)}})})},"widgets/AddData/search/AddFromUrlPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/Deferred dojo/promise/all dojo/dom-class dojo/window dijit/Viewport dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromUrlPane.html dojo/i18n!../nls/strings ./LayerLoader ./util esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/CSVLayer esri/layers/FeatureLayer esri/layers/GeoRSSLayer esri/layers/ImageParameters esri/layers/KMLLayer esri/layers/StreamLayer esri/layers/VectorTileLayer esri/layers/WFSLayer esri/layers/WMSLayer esri/layers/WMTSLayer esri/InfoTemplate jimu/dijit/Message dijit/form/Select".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F,H,e,h,A,x,y,J,r,b,d,p,l,k,K,C){return m([D,B,G],{i18n:E,templateString:w,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);this._updateExamples("ArcGIS");var b=this;this.own(g(this.urlTextBox,"keyup",function(a){a.keyCode===f.ENTER?b.addClicked():u.contains(b.addButton,"disabled")||b._setStatus("")}));this.own(g(this.urlTextBox,"focus",function(){try{b.urlTextBox.select()}catch(L){}}));this.own(g(this.typeSelect,"change",function(a){b._updateExamples(a)}));
this.own(g(this.typeSelect.dropDown,"open",function(){var b=this.domNode.parentElement;b&&u.add(b,"add-data-widget-popup")}));this.own(v.on("resize",b.resize()))},destroy:function(){this.inherited(arguments)},addClicked:function(){var b=this,a=!1,d=this.addButton;if(!u.contains(d,"disabled")){var l=this.typeSelect.get("value"),k=c.trim(this.urlTextBox.value);0<k.length&&(0===k.indexOf("http://")||0===k.indexOf("https://"))&&(a=!0);a&&(u.add(d,"disabled"),b._setStatus(E.search.item.messages.adding),
a=new t,this._handleAdd(a,this.wabWidget.map,l,k),a.then(function(a){a?b._setStatus(""):b._setStatus(E.search.item.messages.addFailed);u.remove(d,"disabled")}).otherwise(function(a){"string"===typeof a&&"Unsupported"===a?(b._setStatus(E.search.item.messages.unsupported),u.remove(d,"disabled")):(console.warn("Add layer failed."),console.warn(a),b._setStatus(E.search.item.messages.addFailed),u.remove(d,"disabled"),a&&"string"===typeof a.message&&0<a.message.length&&(b._setStatus(a.message),console.log("")))}))}},
examplesExpanderClicked:function(){u.toggle(this.examplesNode,"show")},preHide:function(){},resize:function(){var b=q.getBox(this.ownerDocument);b&&"undefined"!==typeof b.w&&(600<b.w?u.add(this.urlTextBox,"url-textbox-wide"):u.remove(this.urlTextBox,"url-textbox-wide"))},_handleAdd:function(c,f,g,C){C=F.checkMixedContent(C);var m=C.toLowerCase(),I=new z,u=I._generateLayerId(),v=this,q=null;"ArcGIS"===g?0<m.indexOf("/featureserver")||0<m.indexOf("/mapserver")?I._readRestInfo(C).then(function(b){if(b&&
"string"===typeof b.type&&("Feature Layer"===b.type||"Table"===b.type))q=new x(C,{id:u,outFields:["*"],infoTemplate:new K}),v._waitThenAdd(c,f,g,I,q);else if(0<m.indexOf("/featureserver")){var d=[];n.forEach(b.layers,function(b){b=new x(C+"/"+b.id,{id:I._generateLayerId(),outFields:["*"],infoTemplate:new K});d.push(I._waitForLayer(b))});n.forEach(b.tables,function(b){b=new x(C+"/"+b.id,{id:I._generateLayerId(),outFields:["*"]});d.push(I._waitForLayer(b))});a(d).then(function(b){var a=[];n.forEach(b,
function(b){a.push(b)});a.reverse();n.forEach(a,function(b){I._setFeatureLayerInfoTemplate(b);b.xtnAddData=!0;f.addLayer(b)});c.resolve(a)}).otherwise(function(b){c.reject(b)})}else if(0<m.indexOf("/mapserver")){if(b.tileInfo)q=new h(C,{id:u});else{var l={id:u};b&&b.supportedImageFormatTypes&&-1!==b.supportedImageFormatTypes.indexOf("PNG32")&&(l.imageParameters=new J,l.imageParameters.format="png32");q=new H(C,l)}v._waitThenAdd(c,f,g,I,q)}}).otherwise(function(b){c.reject(b)}):0<m.indexOf("/imageserver")?
(q=new e(C,{id:u}),this._waitThenAdd(c,f,g,I,q)):0<m.indexOf("/vectortileserver")||0<m.indexOf("/resources/styles/root.json")?d&&d.supported()?I._checkVectorTileUrl(C,{}).then(function(b){q=new d(b,{id:u});v._waitThenAdd(c,f,g,I,q)}).otherwise(function(b){c.reject(b)}):c.reject("Unsupported"):0<m.indexOf("/streamserver")?(q=new b(C,{id:u,purgeOptions:{displayCount:1E4},infoTemplate:new K}),this._waitThenAdd(c,f,g,I,q)):c.reject("Unsupported"):"WMS"===g?(q=new l(C,{id:u}),this._waitThenAdd(c,f,g,I,
q)):"WMTS"===g?q=new k(C,{id:u}):"WFS"===g?(q=new p({id:u,url:C,infoTemplate:new K}),this._waitThenAdd(c,f,g,I,q),console.warn("WFSLayer",q)):"KML"===g?(q=new r(C,{id:u}),this._waitThenAdd(c,f,g,I,q)):"GeoRSS"===g?(q=new y(C,{id:u}),this._waitThenAdd(c,f,g,I,q)):"CSV"===g&&(q=new A(C,{id:u}),q.setInfoTemplate(I._newInfoTemplate()),this._waitThenAdd(c,f,g,I,q))},_persist:function(){try{var b=this.typeSelect.get("value"),a=c.trim(this.urlTextBox.value);this.wabWidget.xtnAddFromUrlPane={type:b,url:a}}catch(N){}},
_restore:function(){try{var b=this.wabWidget.xtnAddFromUrlPane;b&&"string"===typeof b.type&&0<b.type.length&&this.typeSelect.set("value",b.type);b&&"string"===typeof b.url&&0<b.url.length&&(this.urlTextBox.value=b.url)}catch(L){}},_setStatus:function(b){this.wabWidget&&this.wabWidget._setStatus(b)},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()},_updateExamples:function(b){n.forEach(this.examplesNode.children,function(a){var d=a.getAttribute("data-examples-type");"string"===typeof d&&
0<d.length&&(a.style.display=d===b?"":"none")})},_waitThenAdd:function(b,a,d,l,k){l._waitForLayer(k).then(function(k){"WMS"===d?l._setWMSVisibleLayers(k):k&&"esri.layers.ArcGISDynamicMapServiceLayer"===k.declaredClass?l._setDynamicLayerInfoTemplates(k):k&&"esri.layers.FeatureLayer"===k.declaredClass?l._setFeatureLayerInfoTemplate(k):k&&"esri.layers.CSVLayer"===k.declaredClass&&l._setFeatureLayerInfoTemplate(k);k.xtnAddData=!0;if("KML"===d){var p=a.spatialReference,c=k._outSR;p&&c&&(p.equals(c)||p.isWebMercator()&&
4326===c.wkid||c.isWebMercator()&&4326===p.wkid)?a.addLayer(k):new C({titleLabel:E._widgetLabel,message:E.addFromFile.kmlProjectionMismatch})}else a.addLayer(k);b.resolve(k)}).otherwise(function(a){b.reject(a)})}})})},"esri/layers/CSVLayer":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../arcgis/csv ./FeatureLayer ../geometry/Extent ../tasks/FeatureSet".split(" "),function(m,c,n,g,f,t,a,u,q){c=c(a,{declaredClass:"esri.layers.CSVLayer",_preventInit:!0,_fieldTypeMap:{Date:"esriFieldTypeDate",
Number:"esriFieldTypeDouble",String:"esriFieldTypeString"},constructor:function(a,c){this.url=a;c=n.mixin({},c);this.columnDelimiter=c.columnDelimiter;this.latitudeFieldName=c.latitudeFieldName;this.longitudeFieldName=c.longitudeFieldName;a=c.layerDefinition;a||(a={fields:c.fields||[],geometryType:"esriGeometryPoint",copyrightText:c.copyright},c.fields&&m.forEach(c.fields,function(a){a.type=this._fieldTypeMap[a.type||"String"];a.alias||(a.alias=a.name)},this));this._buildCsvFcParam={url:this.url,
columnDelimiter:this.columnDelimiter,layerDefinition:a,outFields:c.outFields};this.latitudeFieldName&&this.longitudeFieldName&&(this._buildCsvFcParam.locationInfo={locationType:"coordinates",latitudeFieldName:this.latitudeFieldName,longitudeFieldName:this.longitudeFieldName});this._projectFeatures=n.hitch(this,this._projectFeatures);this._addFeatures=n.hitch(this,this._addFeatures);this._initCSVLayer(c)},refresh:function(){this._fireUpdateStart();this.applyEdits(null,null,this.graphics);this._loadFeatures()},
_isWebGLCompatible:function(){return!1},_setMap:function(a){var c=this.inherited(arguments);this._fireUpdateStart();this._projectFeatures(this._csvFC).then(this._addFeatures).otherwise(this._errorHandler);this._csvFC=null;return c},_initCSVLayer:function(a){var c=this;t.buildCSVFeatureCollection(this._buildCsvFcParam).then(function(f){!c._buildCsvFcParam.locationInfo||c.latitudeFieldName&&c.longitudeFieldName||(c.latitudeFieldName=c._buildCsvFcParam.locationInfo.latitudeFieldName,c.longitudeFieldName=
c._buildCsvFcParam.locationInfo.longitudeFieldName);c._csvFC=f;var g=f.layerDefinition;g.extent=c._getFCExtent(f);a.outFields||(a.outFields=["*"]);a.timeInfo&&(g.timeInfo=a.timeInfo);c._initFeatureLayer({layerDefinition:g},a)}).otherwise(this._errorHandler)},_loadFeatures:function(){t.buildCSVFeatureCollection(this._buildCsvFcParam).then(this._projectFeatures).then(this._addFeatures).otherwise(this._errorHandler)},_projectFeatures:function(a){return t.projectFeatureCollection(a,this._map.spatialReference)},
_addFeatures:function(a){a=new q(a.featureSet);this.applyEdits(a.features,null,null);this._fireUpdateEnd()},_getFCExtent:function(a){var c;if(a&&a.featureSet&&a.featureSet.features){a=a.featureSet.features;var f=a.length;if(1<f){var g=a[0].geometry;c=new u(g.x,g.y,g.x,g.y);for(--f;0<f;f--)g=a[f].geometry,c.xmin=Math.min(c.xmin,g.x),c.ymin=Math.min(c.ymin,g.y),c.xmax=Math.max(c.xmax,g.x),c.ymax=Math.max(c.ymax,g.y);0>=c.getWidth()&&0>=c.getHeight()&&(c=null)}}return c}});g("extend-esri")&&n.setObject("layers.CSVLayer",
c,f);return c})},"esri/arcgis/csv":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/sniff dojo/number dojox/data/CsvStore ../kernel ../config ../request ../SpatialReference ../geometry/jsonUtils ../geometry/webMercatorUtils".split(" "),function(m,c,n,g,f,t,a,u,q,v,D,B){function G(a){var e=0,h="";c.forEach([","," ",";","|","\t"],function(c){var b=a.split(c).length;b>e&&(e=b,h=c)});return h}function w(a,c){if(!a||"[object Date]"!==Object.prototype.toString.call(a)||isNaN(a.getTime()))return!1;
a=!0;if(g("chrome")&&/\d+\W*$/.test(c)){if(c.match(/[^0-9a-zA-Z\s]/))return!1;if(c=c.match(/[a-zA-Z]{2,}/)){a=!1;for(var e=0,h=c.length,b=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i;!a&&e<=h&&!(a=!b.test(c[e]));)e++;a=!a}}return a}function E(a,g,A){var y=a.indexOf("\n"),y=m.trim(a.substr(0,y)),b=g.columnDelimiter;b||(b=G(y));var d=new t({data:a,separator:b});d.fetch({onComplete:function(b,
a){a=0;var l={layerDefinition:g.layerDefinition,featureSet:{features:[],geometryType:"esriGeometryPoint"}},p=l.layerDefinition.objectIdField,y=l.layerDefinition.fields;p||c.some(y,function(b){return"esriFieldTypeOID"===b.type?(p=b.name,!0):!1})||(y.push({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1}),p="__OBJECTID");var r,x,n=d._attributes,J=[],q=[];c.forEach(y,function(b){"esriFieldTypeDate"===b.type?J.push(b.name):"esriFieldTypeDouble"!==b.type&&"esriFieldTypeInteger"!==
b.type||q.push(b.name)});g.locationInfo&&"coordinates"===g.locationInfo.locationType?(r=g.locationInfo.latitudeFieldName,x=g.locationInfo.longitudeFieldName):(c.forEach(n,function(b){var a;a=c.indexOf(e,b.toLowerCase());-1!==a&&(r=b);a=c.indexOf(h,b.toLowerCase());-1!==a&&(x=b)}),r&&x&&(g.locationInfo={locationType:"coordinates",latitudeFieldName:r,longitudeFieldName:x}));if(r&&x){-1===c.indexOf(q,r)&&q.push(r);-1===c.indexOf(q,x)&&q.push(x);var u;m.isArray(g.outFields)&&-1===c.indexOf(g.outFields,
"*")&&(u=g.outFields);c.forEach(n,function(b){c.some(y,function(a){return b===a.name})||y.push({name:b,alias:b,type:b===r||b===x?"esriFieldTypeDouble":"esriFieldTypeString"})});var n=0,z=b.length;for(n;n<z;n++){var v=b[n],F=d.getAttributes(v),B={};c.forEach(F,function(b){if(b&&(b===r||b===x||!u||-1<c.indexOf(u,b))){var a=b;0===b.length&&c.forEach(y,function(a,d){a.name==="attribute_"+(d-1)&&(b="attribute_"+(d-1))});if(-1<c.indexOf(J,b)){var a=d.getValue(v,a),l=new Date(a);B[b]=w(l,a)?l.getTime():
null}else-1<c.indexOf(q,b)?(l=f.parse(d.getValue(v,a)),b!==r&&b!==x||!(isNaN(l)||181<Math.abs(l))||(l=parseFloat(d.getValue(v,a))),isNaN(l)?B[b]=null:B[b]=l):B[b]=d.getValue(v,a)}});B[p]=a;a++;var F=B[r],t=B[x];null==t||null==F||isNaN(F)||isNaN(t)||(u&&-1===c.indexOf(u,r)&&delete B[r],u&&-1===c.indexOf(u,x)&&delete B[x],l.featureSet.features.push({geometry:{x:t,y:F,spatialReference:{wkid:4326}},attributes:B}))}l.layerDefinition.name="csv";A&&A(l)}else setTimeout(function(){console.error("File does not seem to contain fields with point coordinates.")},
1),A&&A(null,Error("File does not seem to contain fields with point coordinates."))},onError:function(b){console.error("Error fetching items from CSV store: ",b);A&&A(null,b)}});return!0}function z(a,e,h,f,b,d){0===a.length&&b(null);var p=D.getGeometryType(e),l=[];c.forEach(a,function(b){b=new p(b);b.spatialReference=h;l.push(b)},this);e=[102113,102100,3857];h.wkid&&4326===h.wkid&&f.wkid&&-1<c.indexOf(e,f.wkid)?(c.forEach(l,function(b){b.xmin?(b.xmin=Math.max(b.xmin,-180),b.xmax=Math.min(b.xmax,180),
b.ymin=Math.max(b.ymin,-89.99),b.ymax=Math.min(b.ymax,89.99)):b.rings?c.forEach(b.rings,function(b){c.forEach(b,function(b){b[0]=Math.min(Math.max(b[0],-180),180);b[1]=Math.min(Math.max(b[1],-89.99),89.99)},this)},this):b.paths?c.forEach(b.paths,function(b){c.forEach(b,function(b){b[0]=Math.min(Math.max(b[0],-180),180);b[1]=Math.min(Math.max(b[1],-89.99),89.99)},this)},this):b.x&&(b.x=Math.min(Math.max(b.x,-180),180),b.y=Math.min(Math.max(b.y,-89.99),89.99))},this),a=[],c.forEach(l,function(b){b=
B.geographicToWebMercator(b);102100!==f.wkid&&(b.spatialReference=f);a.push(b.toJson())},this),b(a)):null!==h.wkid&&-1<c.indexOf(e,h.wkid)&&null!==f.wkid&&4326===f.wkid?(a=[],c.forEach(l,function(b){a.push(B.webMercatorToGeographic(b).toJson())},this),b(a)):(e=function(l,p){l&&l.length===a.length?(a=[],c.forEach(l,function(b){b&&(b.rings&&0<b.rings.length&&0<b.rings[0].length&&0<b.rings[0][0].length&&!isNaN(b.rings[0][0][0])&&!isNaN(b.rings[0][0][1])||b.paths&&0<b.paths.length&&0<b.paths[0].length&&
0<b.paths[0][0].length&&!isNaN(b.paths[0][0][0])&&!isNaN(b.paths[0][0][1])||b.xmin&&!isNaN(b.xmin)&&b.ymin&&!isNaN(b.ymin)||b.x&&!isNaN(b.x)&&b.y&&!isNaN(b.y))?a.push(b.toJson()):a.push(null)},this),b(a)):d(l,p)},u.defaults.geometryService?u.defaults.geometryService.project(l,f,m.hitch(this,e),d):b(null))}function F(a,e){var h=[102113,102100,3857];return a&&e&&a.wkid===e.wkid&&a.wkt===e.wkt||a&&e&&a.wkid&&e.wkid&&-1<c.indexOf(h,a.wkid)&&-1<c.indexOf(h,e.wkid)?!0:!1}function H(a,e,h,f){if(a.featureSet&&
0!==a.featureSet.features.length)if(F(h,e))f(a);else{var b,d=function(b){var d=[];c.forEach(a.featureSet.features,function(a,l){b[l]&&(a.geometry=b[l],d.push(a))},this);f(a)},p=function(b,d){console.error("error projecting featureSet ("+a.layerDefinition.name+"). Final try.");f(a)},l=function(l,c){console.error("error projecting featureSet ("+a.layerDefinition.name+"). Try one more time.");z(b,a.featureSet.geometryType,e,h,m.hitch(this,d),m.hitch(this,p))};a.featureSet.features&&0<a.featureSet.features.length?
(b=[],c.forEach(a.featureSet.features,function(d){if(d.geometry.toJson)b.push(d.geometry);else{var l=D.getGeometryType(a.featureSet.geometryType);b.push(new l(d.geometry))}}),e.toJson||(e=new v(e)),h.toJson||(h=new v(h)),z(b,a.featureSet.geometryType,e,h,m.hitch(this,d),m.hitch(this,l))):f(a)}}var e="lat latitude y ycenter latitude83 latdecdeg point-y lat_dd".split(" "),h="lon lng long longitude x xcenter longitude83 longdecdeg point-x long_dd".split(" "),A={latFieldStrings:e,longFieldStrings:h,buildCSVFeatureCollection:function(a){var c=
new n,e=function(b,a){a?c.errback(a):c.callback(b)},h={url:a.url,handleAs:"text",load:function(b){E(b,a,m.hitch(this,e))},error:function(b){c.errback(b);console.error("error: "+b)}};-1<a.url.indexOf("arcgis.com")&&-1<a.url.indexOf("/content/items")&&-1<a.url.indexOf("/data")&&(h.headers={"Content-Type":""});q(h,{usePost:!1});return c},projectFeatureCollection:function(a,c,e){var h=new n;e||(e=new v({wkid:4326}));H(a,e,c,m.hitch(this,function(b){h.callback(b)}));return h},generateDefaultPopupInfo:function(a){var e=
{esriFieldTypeDouble:1,esriFieldTypeSingle:1},h={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},f={esriFieldTypeDate:1},b=null;a=c.map(a.layerDefinition.fields,m.hitch(this,function(a){"NAME"===a.name.toUpperCase()&&(b=a.name);var d="esriFieldTypeOID"!==a.type&&"esriFieldTypeGlobalID"!==a.type&&"esriFieldTypeGeometry"!==a.type,l=null;if(d){var k=a.name.toLowerCase();if(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+k+",")||-1<k.indexOf("area")||
-1<k.indexOf("length")||-1<k.indexOf("shape")||-1<k.indexOf("perimeter")||-1<k.indexOf("objectid")||k.indexOf("_")===k.length-1||k.indexOf("_i")===k.length-2&&1<k.length)d=!1;a.type in h?l={places:0,digitSeparator:!0}:a.type in e?l={places:2,digitSeparator:!0}:a.type in f&&(l={dateFormat:"shortDateShortTime"})}return m.mixin({},{fieldName:a.name,label:a.alias,isEditable:!0,tooltip:"",visible:d,format:l,stringFieldOption:"textbox"})}));return{title:b?"{"+b+"}":"",fieldInfos:a,description:null,showAttachments:!1,
mediaInfos:[]}},_getSeparator:G,_isValidDate:w,_processCsvData:E,_projectGeometries:z,_sameSpatialReference:F,_projectFeatureSet:H};g("extend-esri")&&m.setObject("arcgis.csv",A,a);return A})},"dojox/data/CsvStore":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/xhr dojo/_base/kernel dojo/data/util/filter dojo/data/util/simpleFetch".split(" "),function(m,c,n,g,f,t){c=c("dojox.data.CsvStore",null,{constructor:function(a){this._attributes=[];this._attributeIndexes={};this._dataArray=
[];this._arrayOfAllItems=[];this._loadFinished=!1;a.url&&(this.url=a.url);this._csvData=a.data;a.label?this.label=a.label:""===this.label&&(this.label=void 0);this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._loadInProgress=!1;this._queuedFetches=[];this.identifier=a.identifier;""===this.identifier?delete this.identifier:this._idMap={};"separator"in a&&(this.separator=a.separator);"urlPreventCache"in a&&(this.urlPreventCache=
a.urlPreventCache?!0:!1)},url:"",label:"",identifier:"",separator:",",urlPreventCache:!1,_assertIsItem:function(a){if(!this.isItem(a))throw Error(this.declaredClass+": a function was passed an item argument that was not an item");},_getIndex:function(a){a=this.getIdentity(a);this.identifier&&(a=this._idMap[a]);return a},getValue:function(a,c,f){this._assertIsItem(a);var g=f;if("string"===typeof c)c=this._attributeIndexes[c],null!=c&&(g=this._dataArray[this._getIndex(a)][c]||f);else throw Error(this.declaredClass+
": a function was passed an attribute argument that was not a string");return g},getValues:function(a,c){return(a=this.getValue(a,c))?[a]:[]},getAttributes:function(a){this._assertIsItem(a);var c=[];a=this._dataArray[this._getIndex(a)];for(var f=0;f<a.length;f++)""!==a[f]&&c.push(this._attributes[f]);return c},hasAttribute:function(a,c){this._assertIsItem(a);if("string"===typeof c)return c=this._attributeIndexes[c],a=this._dataArray[this._getIndex(a)],"undefined"!==typeof c&&c<a.length&&""!==a[c];
throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");},containsValue:function(a,c,g){var m=void 0;"string"===typeof g&&(m=f.patternToRegExp(g,!1));return this._containsValue(a,c,g,m)},_containsValue:function(a,c,f,g){a=this.getValues(a,c);for(c=0;c<a.length;++c){var m=a[c];if("string"===typeof m&&g)return null!==m.match(g);if(f===m)return!0}return!1},isItem:function(a){if(a&&a[this._storeProp]===this)if(a=a[this._idProp],this.identifier){if(this._dataArray[this._idMap[a]])return!0}else if(0<=
a&&a<this._dataArray.length)return!0;return!1},isItemLoaded:function(a){return this.isItem(a)},loadItem:function(a){},getFeatures:function(){return this._features},getLabel:function(a){if(this.label&&this.isItem(a))return this.getValue(a,this.label)},getLabelAttributes:function(a){return this.label?[this.label]:null},_fetchItems:function(a,c,g){var m=this,q=function(a,g){var n=null;if(a.query){var q,e,n=[],h=a.queryOptions?a.queryOptions.ignoreCase:!1,A={};for(q in a.query)e=a.query[q],"string"===
typeof e&&(A[q]=f.patternToRegExp(e,h));for(h=0;h<g.length;++h){var x=!0,y=g[h];for(q in a.query)e=a.query[q],m._containsValue(y,q,e,A[q])||(x=!1);x&&n.push(y)}}else n=g.slice(0,g.length);c(n,a)};if(this._loadFinished)q(a,this._arrayOfAllItems);else if(""!==this.url)if(this._loadInProgress)this._queuedFetches.push({args:a,filter:q});else{this._loadInProgress=!0;var u=n.get({url:m.url,handleAs:"text",preventCache:m.urlPreventCache});u.addCallback(function(c){try{m._processData(c),q(a,m._arrayOfAllItems),
m._handleQueuedFetches()}catch(z){g(z,a)}});u.addErrback(function(c){m._loadInProgress=!1;if(g)g(c,a);else throw c;});var t=null;a.abort&&(t=a.abort);a.abort=function(){var c=u;c&&-1===c.fired&&(c.cancel(),c=null);t&&t.call(a)}}else if(this._csvData)try{this._processData(this._csvData),this._csvData=null,q(a,this._arrayOfAllItems)}catch(E){g(E,a)}else{var w=Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(g)g(w,a);else throw w;}},close:function(a){},
_getArrayOfArraysFromCsvFileContents:function(a){if(m.isString(a)){var c=/^\s+/g,f=/\s+$/g,g=/""/g,n=[],B=this._splitLines(a);for(a=0;a<B.length;++a){var t=B[a];if(0<t.length){for(var t=t.split(this.separator),w=0;w<t.length;){var E=t[w].replace(c,""),z=E.replace(f,""),F=z.charAt(0),H=z.charAt(z.length-1),e=z.charAt(z.length-2),h=z.charAt(z.length-3);if(2===z.length&&'""'==z)t[w]="";else if('"'==F&&('"'!=H||'"'==H&&'"'==e&&'"'!=h)){if(w+1===t.length)return;t[w]=E+this.separator+t[w+1];t.splice(w+
1,1)}else'"'==F&&'"'==H&&(z=z.slice(1,z.length-1),z=z.replace(g,'"')),t[w]=z,w+=1}n.push(t)}}this._attributes=n.shift();for(a=0;a<this._attributes.length;a++)this._attributeIndexes[this._attributes[a]]=a;this._dataArray=n}},_splitLines:function(a){var c=[],f,g="",m=!1;for(f=0;f<a.length;f++){var n=a.charAt(f);switch(n){case '"':m=!m;g+=n;break;case "\r":m?g+=n:(c.push(g),g="",f<a.length-1&&"\n"==a.charAt(f+1)&&f++);break;case "\n":m?g+=n:(c.push(g),g="");break;default:g+=n}}""!==g&&c.push(g);return c},
_processData:function(a){this._getArrayOfArraysFromCsvFileContents(a);this._arrayOfAllItems=[];if(this.identifier&&void 0===this._attributeIndexes[this.identifier])throw Error(this.declaredClass+": Identity specified is not a column header in the data set.");for(a=0;a<this._dataArray.length;a++){var c=a;this.identifier&&(c=this._dataArray[a][this._attributeIndexes[this.identifier]],this._idMap[c]=a);this._arrayOfAllItems.push(this._createItemFromIdentity(c))}this._loadFinished=!0;this._loadInProgress=
!1},_createItemFromIdentity:function(a){var c={};c[this._storeProp]=this;c[this._idProp]=a;return c},getIdentity:function(a){return this.isItem(a)?a[this._idProp]:null},fetchItemByIdentity:function(a){var c,f=a.scope?a.scope:g.global;if(this._loadFinished)c=this._createItemFromIdentity(a.identity),this.isItem(c)||(c=null),a.onItem&&a.onItem.call(f,c);else{var m=this;if(""!==this.url)this._loadInProgress?this._queuedFetches.push({args:a}):(this._loadInProgress=!0,c=n.get({url:m.url,handleAs:"text"}),
c.addCallback(function(c){try{m._processData(c);var g=m._createItemFromIdentity(a.identity);m.isItem(g)||(g=null);a.onItem&&a.onItem.call(f,g);m._handleQueuedFetches()}catch(G){a.onError&&a.onError.call(f,G)}}),c.addErrback(function(c){this._loadInProgress=!1;a.onError&&a.onError.call(f,c)}));else if(this._csvData)try{m._processData(m._csvData),m._csvData=null,c=m._createItemFromIdentity(a.identity),m.isItem(c)||(c=null),a.onItem&&a.onItem.call(f,c)}catch(D){a.onError&&a.onError.call(f,D)}}},getIdentityAttributes:function(a){return this.identifier?
[this.identifier]:null},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var a=0;a<this._queuedFetches.length;a++){var c=this._queuedFetches[a],f=c.filter,g=c.args;f?f(g,this._arrayOfAllItems):this.fetchItemByIdentity(c.args)}this._queuedFetches=[]}}});m.extend(c,t);return c})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ../urlUtils ./ServiceGeneratedFeatureCollection".split(" "),function(m,
c,n,g,f,t,a,u,q){m=m([q],{declaredClass:"esri.layers.GeoRSSLayer",serviceUrl:u.getProtocolForWebResource()+"//utility.arcgis.com/sharing/rss",constructor:function(a,c){t.defaults.geoRSSService&&(this.serviceUrl=t.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=a({url:this.serviceUrl,content:{url:this.url,refresh:this.loaded?!0:void 0,outSR:this._outSR?n.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"})},_initLayer:function(a){this.inherited(arguments);
this.loaded||(this.loaded=!0,this.onLoad(this))}});g("extend-esri")&&c.setObject("layers.GeoRSSLayer",m,f);return m})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,
E){m=m([G],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",constructor:function(a,c){this.pointSymbol=c&&c.pointSymbol;this.polylineSymbol=c&&c.polylineSymbol;this.polygonSymbol=c&&c.polygonSymbol;this._outSR=c&&(c.outSpatialReference||c.outSR)||new q({wkid:4326});this._options=n.mixin({},c)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var a=[];this._fLayers&&(a=a.concat(this._fLayers));return a},onRefresh:function(){},onOpacityChange:function(){},
refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._createLayer()},_createLayer:function(a){var c=this;this._fireUpdateStart();a=this.parse(a);a.addCallback(function(a){c._io=null;c._initLayer(a)});a.addErrback(function(a){c._io=null;a=n.mixin(Error(),a);a.message="Unable to load resource: "+c.url+" "+(a.message||"");c._fireUpdateEnd(a);c.onError(a)})},_initLayer:function(a){this.loaded&&this._removeInternalLayers();this.name=a.name;this.description=a.description;this.snippet=
a.snippet;this.featureInfos=a.featureInfos;this.fullExtent=this.initialExtent=new v(a.lookAtExtent);this.copyright=a.author||a.copyright;var c;(a=n.getObject("featureCollection.layers",!1,a))&&0<a.length&&(this._fLayers=[],g.forEach(a,function(a,e){var h=n.getObject("featureSet.features",!1,a);h&&0<h.length&&(c=n.mixin({outFields:["*"],infoTemplate:a.popupInfo?new E(a.popupInfo):null,editable:!1},this._options),c.id&&(c.id=c.id+"_"+e),c.webgl=!1,a.layerDefinition.capabilities="Query,Data",a=new w(a,
c),a.geometryType&&(this["_"+a.geometryType]=a),this._fLayers.push(a))},this),0===this._fLayers.length&&delete this._fLayers);this.items=[];this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol&&(a=new B(this.pointSymbol),this._esriGeometryPoint.setRenderer(a)));this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),this.polylineSymbol&&(a=new B(this.polylineSymbol),this._esriGeometryPolyline.setRenderer(a)));
this._esriGeometryPolygon&&(this.items=this.items.concat(this._esriGeometryPolygon.graphics),this.polygonSymbol&&(a=new B(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(a)));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();var c=a.spatialReference,f=this._outSR,e;if(c.wkid)e=c._isWebMercator()&&f._isWebMercator()||c.wkid===f.wkid;else if(c.wkt)e=c.wkt===f.wkt;else{console.log("_setMap - map has invalid spatial reference");
return}if(!e)if(c._isWebMercator()&&4326===f.wkid)this._converter=D.geographicToWebMercator;else if(f._isWebMercator()&&4326===c.wkid)this._converter=D.webMercatorToGeographic;else{console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");return}(c=this._fLayers)&&0<c.length&&g.forEach(c,function(c){if(this._converter){var e=c.graphics,h,f,g=e?e.length:0;for(h=0;h<g;h++)(f=e[h].geometry)&&e[h].setGeometry(this._converter(f))}a.addLayer(c)},
this);this.setVisibility(this.visible);this._fireUpdateEnd()},_removeInternalLayers:function(){var a=this._map;a&&g.forEach(this.getFeatureLayers(),a.removeLayer,a)},setScaleRange:function(a,c){this.inherited(arguments);g.forEach(this.getFeatureLayers(),function(f){f.setScaleRange(a,c)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(a){this.opacity!=a&&(g.forEach(this.getFeatureLayers(),function(c){c.setOpacity(a)}),this.opacity=this._options.opacity=
a,this.onOpacityChange(a))},onVisibilityChange:function(a){this._fireUpdateStart();g.forEach(this.getFeatureLayers(),function(c){c.setVisibility(a)});this._fireUpdateEnd()},_setMap:function(a,c){this.inherited(arguments);this._map=a;var g=this._div=f.create("div",null,c);t.set(g,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return g},_unsetMap:function(a,g){this._io&&this._io.cancel();c.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var m=this._div;m&&(g.removeChild(m),f.destroy(m));this._div=null;this.inherited(arguments)}});a("extend-esri")&&n.setObject("layers._ServiceGeneratedFeatureCollection",m,u);return m})},"esri/layers/WFSLayer":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/on ../request ../kernel ../graphic ../renderers/jsonUtils ../symbols/jsonUtils ../Color ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent ../geometry/Point ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ./LabelClass ./GraphicsLayer".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F,H,e,h,A,x,y,J,r){m=m([r],{declaredClass:"esri.layers.WFSLayer",constructor:function(b){this.geometryType=this.describeFeatureTypeUrl=this.getFeatureUrl=this.layerNamespace="";this.fields=[];this.spatialReferences=[];this.fullExtent=null;this.visible=!0;this.renderer=null;this.id="WFSLayer";this._url="";this._version="1.1.0";this._layerName="";this._nsLayerNames={};this._layerDefinedGeometryType="esriGeometryComplex";this._wkid=3857;this._mode="snapshot";
this._maxFeatures=100;this._inverseResponse=this._inverseFilter=!1;this._nsGeometryFieldName=this._getFeatureRequest=this._nsFields="";this._graphicArray=[];this._gmlNS="http://www.opengis.net/gml";this._layerEventHandlers=[];this.customParameters=this._describeFeatureTypeCallback=this._getCapabilitiesCallback=null;this.showLabels=!0;this.labelingInfo=null;b&&(b.id&&(this.id=b.id),this.showLabels=null!==b.showLabels?b.showLabels:!0);this.onError=n.hitch(this,this.onError);this._errorSupport=n.hitch(this,
this._errorSupport);this._parseGml=n.hitch(this,this._parseGml);this._getCapabilities=n.hitch(this,this._getCapabilities);this._getCapabilitiesResponse=n.hitch(this,this._getCapabilitiesResponse);this._describeFeatureTypeResponse=n.hitch(this,this._describeFeatureTypeResponse);this._pointSymbol=new w(w.STYLE_CIRCLE,6,new E(E.STYLE_SOLID,new G([0,255,0]),1),new G([255,0,0]));this._lineSymbol=new E(E.STYLE_SOLID,new G([0,255,0]),3);this._polygonSymbol=new z(z.STYLE_SOLID,new E(E.STYLE_SOLID,new G([255,
0,0]),2),new G([255,255,0,.25]));this.loaded=!1;this._isProjectedOk=!0},initialize:function(b,a){b.id&&(this.id=b.id);b.url&&(this._url=b.url);b.version&&(this._version=b.version);this.customParameters=b.customParameters;this._getCapabilities(a)},selectLayer:function(b,a){this._layerName=b.layerName;this._wkid=b.wkid;this._mode=b.mode;this._maxFeatures=b.maxFeatures;this._inverseResponse=b.swapXY;this._inverseFilter=b.swapXYFilter;this.geometryType=b.geometryType;this._describeFeatureType(a);this.loaded=
!0},toJson:function(){var b={};b.id=this.id;b.url=this._url;b.version=this._version;b.mode="snapshot"===this._mode?0:1;b.name=this._layerName;b.geometryType=this.geometryType;b.wkid=this._wkid;b.maxFeatures=this._maxFeatures;b.swapXY=this._inverseResponse;b.swapXYFilter=this._inverseFilter;b.pointSymbol=this._pointSymbol.toJson();b.lineSymbol=this._lineSymbol.toJson();b.polygonSymbol=this._polygonSymbol.toJson();b.showLabels=this.showLabels;this.labelingInfo&&(b.labelingInfo=g.map(this.labelingInfo,
function(b){return b.toJson()}));this.customParameters&&(b.customParameters=this.customParameters);return b},fromJson:function(b,a){b.id&&(this.id=b.id);b.url&&(this._url=b.url);b.version&&(this._version=b.version);b.mode&&(this._mode=0===b.mode?"snapshot":"onDemand");b.name&&(this._layerName=b.name);b.geometryType&&(this.geometryType=b.geometryType);b.wkid&&(this._wkid=b.wkid);b.maxFeatures&&(this._maxFeatures=b.maxFeatures);b.swapXY&&(this._inverseResponse=b.swapXY);b.swapXYFilter&&(this._inverseFilter=
b.swapXYFilter);b.pointSymbol&&(this._pointSymbol=B.fromJson(b.pointSymbol));b.lineSymbol&&(this._lineSymbol=B.fromJson(b.lineSymbol));b.polygonSymbol&&(this._polygonSymbol=B.fromJson(b.polygonSymbol));this.showLabels=null!=b.showLabels?b.showLabels:!0;b.labelingInfo&&(this.labelingInfo=g.map(b.labelingInfo,function(b){return new J(b)}));this.customParameters=b.customParameters;this._getCapabilities(a);this.loaded=!0},setPointSymbol:function(b){this._pointSymbol=b},setLineSymbol:function(b){this._lineSymbol=
b},setPolygonSymbol:function(b){this._polygonSymbol=b},_setMap:function(b){this._map=b;var a=this.inherited(arguments);this._map&&(this._layerEventHandlers.push(this._map.on("extent-change",n.hitch(this,"refresh"))),this._layerEventHandlers.push(this.on("visibility-change",n.hitch(this,"_visibilityChange"))));this._getFeature();this.refresh();return a},_unsetMap:function(){for(var b=0;b<this._layerEventHandlers.length;b++)f.disconnect(this._layerEventHandlers[b]);this.refresh();this.inherited(arguments)},
refresh:function(b){this.clear();this.redraw();"ondemand"===this._mode.toLowerCase()&&this._fireUpdateStart()},redraw:function(){if(this.visible)for(var b=0;b<this._graphicArray.length;b++){var a=this._graphicArray[b],c=a.geometry,l=null;"point"===c.type?l=this.renderer?this.renderer.getSymbol(a):this._pointSymbol:"multipoint"===c.type?l=this.renderer?this.renderer.getSymbol(a):this._pointSymbol:"polyline"===c.type?l=this.renderer?this.renderer.getSymbol(a):this._lineSymbol:"polygon"===c.type&&(l=
this.renderer?this.renderer.getSymbol(a):this._polygonSymbol);a.setSymbol(l);this.add(a)}},_visibilityChange:function(b){this.visible=b.visible;this.redraw()},onUpdateStart:function(){this._getFeature()},onUpdateEnd:function(){this.clear();this.redraw()},setLabelingInfo:function(b){b?(this.labelingInfo=b,this._fixLabelExpr()):delete this.labelingInfo;this.onLabelingInfoChange()},onLabelingInfoChange:function(){},_fixLabelExpr:function(){var b=/\[([^\[\]]+)\]/ig,a,c=this,l=function(b,a){b=c._getField(a,
!0);return"["+(b&&b.name||a)+"]"};g.forEach(this.labelingInfo,function(d){if(a=d.labelExpression)d.labelExpression=a.replace(b,l)})},_getField:function(b,a){var d=this.fields;if(!d||0===d.length)return null;var l;a&&(b=b.toLowerCase());g.some(d,function(d){var c=!1;(c=a?d&&d.name.toLowerCase()===b?!0:!1:d&&d.name===b?!0:!1)&&(l=d);return c});return l},setCustomParameters:function(b){this.customParameters=b;this._getFeature();this.refresh()},_getCapabilities:function(b){this._getCapabilitiesCallback=
b;b=n.trim(this._url);if(""===b)this.onError("WFSLayer: url is invalid");else if("1.0.0"!==this._version&&"1.1.0"!==this._version&&"2.0.0"!==this._version)this.onError("WFSLayer: version is invalid");else if(""!==b){var a=b.indexOf("?");b=b+(-1===a?"?":"\x26")+"service\x3dWFS\x26request\x3dGetCapabilities\x26version\x3d"+this._version;b=this._appendCustomParameters(b);u({url:b,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._getCapabilitiesResponse,this._errorSupport)}},_errorSupport:function(b){this.onError(b)},
_getCapabilitiesResponse:function(b){var a,c,l,k,e,h=new DOMParser;try{var f=h.parseFromString(b,"text/xml"),g=this._readExceptionReport(f,b);if(g)this.onError("WFSLayer: getCapabilities - returns exception: "+g);else{var m=f.documentElement.attributes.getNamedItem("version");if(m){this._version=m.value;var r="2.0.0"===this._version?"http://www.opengis.net/wfs/2.0":"http://www.opengis.net/wfs",y;if("2.0.0"===this._version)for(a=f.getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Operation"),
c=0;c<a.length;c++)(k=a[c].attributes.getNamedItem("name"))&&"DescribeFeatureType"===k.value&&(y=a[c].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Get"),this.describeFeatureTypeUrl=y[0].attributes.getNamedItem("xlink:href").value),k&&"GetFeature"===k.value&&(e=a[c].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Post"),this.getFeatureUrl=e[0].attributes.getNamedItem("xlink:href").value);else if("1.1.0"===this._version)for(a=f.getElementsByTagNameNS("http://www.opengis.net/ows",
"Operation"),c=0;c<a.length;c++)(k=a[c].attributes.getNamedItem("name"))&&"DescribeFeatureType"===k.value&&(y=a[c].getElementsByTagNameNS("http://www.opengis.net/ows","Get"),this.describeFeatureTypeUrl=y[0].attributes.getNamedItem("xlink:href").value),k&&"GetFeature"===k.value&&(e=a[c].getElementsByTagNameNS("http://www.opengis.net/ows","Post"))&&e.length&&(this.getFeatureUrl=e[0].attributes.getNamedItem("xlink:href").value);else if("1.0.0"===this._version){var n=f.getElementsByTagNameNS(r,"DescribeFeatureType");
if(!n||!n.length){this.onError("WFSLayer: getCapabilities - no describeFeatureType info");return}y=n[0].getElementsByTagNameNS(r,"Get");this.describeFeatureTypeUrl=y[0].attributes.getNamedItem("onlineResource").value;var x=f.getElementsByTagNameNS(r,"GetFeature");if(!x||!x.length){this.onError("WFSLayer: getCapabilities - no GetFeature info");return}(e=x[0].getElementsByTagNameNS(r,"Post"))&&e.length&&(this.getFeatureUrl=e[0].attributes.getNamedItem("onlineResource").value)}this._nsLayerNames={};
b=[];var A=f.getElementsByTagNameNS(r,"FeatureTypeList");for(c=0;c<A.length;c++){var J=A[c].getElementsByTagNameNS(r,"FeatureType");for(l=0;l<J.length;l++){var q=J[l],t=q.getElementsByTagNameNS(r,"Name")[0],u=t.textContent,w=u.indexOf(":"),B=u.substring(0,w),v=u.substring(w+1),z=t.lookupNamespaceURI(B);null===z&&(z=t.lookupNamespaceURI(null));this._nsLayerNames[v]={prefix:B,namespace:z};var G=q.getElementsByTagNameNS(r,"Title"),F=0<G.length?G[0].textContent:"";""===F&&(F=v);this.spatialReferences=
this._readFactoryCodes(this._version,q);var E=this._readDefaultBBOX(this._version,q);b.push({name:v,title:F,spatialReferences:this.spatialReferences,extent:E})}}this._describeFeatureType();var D=this._getCapabilitiesCallback;D&&D(b)}else this.onError("WFSLayer: getCapabilities - document not recognized.")}}catch(Q){this.onError("WFSLayer: getCapabilities - parsing error")}},_readFactoryCodes:function(b,a){var d,l=[];if("2.0.0"===b||"1.1.0"===b){b=a.getElementsByTagNameNS("*","DefaultSRS");this._addCodeList(l,
b[0]);b=a.getElementsByTagNameNS("*","DefaultCRS");this._addCodeList(l,b[0]);b=a.getElementsByTagNameNS("*","OtherSRS");for(d=0;d<b.length;d++)this._addCodeList(l,b[d]);b=a.getElementsByTagNameNS("*","OtherCRS");for(d=0;d<b.length;d++)this._addCodeList(l,b[d])}else"1.0.0"===b&&(b=a.getElementsByTagNameNS("*","SRS"),this._addCodeList(l,b[0]));for(a=!1;0<l.length;){4326===l[0]&&(a=!0);break}a||l.push(4326);return l},_addCodeList:function(b,a){a&&(a=a.textContent.match(/\d+/g),0<a.length&&(a=parseInt(a[a.length-
1],10),84===a&&(a=4326),b.push(a)))},_readDefaultBBOX:function(b,a){var d,l,c,e;if("2.0.0"===b||"1.1.0"===b){d=a.getElementsByTagNameNS("*","WGS84BoundingBox");if(!d[0]||!d[0].attributes)return[];l=d[0].getElementsByTagNameNS("*","LowerCorner");e=d[0].getElementsByTagNameNS("*","UpperCorner");if(0>=l.length||0>=e.length)return[];c=l[0].textContent;d=c.indexOf(" ");l=c.substring(0,d);c=c.substring(d+1);d=e[0].textContent;b=d.indexOf(" ");e=d.substring(0,b);d=d.substring(b+1)}else if("1.0.0"===b){d=
a.getElementsByTagNameNS("*","LatLongBoundingBox");if(!d[0]||!d[0].attributes)return[];l=d[0].attributes.getNamedItem("minx").value;c=d[0].attributes.getNamedItem("miny").value;e=d[0].attributes.getNamedItem("maxx").value;d=d[0].attributes.getNamedItem("maxy").value}l=parseFloat(l,10);c=parseFloat(c,10);e=parseFloat(e,10);d=parseFloat(d,10);return[l,c,e,d]},_describeFeatureType:function(b){if(""!==this._layerName)if(""===this.describeFeatureTypeUrl)this.onError("WFSLayer: invalid describeFeatureType url");
else if(""===this._wkid)this.onError("WFSLayer: invalid wkid");else if("snapshot"!==this._mode&&"onDemand"!==this._mode)this.onError("WFSLayer: invalid mode");else if(""===this._maxFeatures||0>this._maxFeatures||1E6<this._maxFeatures)this.onError("WFSLayer: invalid maxFeatures");else{this._describeFeatureTypeCallback=b;var a=n.trim(this.describeFeatureTypeUrl);if(""!==a){var c=-1===a.indexOf("?")?"?":"\x26",l=this._nsLayerNames[this._layerName];if(void 0===l)this.onError("WFSLayer: invalid layerName");
else b=l.prefix,l=l.namespace,a=a+c+"service\x3dWFS\x26request\x3dDescribeFeatureType\x26version\x3d"+this._version,a+="\x26typeName\x3d",""!==b&&(a+=b+":"),a+=encodeURIComponent(this._layerName),""!==b&&(a+="\x26namespace\x3dxmlns("+b+"\x3d"+encodeURIComponent(l)+")"),a=this._appendCustomParameters(a),u({url:a,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._describeFeatureTypeResponse,this._errorSupport)}}},_describeFeatureTypeResponse:function(b){var a;a=(new DOMParser).parseFromString(b,
"text/xml");if(b=this._readExceptionReport(a,b))this.onError("WFSLayer: DescribeFeatureType - returns exception: "+b);else{this.fields=[];b=a.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","schema");for(a=0;a<b.length;a++){var c=this._readAllFields(b[a]);null!==c&&(this._layerDefinedGeometryType=c[0],this.fields=c[1])}this.geometryType&&""!==this.geometryType||(this.geometryType=this._layerDefinedGeometryType);for(a=0;a<this.fields.length;a++)b=this.fields[a],"esriFieldTypeGeometry"===
b.type&&(this._nsGeometryFieldName=b.name);this.layerNamespace=this._nsLayerNames[this._layerName].namespace;if(0===this.fields.length)this.onError("WFSLayer: DescribeFeatureType - can't get fields");else this._getFeature(),(a=this._describeFeatureTypeCallback)&&a(this.fields)}},_readAllFields:function(b){for(var a=b.childNodes,c=0;c<a.length;c++){var l=a[c];if("element"===l.localName){var k=l.attributes;if(k.name.value===this._layerName)return(a=k.type)?(l=a.value,a=l.indexOf(":"),l=l.substring(a+
1),this._readFieldsFromGlobalComplextType(b,l)):this._readFieldsFromLocalComplextType(l)}}return null},_readFieldsFromGlobalComplextType:function(b,a){b=b.childNodes;for(var d=0;d<b.length;d++){var l=b[d];if("complexType"===l.localName&&l.attributes.name.value===a)return this._readFieldsFromLocalComplextType(l)}return null},_readFieldsFromLocalComplextType:function(b){for(var a=[],c="esriGeometryComplex",l=b.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","element"),k=0;k<l.length;k++){var e=
l[k],h="",f=e.attributes.getNamedItem("name");f&&(h=f.value);if(""!==h){var g=b="",m=e.attributes.getNamedItem("type"),f="unknown";if(null!==m){var g=m.value,r=g.indexOf(":");b=g.substring(0,r);g=g.substring(r+1);f=m.lookupNamespaceURI(b);null===f&&(f=m.lookupNamespaceURI(null))}if(""===g)for(var e=e.childNodes,y=0;y<e.length;y++)if(b=e[y],"simpleType"===b.localName){b=b.childNodes;for(y=0;y<b.length;y++)if(node2=b[y],"restriction"===node2.localName){m=node2.attributes.getNamedItem("base");g=m.value;
r=g.indexOf(":");b=g.substring(0,r);g=g.substring(r+1);break}if(""!==g)break}e="Unknown";switch(g){case "integer":case "nonPositiveInteger":case "negativeInteger":case "long":case "int":case "short":case "byte":case "nonNegativeInteger":case "unsignedLong":case "unsignedInt":case "unsignedShort":case "unsignedByte":case "positiveInteger":e="esriFieldTypeInteger";a.push({name:h,alias:h,type:e,wfsNamespace:f});break;case "float":case "double":case "decimal":e="esriFieldTypeDouble";a.push({name:h,alias:h,
type:e,wfsNamespace:f});break;case "boolean":case "string":case "gYearMonth":case "gYear":case "gMonthDay":case "gDay":case "gMonth":case "anyURI":case "QName":case "NOTATION":case "normalizedString":case "token":case "language":case "IDREFS":case "ENTITIES":case "NMTOKEN":case "NMTOKENS":case "Name":case "NCName":case "ID":case "IDREF":case "ENTITY":e="esriFieldTypeString";a.push({name:h,alias:h,type:e,wfsNamespace:f});break;case "duration":case "dateTime":case "time":case "date":e="esriFieldTypeDate";
a.push({name:h,alias:h,type:e,wfsNamespace:f});break;case "PointPropertyType":case "MultiPointPropertyType":e="esriFieldTypeGeometry";c="esriGeometryPoint";a.push({name:h,alias:h,type:e,wfsNamespace:f});break;case "MultiCurvePropertyType":case "MultiLineStringPropertyType":e="esriFieldTypeGeometry";c="esriGeometryPolyline";a.push({name:h,alias:h,type:e,wfsNamespace:f});break;case "MultiSurfacePropertyType":case "MultiPolygonPropertyType":e="esriFieldTypeGeometry";c="esriGeometryPolygon";a.push({name:h,
alias:h,type:e,wfsNamespace:f});break;case "GeometryPropertyType":case "MultiGeometryPropertyType":e="esriFieldTypeGeometry",c="esriGeometryComplex",a.push({name:h,alias:h,type:e,wfsNamespace:f})}}}return[c,a]},_getFeature:function(){var b;b="\x3c?xml version\x3d'1.0' encoding\x3d'utf-8'?\x3e\n\x3cGetFeature \n xmlns:xsi\x3d'http://www.w3.org/2001/XMLSchema-instance'\n xmlns:gml\x3d'http://www.opengis.net/gml'\n xmlns:ogc\x3d'http://www.opengis.net/ogc'\n xmlns:wfs\x3d'http://www.opengis.net/wfs'\n";
b="2.0.0"===this._version?b+" xmlns\x3d'http://www.opengis.net/wfs/2.0'\n":b+" xmlns\x3d'http://www.opengis.net/wfs'\n";var a=this._nsLayerNames[this._layerName];if(void 0===a)this.onError("WFSLayer: invalid layerName");else{var c=a.prefix,a=a.namespace;if("ondemand"===this._mode.toLowerCase()&&""===this._nsGeometryFieldName)this.onError("WFSLayer: GetFeature - can't use 'onDemand' mode as geometryFieldName is unknown.");else if(b+=" xmlns:"+c+"\x3d'"+a+"'\n",b="2.0.0"===this._version?b+(" version\x3d'"+
this._version+"' service\x3d'WFS' count\x3d'"+this._maxFeatures+"'\x3e\n"):b+(" version\x3d'"+this._version+"' service\x3d'WFS' maxFeatures\x3d'"+this._maxFeatures+"'\x3e\n"),b="2.0.0"===this._version?b+(" \x3cQuery typeNames\x3d'"+c+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"):b+(" \x3cwfs:Query typeName\x3d'"+c+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"),"ondemand"===this._mode.toLowerCase()&&(b=b+"  \x3cogc:Filter xmlns:ogc\x3d'http://www.opengis.net/ogc'\x3e\n   \x3cogc:BBOX\x3e\n"+
("    \x3cogc:PropertyName\x3e"+c+":"+this._nsGeometryFieldName+"\x3c/ogc:PropertyName\x3e\n"),b+="    \x3cgml:Box srsName\x3d'EPSG:"+this._wkid+"'\x3e\n",b=this._inverseFilter?b+"      \x3cgml:coordinates\x3e{ymin},{xmin} {ymax},{xmax}\x3c/gml:coordinates\x3e\n":b+"      \x3cgml:coordinates\x3e{xmin},{ymin} {xmax},{ymax}\x3c/gml:coordinates\x3e\n",b+="    \x3c/gml:Box\x3e\n   \x3c/ogc:BBOX\x3e\n  \x3c/ogc:Filter\x3e\n"),b="2.0.0"===this._version?b+" \x3c/Query\x3e\n":b+" \x3c/wfs:Query\x3e\n",this._getFeatureRequest=
b+"\x3c/GetFeature\x3e\n",""===this.getFeatureUrl)this.onError("WFSLayer: getFeature - server doesn't support POST method.");else if(""!==this._getFeatureRequest&&this._map&&null!==this._map.spatialReference.wkid){b=this._getFeatureRequest;if("ondemand"===this._mode.toLowerCase()){b=this._map.extent.xmin;var c=this._map.extent.ymin,a=this._map.extent.xmax,l=this._map.extent.ymax,k={},e=this._map.spatialReference,h=new F(this._wkid);this._projectFromSRToSR(e,h,b,c,k)&&(b=k.x,c=k.y);this._projectFromSRToSR(e,
h,a,l,k)&&(a=k.x,l=k.y);b=this._getFeatureRequest.replace(/{xmin}/,b).replace(/{ymin}/,c).replace(/{xmax}/,a).replace(/{ymax}/,l)}c=this._appendCustomParameters(this.getFeatureUrl);u({url:c,handleAs:"text",headers:{"Content-Type":"text/xml"},postData:b},{usePost:!0}).then(this._parseGml,this._errorSupport)}}},_parseGml:function(b){if(this._map&&this._map.spatialReference&&this._map.spatialReference.wkid){var a=(new DOMParser).parseFromString(b,"text/xml");if(b=this._readExceptionReport(a,b))this.onError("WFSLayer: GetFeature - returns exception: "+
b);else this._gmlNS="2.0.0"===this._version?"http://www.opengis.net/gml/3.2":"http://www.opengis.net/gml",""===this._wkid&&(this._wkid=this._map.spatialReference.wkid),this._graphicArray=this._readFeatureMembers(a,this._wkid,2,this._nsLayerNames[this._layerName].namespace,this._layerName),this.fullExtent=this._createFullExtent(this._graphicArray),this.onLabelingInfoChange(),"ondemand"===this._mode.toLowerCase()?this._fireUpdateEnd():this.refresh()}},_limit4326:function(b){for(var a=0;a<b.length;a++){var c=
b[a].geometry;4326===c.spatialReference.wkid&&(c.x=this._limit4326X(c.x),c.y=this._limit4326Y(c.y))}},_limit4326X:function(b){180<=b&&(b=179.99);-180>=b&&(b=-179.99);return b},_limit4326Y:function(b){90<=b&&(b=89.99);-90>=b&&(b=-89.99);return b},_createFullExtent:function(b){for(var a=null,c=0;c<b.length;c++){var l=b[c].geometry,k=null;(k="point"===l.geometryType?new e(l.x,l.y,l.x,l.y,l.spatialReference):l.getExtent())&&(a=null===a?k:a.union(k))}return a},_readExceptionReport:function(b,a){return 0<
b.getElementsByTagNameNS("*","ExceptionReport").length||0<b.getElementsByTagNameNS("*","ServiceExceptionReport").length?a:""},_readFeatureMembers:function(b,a,c,l,k){var d,e,h,p;e=this._readWkidFromNode(b);-1!=e&&(a=e);e=this._readSrsDimension(b);0!==e&&(c=e);var f=[];h=b.getElementsByTagNameNS("*","featureMembers");for(e=0;e<h.length;e++)for(d=h[e],p=d.getElementsByTagNameNS(l,k),0===p.length&&(p=d.getElementsByTagNameNS(null,k)),0===p.length&&(p=d.getElementsByTagNameNS("*",k)),d=0;d<p.length;d++)this._readLayer(f,
p[d],a,c);h=b.getElementsByTagNameNS("*","featureMember");for(e=0;e<h.length;e++)for(d=h[e],p=d.getElementsByTagNameNS(l,k),0===p.length&&(p=d.getElementsByTagNameNS(null,k)),0===p.length&&(p=d.getElementsByTagNameNS("*",k)),d=0;d<p.length;d++)this._readLayer(f,p[d],a,c);h=b.getElementsByTagNameNS("*","member");for(e=0;e<h.length;e++)for(d=h[e],p=d.getElementsByTagNameNS(l,k),0===p.length&&(p=d.getElementsByTagNameNS(null,k)),0===p.length&&(p=d.getElementsByTagNameNS("*",k)),d=0;d<p.length;d++)this._readLayer(f,
p[d],a,c);return f},_readLayer:function(b,a,c,l){var d,e;e=this._readSrsDimension(a);0!==e&&(l=e);var h=a.childNodes,p="",f=null;for(a=0;a<h.length;a++)if(d=h[a],1==d.nodeType&&(e=d.localName,"boundedBy"!==e)){d=this._readGeometry(d,c,l);if(!this._isProjectedOk){this._isProjectedOk=!0;console.error("WFSLayer: could not project geometry.");break}if(null!==d&&(f=d,p=e,"point"!==f.geometryType||"esriGeometryPolygon"!==this.geometryType&&"esriGeometryPolyline"!==this.geometryType))break}if(f){c={};for(a=
0;a<h.length;a++)if(d=h[a],e=d.localName,l=d.textContent,e!==p)for(d=0;d<this.fields.length;d++){var g=this.fields[d];g.name==e&&(c[e]="esriFieldTypeDouble"===g.type?parseFloat(l,10):"esriFieldTypeInteger"===g.type?parseInt(l,10):l.trim())}this._convertWFSGeometryToGraphicObjects(b,f,c)}},_convertWFSGeometryToGraphicObjects:function(b,a,c){var d;if("point"===a.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===this.geometryType))d=new v,a=new h(a),d.setGeometry(a),d.setAttributes(c),
b.push(d);else if("multipoint"===a.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===this.geometryType))d=new v,a=new A(a),d.setGeometry(a),d.setAttributes(c),b.push(d);else if("polyline"===a.geometryType&&("esriGeometryPolyline"===this.geometryType||"esriGeometryComplex"===this.geometryType))d=new v,a=new x(a),d.setGeometry(a),d.setAttributes(c),b.push(d);else if("polygon"===a.geometryType&&("esriGeometryPolygon"===this.geometryType||"esriGeometryComplex"===this.geometryType))d=
new v,a=new y(a),d.setGeometry(a),d.setAttributes(c),b.push(d);else if("multigeometry"===a.geometryType)for(d=0;d<a.length;d++)this._convertWFSGeometryToGraphicObjects(b,a[d],c)},_readGeometry:function(b,a,c){var d,k;d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);k=b.getElementsByTagNameNS(this._gmlNS,"MultiSurface");if(1<=k.length)for(d=0;d<k.length;)return this._readMultiSurface(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"MultiCurve");if(1<=k.length){var e=
[];for(d=0;d<k.length;d++){var h=this._readMultiCurve(k[d],a,c);for(b=0;b<h.length;b++)e.push(h[b])}return{geometryType:"polyline",paths:e,spatialReference:{wkid:this._map.spatialReference.wkid}}}k=b.getElementsByTagNameNS(this._gmlNS,"MultiGeometry");for(d=0;d<k.length;)return this._readMultiGeometry(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"Geometry");for(d=0;d<k.length;)return this._readGeometry(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"GeometryCollection");for(d=0;d<k.length;)return this._readGeometryCollection(k[d],
a,c);k=b.getElementsByTagNameNS(this._gmlNS,"Surface");for(d=0;d<k.length;)return this._readSurface(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"Curve");for(d=0;d<k.length;)return this._readCurve(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"MultiPolygon");for(d=0;d<k.length;)return this._readMultiPolygon(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(d=0;d<k.length;)return this._readPolygon(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"MultiLineString");for(d=0;d<k.length;)return this._readMultiLineString(k[d],
a,c);k=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(d=0;d<k.length;){a=this._readLineString(k[d],a,c);c={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=[];for(b=0;b<a.length;b++)d.push(a[b]);c.paths.push(d);return c}k=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");for(d=0;d<k.length;)return this._readLinearRing(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"Box");if(1<=k.length)for(d=0;d<k.length;)return this._readBox(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,
"Envelope");for(d=0;d<k.length;)return this._readEnvelope(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"MultiPoint");if(1<=k.length)for(d=0;d<k.length;)return this._readMultiPoint(k[d],a,c);k=b.getElementsByTagNameNS(this._gmlNS,"Point");for(d=0;d<k.length;)return this._readPoint(k[d],a,c);return null},_readGeometryCollection:function(b,a,c){var d,k=this._readWkidFromNode(b);-1!=k&&(a=k);k=this._readSrsDimension(b);0!==k&&(c=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};
d=b.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(b=0;b<d.length;b++){var e=this._readGeometryMember(d[b],a,c);k.push(e)}return k},_readMultiGeometry:function(b,a,c){var d,k=this._readWkidFromNode(b);-1!=k&&(a=k);k=this._readSrsDimension(b);0!==k&&(c=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(b=0;b<d.length;b++){var e=this._readGeometryMember(d[b],a,c);k.push(e)}return k},
_readSurface:function(b,a,c){var d,k;d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);var e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};k=b.getElementsByTagNameNS(this._gmlNS,"Point");for(d=0;d<k.length;d++)e.push(this._readPoint(k[d],a,c));k=b.getElementsByTagNameNS(this._gmlNS,"patches");for(d=0;d<k.length;d++){b=this._readPatches(k[d],a,c);for(var h=0;h<b.length;h++)e.push(b[h])}return e},_readMultiSurface:function(b,
a,c){var d,k,e;d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);var h=[];h.geometryType="multigeometry";h.spatialReference={wkid:this._map.spatialReference.wkid};e=b.getElementsByTagNameNS(this._gmlNS,"surfaceMember");for(d=0;d<e.length;d++){var f=this._readSurfaceMember(e[d],a,c);for(k=0;k<f.length;k++)h.push(f[k])}e=b.getElementsByTagNameNS(this._gmlNS,"surfaceMembers");for(d=0;d<e.length;d++)for(b=this._readSurfaceMembers(e[d],a,c),k=0;k<b.length;k++)h.push(b[k]);
return h},_readCurve:function(b,a,c){var d,k=this._readWkidFromNode(b);-1!=k&&(a=k);k=this._readSrsDimension(b);0!==k&&(c=k);k={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=b.getElementsByTagNameNS(this._gmlNS,"segments");for(b=0;b<d.length;b++)for(var e=this._readSegments(d[b],a,c),h=0;h<e.length;h++)k.paths.push(e[h]);return k},_readSegments:function(b,a,c){var d,k=this._readWkidFromNode(b);-1!=k&&(a=k);k=this._readSrsDimension(b);0!==k&&(c=k);k=[];
k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"LineStringSegment");for(b=0;b<d.length;b++){var e=this._readLineStringSegment(d[b],a,c);k.push(e)}return k},_readLineStringSegment:function(b,a,c){var d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);for(b=b.getElementsByTagNameNS(this._gmlNS,"posList");0<b.length;)return this._readPosList(b[0],a,c)},_readMultiCurve:function(b,a,c){var d,
k,e,h;d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);var f=[];f.spatialReference={wkid:this._map.spatialReference.wkid};e=b.getElementsByTagNameNS(this._gmlNS,"curveMember");for(d=0;d<e.length;d++)for(h=this._readCurveMember(e[d],a,c),k=0;k<h.length;k++)f.push(h[k]);e=b.getElementsByTagNameNS(this._gmlNS,"curveMembers");for(d=0;d<e.length;d++)for(h=this._readCurveMembers(e[d],a,c),k=0;k<h.length;k++)f.push(h[k]);return f},_readGeometryMember:function(b,a,c){var d,
e;d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);e=b.getElementsByTagNameNS(this._gmlNS,"Point");for(d=0;d<e.length;)return this._readPoint(e[d],a,c);e=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(d=0;d<e.length;){a=this._readLineString(e[d],a,c);c={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};d=[];for(b=0;b<a.length;b++)d.push(a[b]);c.paths.push(d);return c}e=b.getElementsByTagNameNS(this._gmlNS,"Polygon");
for(d=0;d<e.length;)return this._readPolygon(e[d],a,c);return null},_readSurfaceMember:function(b,a,c){var d,e=this._readWkidFromNode(b);-1!=e&&(a=e);e=this._readSrsDimension(b);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(b=0;b<d.length;b++){var h=this._readPolygon(d[b],a,c);e.push(h)}return e},_readSurfaceMembers:function(b,a,c){var d,e=this._readWkidFromNode(b);-1!=e&&(a=e);e=this._readSrsDimension(b);
0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"Polygon");for(b=0;b<d.length;b++){var h=this._readPolygon(d[b],a,c);e.push(h)}return e},_readCurveMember:function(b,a,c){var d,e=this._readWkidFromNode(b);-1!=e&&(a=e);e=this._readSrsDimension(b);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"LineString");
for(b=0;b<d.length;b++){var h=this._readLineString(d[b],a,c);e.push(h)}return e},_readCurveMembers:function(b,a,c){var d,e=this._readWkidFromNode(b);-1!=e&&(a=e);e=this._readSrsDimension(b);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"LineString");for(b=0;b<d.length;b++){var h=this._readLineString(d[b],a,c);e.push(h)}return e},_readBox:function(b,a,c){var d,e,h,f,g,p,m,r=this._readWkidFromNode(b);
-1!=r&&(a=r);r=this._readSrsDimension(b);0!==r&&(c=r);r={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};e=b.getElementsByTagNameNS(this._gmlNS,"coordinates");for(d=0;d<e.length;d++)if(h=this._readCoordinates(e[d],a,c))return 1<=h.length&&(f=p=h[0][0],g=m=h[0][1]),1<=h.length&&(p=h[1][0],m=h[1][1]),r.rings.push([[f,g],[f,m],[p,m],[p,g],[f,g]]),r;e=b.getElementsByTagNameNS(this._gmlNS,"coord");return 2<=e.length?((b=this._readCoord(e[0],a,c))&&1<=b.length&&
(f=p=b[0][0],g=m=b[0][1]),(a=this._readCoord(e[1],a,c))&&1<=a.length&&(p=a[0][0],m=a[0][1]),r.rings.push([[f,g],[f,m],[p,m],[p,g],[f,g]]),r):null},_readEnvelope:function(b,a,c){var d,e,h,f;d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);e=b.getElementsByTagNameNS(this._gmlNS,"lowerCorner");for(d=0;d<e.length;d++){var g=this._readCoordinates(e[d],a,c);g&&(h=g[0])}e=b.getElementsByTagNameNS(this._gmlNS,"upperCorner");for(d=0;d<e.length;d++)(b=this._readCoordinates(e[d],
a,c))&&(f=b[0]);return h&&f?{geometryType:"polygon",rings:[[[h[0],h[1]],[h[0],f[1]],[f[0],f[1]],[f[0],h[1]],[h[0],h[1]]]],spatialReference:{wkid:this._map.spatialReference.wkid}}:null},_readPolygon:function(a,d,c){var b,e,h;b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);var f={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};e=a.getElementsByTagNameNS(this._gmlNS,"outerBoundaryIs");for(b=0;b<e.length;b++)h=this._readOuterBoundaryIs(e[b],
d,c),f.rings.push(h);e=a.getElementsByTagNameNS(this._gmlNS,"innerBoundaryIs");for(b=0;b<e.length;b++)h=this._readInnerBoundaryIs(e[b],d,c),f.rings.push(h);e=a.getElementsByTagNameNS(this._gmlNS,"exterior");for(b=0;b<e.length;b++)h=this._readExterior(e[b],d,c),f.rings.push(h);e=a.getElementsByTagNameNS(this._gmlNS,"interior");for(b=0;b<e.length;b++)h=this._readInterior(e[b],d,c),f.rings.push(h);return f},_readPolygonMember:function(b,a,c){var d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);
0!==d&&(c=d);for(b=b.getElementsByTagNameNS(this._gmlNS,"Polygon");0<b.length;)return this._readPolygon(b[0],a,c);return null},_readMultiPolygon:function(b,a,c){var d,e=this._readWkidFromNode(b);-1!=e&&(a=e);e=this._readSrsDimension(b);0!==e&&(c=e);e=[];e.geometryType="multigeometry";e.spatialReference={wkid:this._map.spatialReference.wkid};d=b.getElementsByTagNameNS(this._gmlNS,"polygonMember");for(b=0;b<d.length;b++){var h=this._readPolygonMember(d[b],a,c);e.push(h)}return e},_readOuterBoundaryIs:function(b,
a,c){var d=this._readWkidFromNode(b);-1!=d&&(a=d);d=this._readSrsDimension(b);0!==d&&(c=d);for(b=b.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<b.length;)return this._readLinearRing(b[0],a,c);return null},_readInnerBoundaryIs:function(a,d,c){var b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],d,c);return null},_readExterior:function(a,d,c){var b=this._readWkidFromNode(a);
-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],d,c);return null},_readInterior:function(a,d,c){var b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],d,c);return null},_readPatches:function(a,d,c){var b,e=this._readWkidFromNode(a);-1!=e&&(d=e);e=this._readSrsDimension(a);
0!==e&&(c=e);e=[];e.spatialReference={wkid:this._map.spatialReference.wkid};b=a.getElementsByTagNameNS(this._gmlNS,"PolygonPatch");for(a=0;a<b.length;a++)e.push(this._readPolygon(b[a],d,c));return e},_readLineString:function(a,d,c){var b,e,h,f,g;b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);var p=[];p.spatialReference={wkid:this._map.spatialReference.wkid};h=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(b=0;b<h.length;b++)if(f=this._readCoordinates(h[b],
d,c))for(e=0;e<f.length;e++)g=f[e],p.push(g);h=a.getElementsByTagNameNS(this._gmlNS,"coord");for(b=0;b<h.length;b++)if(f=this._readCoord(h[b],d,c))for(e=0;e<f.length;e++)g=f[e],p.push(g);h=a.getElementsByTagNameNS(this._gmlNS,"posList");for(b=0;b<h.length;b++)if(f=this._readPosList(h[b],d,c))for(e=0;e<f.length;e++)g=f[e],p.push(g);return p},_readLineStringMember:function(a,d,c){var b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);for(a=a.getElementsByTagNameNS(this._gmlNS,
"LineString");0<a.length;)return this._readLineString(a[0],d,c);return null},_readMultiLineString:function(a,d,c){var b,e=this._readWkidFromNode(a);-1!=e&&(d=e);e=this._readSrsDimension(a);0!==e&&(c=e);e={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};b=a.getElementsByTagNameNS(this._gmlNS,"lineStringMember");for(a=0;a<b.length;a++){var h=this._readLineStringMember(b[a],d,c);h&&e.paths.push(h)}return 1<=e.paths.length?e:null},_readPoint:function(a,d,c){var b,
e,h;b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);e=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(b=0;b<e.length;b++)if(h=this._readCoordinates(e[b],d,c))return{geometryType:"point",x:h[0][0],y:h[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};e=a.getElementsByTagNameNS(this._gmlNS,"pos");for(b=0;b<e.length;b++)if((h=this._readPos(e[b],d,c))&&0<h.length)return{geometryType:"point",x:h[0][0],y:h[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};
e=a.getElementsByTagNameNS(this._gmlNS,"coord");for(b=0;b<e.length;b++)if(a=this._readCoord(e[b],d,c))return{geometryType:"point",x:a[0][0],y:a[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};return null},_readPointMember:function(a,d,c){var b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);for(a=a.getElementsByTagNameNS(this._gmlNS,"Point");0<a.length;)return this._readPoint(a[0],d,c);return null},_readMultiPoint:function(a,d,c){var b,e=this._readWkidFromNode(a);
-1!=e&&(d=e);e=this._readSrsDimension(a);0!==e&&(c=e);e={geometryType:"multipoint",points:[],spatialReference:{wkid:this._map.spatialReference.wkid}};b=a.getElementsByTagNameNS(this._gmlNS,"pointMember");for(a=0;a<b.length;a++){var h=this._readPointMember(b[a],d,c);h&&e.points.push([h.x,h.y])}return 1<=e.points.length?e:null},_readLinearRing:function(a,d,c){var b,e;b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);e=a.getElementsByTagNameNS(this._gmlNS,"coordinates");
for(b=0;b<e.length;)return this._readCoordinates(e[b],d,c);e=a.getElementsByTagNameNS(this._gmlNS,"posList");for(b=0;b<e.length;)return this._readCoordinates(e[b],d,c);e=a.getElementsByTagNameNS(this._gmlNS,"pos");for(b=0;b<e.length;)return this._readPos(e[b],d,c)},_readCoordinatesBody:function(a,d,c){var b,e=new F(a);d=d.trim();var h,f,g=[];g.spatialReference={wkid:this._map.spatialReference.wkid};a=this._isReverse(a,this.version);if(d)if(2===c){if((d=d.match(/[0123456789.\-\+eE]+/g))&&2<=d.length)for(c=
0;c<d.length;c+=2)h=parseFloat(d[c]),f=parseFloat(d[c+1]),a&&(b=f,f=h,h=b),b={},this._projectFromSRToSR(e,this._map.spatialReference,h,f,b)&&(h=b.x,f=b.y),g.push([h,f])}else if(3===c&&(d=d.match(/[0123456789.\-\+eE]+/g))&&3<=d.length)for(c=0;c<d.length;c+=3)h=parseFloat(d[c]),f=parseFloat(d[c+1]),a&&(b=f,f=h,h=b),b={},this._projectFromSRToSR(e,this._map.spatialReference,h,f,b)&&(h=b.x,f=b.y),g.push([h,f]);return g},_readCoord:function(a,d,c){var b,e,h,f,g=this._readWkidFromNode(a);-1!=g&&(d=g);g=
new F(d);h=this._readSrsDimension(a);0!==h&&(c=h);var p=this._isReverse(d,this.version),r=[];r.spatialReference={wkid:this._map.spatialReference.wkid};h=0;e=a.getElementsByTagNameNS(this._gmlNS,"X");for(b=0;b<e.length;){h=this._readFloat(e[b],d,c);break}f=0;e=a.getElementsByTagNameNS(this._gmlNS,"Y");for(b=0;b<e.length;){f=this._readFloat(e[b],d,c);break}p&&(a=f,f=h,h=a);a={};this._projectFromSRToSR(g,this._map.spatialReference,h,f,a)&&(h=a.x,f=a.y);r.push(p?[f,h]:[h,f]);return r},_readCoordinates:function(a,
d,c){var b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);return this._readCoordinatesBody(d,a.textContent,c)},_readPos:function(a,d,c){var b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);return this._readCoordinatesBody(d,a.textContent,c)},_readPosList:function(a,d,c){var b=this._readWkidFromNode(a);-1!=b&&(d=b);b=this._readSrsDimension(a);0!==b&&(c=b);return this._readCoordinatesBody(d,a.textContent,c)},_projectFromSRToSR:function(a,
d,c,e,f){if(H.canProject(a,d))return a=new h(c,e,a),d=H.project(a,d),f.x=d.x,f.y=d.y,!0;f.x=c;f.y=e;return this._isProjectedOk=!1},_readFloat:function(a){return(a=a.textContent)?parseFloat(a):0},_readSrsDimension:function(a){return a.attributes&&(a=a.attributes.getNamedItem("srsDimension"))?parseInt(a.value,10):0},_readWkidFromNode:function(a){return a.attributes&&(a=a.attributes.getNamedItem("srsName"))&&(a=a.value.match(/\d+/g))&&0<a.length?(a=parseInt(a[a.length-1],10),84===a&&(a=4326),parseInt(a,
10)):-1},_isReverse:function(a,d){return this._inverseResponse},_appendCustomParameters:function(a){if(this.customParameters)for(var b in this.customParameters)a+=(-1===a.indexOf("?")?"?":"\x26")+b+"\x3d"+encodeURIComponent(this.customParameters[b]);return a}});t("extend-esri")&&n.setObject("layers.WFSLayer",m,q);return m})},"esri/layers/WMTSLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff dojox/xml/parser ../kernel ../lang ../request ../urlUtils ../WKIDUnitConversion ../SpatialReference ../geometry/Point ../geometry/Extent ../geometry/webMercatorUtils ./TiledMapServiceLayer ./TileInfo ./WMTSLayerInfo dojo/query".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F,H){c=c([z],{declaredClass:"esri.layers.WMTSLayer",copyright:null,extent:null,tileUrl:null,spatialReference:null,tileInfo:null,constructor:function(a,c){this.version="1.0.0";this.tileUr=this._url=a;this.serviceMode="RESTful";this._parseCapabilities=n.hitch(this,this._parseCapabilities);this._getCapabilitiesError=n.hitch(this,this._getCapabilitiesError);this._formatDictionary={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png",
"image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""};c||(c={});if(c.serviceMode)if("KVP"===c.serviceMode||"RESTful"===c.serviceMode)this.serviceMode=c.serviceMode;else{console.error("WMTS mode could only be 'KVP' or 'RESTful'");return}this.customParameters=c.customParameters;this.customLayerParameters=c.customLayerParameters;this.layerInfo=new H;c.layerInfo&&(this.layerInfo=c.layerInfo,this._identifier=
c.layerInfo.identifier,this._tileMatrixSetId=c.layerInfo.tileMatrixSet,c.layerInfo.format&&(this.format="image/"+c.layerInfo.format),this._style=c.layerInfo.style,this.title=c.layerInfo.title,this._dimension=c.layerInfo.dimension,this._dimension2=c.layerInfo.dimension2);c.resourceInfo?(this.version=c.resourceInfo.version,c.resourceInfo.getTileUrl&&(this._url=this.tileUrl=c.resourceInfo.getTileUrl),this.copyright=c.resourceInfo.copyright,this.layerInfos=c.resourceInfo.layerInfos,this.customParameters=
c.resourceInfo.customParameters||this.customParameters,this.customLayerParameters=c.resourceInfo.customLayerParameters||this.customLayerParameters,this._parseResourceInfo(),this.loaded=!0,this.onLoad(this)):this._getCapabilities()},setActiveLayer:function(a){this.setVisibleLayer(a)},setVisibleLayer:function(a){this._setActiveLayer(a);this.refresh(!0)},setCustomParameters:function(a,c){this.customParameters=a;this.customLayerParameters=c;this.refresh(!0)},getTileUrl:function(a,c,f){a=this._levelToLevelValue[a];
a=this.resourceUrls&&0<this.resourceUrls.length?this.resourceUrls[c%this.resourceUrls.length].template.replace(/\{Style\}/gi,this._style).replace(/\{TileMatrixSet\}/gi,this._tileMatrixSetId).replace(/\{TileMatrix\}/gi,a).replace(/\{TileRow\}/gi,c).replace(/\{TileCol\}/gi,f).replace(/\{dimensionValue\}/gi,this._dimension).replace(/\{dimensionValue2\}/gi,this._dimension2):this.UrlTemplate.replace(/\{level\}/gi,a).replace(/\{row\}/gi,c).replace(/\{col\}/gi,f);a=this._appendCustomLayerParameters(a);a=
this.addTimestampToURL(a);return v.addProxy(a)},getTileUrlTemplate:function(a){var c=a.identifier,e=a.tileMatrixSet,f=a.format,m=a.style,n=a.dimension,r=a.dimension2;c?a=g.filter(this.layers,function(a){return a.identifier===c})[0]:(a=this.layers[0],c=this.layers[0].identifier);if(a){if(!f)f=a.formats[0];else if(!(-1===f.indexOf("image/")&&-1<g.indexOf(a.formats,f))&&(-1===f.indexOf("image/")&&(f="image/"+f),-1===g.indexOf(a.formats,f))){console.error("The layer doesn't support the format of "+f);
this.onError(Error("The layer doesn't support the format of "+f));return}if(!m)m=a.styles[0];else if(-1===g.indexOf(a.styles,m)){console.error("The layer doesn't support the style of "+m);this.onError(Error("The layer doesn't support the style of "+m));return}if(!n&&a.dimensions)n=a.dimensions[0];else if(-1===g.indexOf(a.dimensions,n)){console.error("The layer doesn't support the dimension of "+n);this.onError(Error("The layer doesn't support the dimension of "+n));return}if(!r&&a.dimensions2)r=a.dimensions2[0];
else if(-1===g.indexOf(a.dimensions2,r)){console.error("The layer doesn't support the dimension of "+r);this.onError(Error("The layer doesn't support the dimension of "+r));return}var b;if(e){if(b=g.filter(a.tileMatrixSetInfos,function(a){return a.tileMatrixSet===e})[0],!b){console.error("The tileMatrixSetId "+e+" is not supported by the layer of "+c);this.onError(Error("The tileMatrixSetId "+e+" is not supported by the layer of "+c));return}}else(b=g.filter(a.tileMatrixSetInfos,function(a){return"GoogleMapsCompatible"===
a.tileMatrixSet})[0])||(b=a.tileMatrixSetInfos[0]),e=b.tileMatrixSet;return this._getTileUrlTemplate(c,e,f,m,n,r)}console.error("couldn't find the layer "+c);this.onError(Error("couldn't find the layer "+c))},_getTileUrlTemplate:function(a,c,f,g,m,n){var e;a||(a=this._identifier);c||(c=this._tileMatrixSetId);f||(f=this.format);g||""===g||(g=this._style);if(this.resourceUrls&&0<this.resourceUrls.length)return e=this.resourceUrls[0].template,e.indexOf(".xxx")===e.length-4&&(e=e.slice(0,e.length-4)),
e=e.replace(/\{Style\}/gi,g),e=e.replace(/\{TileMatrixSet\}/gi,c),e=e.replace(/\{TileMatrix\}/gi,"{level}"),e=e.replace(/\{TileRow\}/gi,"{row}"),e=e.replace(/\{TileCol\}/gi,"{col}"),e=e.replace(/\{dimensionValue\}/gi,m),e=e.replace(/\{dimensionValue2\}/gi,n);"KVP"===this.serviceMode?e=this._url+"SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+a+"\x26STYLE\x3d"+g+"\x26FORMAT\x3d"+f+"\x26TILEMATRIXSET\x3d"+c+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":
"RESTful"===this.serviceMode&&(m="",this._formatDictionary[f.toLowerCase()]&&(m=this._formatDictionary[f.toLowerCase()]),e=this._url+a+"/"+g+"/"+c+"/{level}/{row}/{col}"+m);return e},_parseResourceInfo:function(){var a=this.layerInfos,c,f;"KVP"===this.serviceMode&&(this._url+=-1<this._url.indexOf("?")?"":"?");for(f=0;f<a.length;f++)if(!(this._identifier&&a[f].identifier!==this._identifier||this.title&&a[f].title!==this.title||this._tileMatrixSetId&&a[f].tileMatrixSet!==this._tileMatrixSetId||this.format&&
"image/"+a[f].format!==this.format||this._style&&a[f].style!==this._style)){n.mixin(this,{description:a[f].description,tileInfo:a[f].tileInfo,spatialReference:a[f].tileInfo.spatialReference,fullExtent:a[f].fullExtent,initialExtent:a[f].initialExtent,_identifier:a[f].identifier,_tileMatrixSetId:a[f].tileMatrixSet,format:"image/"+a[f].format,_style:a[f].style});break}for(f=0;f<a.length;f++)c=a[f].tileInfo,96!==c.dpi&&(g.forEach(c.lods,function(a){a.scale=96*a.scale/c.dpi}),c.dpi=96),g.forEach(c.lods,
function(e){e.resolution=this._getResolution(c.spatialReference.wkid,90.71428571428571*e.scale/96,a[f].tileMatrixSet)},this);this._setActiveLayer();this.UrlTemplate=this._getTileUrlTemplate();this._levelToLevelValue=[];g.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue?a.levelValue:a.level},this)},_getCapabilities:function(){var a;"KVP"===this.serviceMode?a=-1<this._url.indexOf("?")?this._url+"\x26request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:
this._url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:"RESTful"===this.serviceMode&&(a=this._url+"/"+this.version+"/WMTSCapabilities.xml");a=this._appendCustomParameters(a);q({url:a,handleAs:"text",load:this._parseCapabilities,error:this._getCapabilitiesError})},_parseCapabilities:function(a){a=a.replace(/ows:/gi,"");a=t.parse(a);var c=m.query("Contents",a)[0];if(c){var e=m.query("OperationsMetadata",a)[0],f=m.query("[name\x3d'GetTile']",e)[0],e=this._url,f=m.query("Get",
f),y,n=!1,r,b;for(y=0;y<f.length;y++){var d=m.query("Constraint",f[y])[0];if(!d||this._getTagWithChildTagValue("AllowedValues","Value",this.serviceMode,d)){e=f[y].attributes[0].nodeValue;n=!0;break}else if(!d||this._getTagWithChildTagValue("AllowedValues","Value","RESTful",d))r=f[y].attributes[0].nodeValue;else if(!d||this._getTagWithChildTagValue("AllowedValues","Value","KVP",d))b=f[y].attributes[0].nodeValue}n||("KVP"===this.serviceMode&&r?(e=r,this.serviceMode="RESTful"):"RESTful"===this.serviceMode&&
b&&(e=b,this.serviceMode="KVP"));-1===e.indexOf("/1.0.0/")&&"RESTful"===this.serviceMode&&(e+="/");"KVP"===this.serviceMode&&(e+=-1<e.indexOf("?")?"":"?");this._url=e;this.copyright=this._getTagValues("Capabilities\x3eServiceIdentification\x3eAccessConstraints",a)[0];r=m.query("Layer",c);var p,l=[];this.layers=[];g.forEach(r,function(a){p=this._getTagValues("Identifier",a)[0];l.push(p);this.layers.push(this._getWMTSLayerInfo(p,a,c))},this);this._setActiveLayer();this.loaded=!0;this.onLoad(this)}else console.error("The WMTS capabilities XML is not valid"),
this.onError(Error("The WMTS capabilities XML is not valid"))},_setActiveLayer:function(a){a||(a={});a.identifier&&(this._identifier=a.identifier);a.tileMatrixSet&&(this._tileMatrixSetId=a.tileMatrixSet);a.format&&(this.format=a.format);a.style&&(this._style=a.style);a.dimension&&(this._dimension=a.dimension);a.dimension2&&(this._dimension2=a.dimension2);if(this.layers)if(this._identifier?a=g.filter(this.layers,function(a){return a.identifier===this._identifier},this)[0]:(a=this.layers[0],this._identifier=
this.layers[0].identifier),a){if(this.format){if(-1===this.format.indexOf("image/")&&(this.format="image/"+this.format),-1===g.indexOf(a.formats,this.format)){console.error("The layer doesn't support the format of "+this.format);this.onError(Error("The layer doesn't support the format of "+this.format));return}}else this.format=a.formats[0],-1===this.format.indexOf("image/")&&(this.format="image/"+this.format);if(!this._style)this._style=a.styles[0];else if(-1===g.indexOf(a.styles,this._style)){console.error("The layer doesn't support the style of "+
this._style);this.onError(Error("The layer doesn't support the style of "+this._style));return}if(!this._dimension&&a.dimensions)this._dimension=a.dimensions[0];else if(-1===g.indexOf(a.dimensions,this._dimension)){console.error("The layer doesn't support the dimension of "+this._dimension);this.onError(Error("The layer doesn't support the dimension of "+this._dimension));return}if(!this._dimension2&&a.dimensions2)this._dimension2=a.dimensions2[0];else if(-1===g.indexOf(a.dimensions2,this._dimension2)){console.error("The layer doesn't support the dimension of "+
this._dimension2);this.onError(Error("The layer doesn't support the dimension of "+this._dimension2));return}var c;if(this._tileMatrixSetId){if(c=g.filter(a.tileMatrixSetInfos,function(a){return a.tileMatrixSet===this._tileMatrixSetId},this)[0],!c){console.error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier);this.onError(Error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier));return}}else(c=g.filter(a.tileMatrixSetInfos,
function(a){return"GoogleMapsCompatible"===a.tileMatrixSet})[0])||(c=a.tileMatrixSetInfos[0]),this._tileMatrixSetId=c.tileMatrixSet;this.description=a.description;this.title=a.title;this.spatialReference=c.tileInfo.spatialReference;this.tileInfo=c.tileInfo;this._levelToLevelValue=[];g.forEach(this.tileInfo.lods,function(a){this._levelToLevelValue[a.level]=a.levelValue?a.levelValue:a.level},this);102100===this.spatialReference.wkid||102113===this.spatialReference.wkid?this.fullExtent=this.initialExtent=
E.geographicToWebMercator(a.gcsExtent):4326===this.spatialReference.wkid?this.fullExtent=this.initialExtent=a.gcsExtent:(this.fullExtent=c.fullExtent,this.initialExtent=c.initialExtent);this.resourceUrls=a.resourceUrls;this.UrlTemplate=this._getTileUrlTemplate();this.layerInfo={identifier:this._identifier,tileMatrixSet:this._tileMatrixSetId,format:this.format,style:this._style,fullExtent:this.fullExtent,initialExtent:this.initialExtent,tileInfo:this.tileInfo,title:this.title,description:this.description}}else console.error("couldn't find the layer "+
this._identifier),this.onError(Error("couldn't find the layer "+this._identifier))},_getWMTSLayerInfo:function(a,c,f){var e=this._getTagValues("Abstract",c)[0],h=this._getTagValues("Title",c)[0],n=m.query("WGS84BoundingBox",c)[0],r=n?this._getTagValues("LowerCorner",n)[0].split(" "):["-180","-90"],b=n?this._getTagValues("UpperCorner",n)[0].split(" "):["180","90"],n=parseFloat(r[0]),r=parseFloat(r[1]),d=parseFloat(b[0]),b=parseFloat(b[1]),n=new w(n,r,d,b,new B({wkid:4326})),b=this._getTagValues("Identifier",
m.query("Style",c)[0]),p=this._getTagValues("Identifier",m.query("Dimension",c)[0]),l=this._getTagValues("Default",m.query("Dimension",c)[0])||this._getTagValues("Value",m.query("Dimension",c)[0]),k=1<m.query("Dimension",c).length?this._getTagValues("Identifier",m.query("Dimension",c)[1]):[],q=1<m.query("Dimension",c).length?this._getTagValues("Default",m.query("Dimension",c)[1])||this._getTagValues("Value",m.query("Dimension",c)[1]):[],r=this._getTagValues("Format",c);f=this._getLayerMatrixInfos(c,
f);a={identifier:a,tileMatrixSetInfos:f,formats:r,styles:b,title:h,description:e,gcsExtent:n,dimensions:l,dimensions2:q};c=m.query("ResourceURL",c);var A=[],t;g.forEach(c,function(a){t=a.getAttribute("template");if(p&&l&&p[0]&&l[0])if(-1<t.indexOf("{"+p+"}"))t=t.replace("{"+p+"}","{dimensionValue}");else{var b=t.toLowerCase().indexOf("{"+p[0].toLowerCase()+"}");-1<b&&(t=t.substring(0,b)+"{dimensionValue}"+t.substring(b+p[0].length+2))}k&&q&&k[0]&&q[0]&&(-1<t.indexOf("{"+k+"}")?t=t.replace("{"+k+"}",
"{dimensionValue2}"):(b=t.toLowerCase().indexOf("{"+k[0].toLowerCase()+"}"),-1<b&&(t=t.substring(0,b)+"{dimensionValue2}"+t.substring(b+k[0].length+2))));A.push({template:t,format:a.getAttribute("format"),resourceType:a.getAttribute("resourceType")})});A&&0<A.length&&(a.resourceUrls=A);return a},_getLayerMatrixInfos:function(a,c){var e,f=[];this._allMatrixInfos||(this._allMatrixInfos=[]);var h=this._getTagValues("TileMatrixSet",a);if(h&&0!==h.length)return g.forEach(h,function(h){var g;if(0<this._allMatrixInfos.length)for(e=
0;e<this._allMatrixInfos.length;e++)if(this._allMatrixInfos[e].tileMatrixSet==h){g=this._allMatrixInfos[e];break}g||(g=this._getLayerMatrixInfo(h,a,c),this._allMatrixInfos.push(g));f.push(g)},this),f},_getLayerMatrixInfo:function(a,c,f){var e,h,g,n,b=[];c=this._getTagWithChildTagValue("TileMatrixSetLink","TileMatrixSet",a,c);var d=this._getTagValues("TileMatrix",c),p=this._getTagWithChildTagValue("TileMatrixSet","Identifier",a,f),l=this._getTagValues("SupportedCRS",p)[0];e=parseInt(l.split(":").pop(),
10);if(900913==e||3857==e)e=102100;if(-1<l.toLowerCase().indexOf("crs84")||-1<l.toLowerCase().indexOf("crs:84"))e=4326,n=!0;else if(-1<l.toLowerCase().indexOf("crs83")||-1<l.toLowerCase().indexOf("crs:83"))e=4269,n=!0;else if(-1<l.toLowerCase().indexOf("crs27")||-1<l.toLowerCase().indexOf("crs:27"))e=4267,n=!0;var k=new B({wkid:e}),q=m.query("TileMatrix",p)[0];f=parseInt(this._getTagValues("TileWidth",q)[0],10);c=parseInt(this._getTagValues("TileHeight",q)[0],10);h=this._getTagValues("TopLeftCorner",
q)[0].split(" ");var t=h[0],A=h[1];1<t.split("E").length&&(h=t.split("E"),t=h[0]*Math.pow(10,h[1]));1<A.split("E").length&&(h=A.split("E"),A=h[0]*Math.pow(10,h[1]));var t=parseFloat(t),A=parseFloat(A),u=n&&4326===e&&90===t&&-180===A;for(h=0;h<this._flippingAxisForWkids.length;h++)if(l.split(":").pop()>=this._flippingAxisForWkids[h][0]&&l.split(":").pop()<=this._flippingAxisForWkids[h][1]||4326===e&&(!n||u)){4326===e&&90<t&&(t="90");g=new G(A,t,k);break}h===this._flippingAxisForWkids.length&&(g=new G(t,
A,k));if(0===d.length)for(d=m.query("TileMatrix",p),h=0;h<d.length;h++)n=this._getLodFromTileMatrix(d[h],e,h,a),b.push(n);else for(h=0;h<d.length;h++)n=this._getTagWithChildTagValue("TileMatrix","Identifier",d[h],p),n=this._getLodFromTileMatrix(n,e,h,a),b.push(n);e=m.query("BoundingBox",p)[0];var v,z;e&&(v=this._getTagValues("LowerCorner",e)[0].split(" "),z=this._getTagValues("UpperCorner",e)[0].split(" "));v&&1<v.length&&z&&1<z.length?(q=parseFloat(v[0]),e=parseFloat(v[1]),v=parseFloat(z[0]),z=parseFloat(z[1])):
(v=this._getTagValues("MatrixWidth",q)[0],e=this._getTagValues("MatrixHeight",q)[0],q=g.x,z=g.y,v=q+v*c*b[0].resolution,e=z-e*f*b[0].resolution);z=v=new w(q,e,v,z,k);g=new F({dpi:96,spatialReference:k,format:this.format,rows:f,cols:c,origin:g,lods:b});return{tileMatrixSet:a,fullExtent:z,initialExtent:v,tileInfo:g}},_getCapabilitiesError:function(a){console.error("Failed to get capabilities xml");this.onError(a)},_getLodFromTileMatrix:function(a,c,f,g){var e=this._getTagValues("Identifier",a)[0];a=
this._getTagValues("ScaleDenominator",a)[0];1<a.split("E").length?(a=a.split("E"),a=a[0]*Math.pow(10,a[1])):a=parseFloat(a);c=this._getResolution(c,a,g);return{level:f,levelValue:e,scale:1.058267716535433*a,resolution:c}},_getResolution:function(a,c,f){a=u.isDefined(D[a])?D.values[D[a]]:"default028mm"===f?6370997*Math.PI/180:6378137*Math.PI/180;return 7*c/25E3/a},_getTag:function(a,c){return(a=m.query(a,c))&&0<a.length?a[0]:null},_getTagValues:function(a,c){var e=[];a=a.split("\x3e");var h;h=m.query(a[0],
c)[0];if(1<a.length){for(c=1;c<a.length-1;c++)h=m.query(a[c],h)[0];c=m.query(a[a.length-1],h)}else c=m.query(a[0],c);c&&0<c.length&&g.forEach(c,function(a){9>f("ie")?e.push(a.childNodes.length?a.childNodes[0].nodeValue:""):e.push(a.textContent)});return e},_getAttributeValues:function(a,c,f){a=m.query(a,f);var e=[];a&&0<a.length&&g.forEach(a,function(a){e.push(a.getAttribute(c))});return e},_getTagWithChildTagValue:function(a,c,g,n){n=n.childNodes;var e,h;for(h=0;h<n.length;h++)if(-1<n[h].nodeName.indexOf(a)&&
(9>f("ie")?u.isDefined(m.query(c,n[h])[0])&&(e=m.query(c,n[h])[0].childNodes[0].nodeValue):u.isDefined(m.query(c,n[h])[0])&&(e=m.query(c,n[h])[0].textContent),e===g||g.split(":")&&e===g.split(":")[1]))return n[h]},_appendCustomParameters:function(a){var c;if(this.customParameters)for(c in this.customParameters)a+=(-1===a.indexOf("?")?"?":"\x26")+c+"\x3d"+encodeURIComponent(this.customParameters[c]);return a},_appendCustomLayerParameters:function(a){var c,e;if(this.customLayerParameters||this.customParameters)for(c in e=
n.clone(this.customParameters||{}),n.mixin(e,this.customLayerParameters||{}),e)a+=(-1===a.indexOf("?")?"?":"\x26")+c+"\x3d"+encodeURIComponent(e[c]);return a},_flippingAxisForWkids:[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],
[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],
[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,
22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]]});f("extend-esri")&&n.setObject("layers.WMTSLayer",c,a);return c})},"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(m){m.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(c,n){var g=m.doc,f;n=n||"text/xml";if(c&&m.trim(c)&&
"DOMParser"in m.global){f=(new DOMParser).parseFromString(c,n);c=f.documentElement;if("parsererror"==c.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==c.namespaceURI){if(g=c.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext")[0])g=g.firstChild.data;throw Error("Error parsing text "+c.firstChild.data+" \n"+g);}return f}if("ActiveXObject"in m.global){g=function(a){return"MSXML"+a+".DOMDocument"};g=["Microsoft.XMLDOM",g(6),g(4),g(3),g(2)];m.some(g,
function(a){try{f=new ActiveXObject(a)}catch(u){return!1}return!0});if(c&&f&&(f.async=!1,f.loadXML(c),c=f.parseError,0!==c.errorCode))throw Error("Line: "+c.line+"\nCol: "+c.linepos+"\nReason: "+c.reason+"\nError Code: "+c.errorCode+"\nSource: "+c.srcText);if(f)return f}else if(g.implementation&&g.implementation.createDocument){if(c&&m.trim(c)&&g.createElement){n=g.createElement("xml");n.innerHTML=c;var t=g.implementation.createDocument("foo","",null);m.forEach(n.childNodes,function(a){t.importNode(a,
!0)});return t}return g.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(c,n){if(1<arguments.length)return dojox.xml.parser.replaceChildren(c,(c.ownerDocument||m.doc).createTextNode(n)),n;if(void 0!==c.textContent)return c.textContent;var g="";c&&m.forEach(c.childNodes,function(c){switch(c.nodeType){case 1:case 5:g+=dojox.xml.parser.textContent(c);break;case 3:case 2:case 4:g+=c.nodeValue}});return g};dojox.xml.parser.replaceChildren=function(c,n){var g=
[];m.isIE&&m.forEach(c.childNodes,function(c){g.push(c)});dojox.xml.parser.removeChildren(c);m.forEach(g,m.destroy);m.isArray(n)?m.forEach(n,function(f){c.appendChild(f)}):c.appendChild(n)};dojox.xml.parser.removeChildren=function(c){for(var m=c.childNodes.length;c.hasChildNodes();)c.removeChild(c.firstChild);return m};dojox.xml.parser.innerXML=function(c){return c.innerXML?c.innerXML:c.xml?c.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(c):null};return dojox.xml.parser})},
"esri/layers/WMTSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(m,c,n,g){m=m(null,{declaredClass:"esri.layers.WMTSLayerInfo",identifier:null,tileMatrixSet:null,format:null,style:null,tileInfo:null,title:null,fullExtent:null,initialExtent:null,description:null,dimension:null,constructor:function(c){c&&(this.title=c.title,this.tileMatrixSet=c.tileMatrixSet,this.format=c.format,this.style=c.style,this.tileInfo=c.tileInfo,this.fullExtent=c.fullExtent,
this.initialExtent=c.initialExtent,this.identifier=c.identifier,this.description=c.description,this.dimension=c.dimension)}});n("extend-esri")&&c.setObject("layers.WMTSLayerInfo",m,g);return m})},"widgets/AddData/search/AddFromFilePane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/on dojo/Deferred dojo/dom-class dijit/Viewport dojo/sniff dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromFilePane.html dojo/i18n!../nls/strings ./LayerLoader ./util dojo/_base/kernel esri/request esri/layers/FeatureLayer esri/layers/KMLLayer esri/geometry/scaleUtils jimu/dijit/Message jimu/dijit/CheckBox".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F,H,e,h,A,x){return m([v,D,B],{i18n:w,templateString:G,wabWidget:null,maxRecordCount:1E3,maxRecordThreshold:1E5,SHAPETYPE_ICONS:[{type:"shapefile",url:"images/filetypes/zip.svg"},{type:"csv",url:"images/filetypes/csv.svg"},{type:"kml",url:"images/filetypes/kml.svg"},{type:"gpx",url:"images/filetypes/gpx.svg"},{type:"geojson",url:"images/filetypes/geojson.svg"}],postCreate:function(){this.inherited(arguments);this.generalizeCheckBox.setLabel(w.addFromFile.generalizeOn);
this.own(u.on("resize",this.resize()))},destroy:function(){this.inherited(arguments)},startup:function(){if(!this._started){this.wabWidget.isPortal&&(this.SHAPETYPE_ICONS=[{type:"shapefile",url:"images/filetypes/zip.svg"},{type:"csv",url:"images/filetypes/csv.svg"},{type:"kml",url:"images/filetypes/kml.svg"}]);this.inherited(arguments);var e=this,h=this.dropArea,g,b=this.wabWidget.config;if(b.addFromFile)try{g=Number(b.addFromFile.maxRecordCount),"number"!==typeof g||isNaN(g)||(g=Math.floor(g),1<=
g&&g<=this.maxRecordThreshold&&(this.maxRecordCount=g))}catch(p){console.warn("Error setting AddFromFile.maxRecordCount:"),console.warn(p)}if(w.addFromFile.types)try{for(var d in w.addFromFile.types)this._createFileTypeImage(d)}catch(p){console.warn("Error reading support file types:"),console.warn(p)}this.own(f(this.fileNode,"change",function(){if(!e._getBusy()){e._setBusy(!0);var a=e._getFileInfo();a.ok&&e._execute(a)}}));this.own(f(this.uploadLabel,"click",function(a){e._getBusy()&&(a.preventDefault(),
a.stopPropagation())}));this.own(f(h,"dragenter",function(b){b.preventDefault();e._getBusy()||(a.add(h,"hit"),e._setStatus(""))}));this.own(f(h,"dragleave",function(b){b.preventDefault();a.remove(h,"hit")}));this.own(f(h,"dragover",function(a){a.preventDefault()}));this.own(f(h,"drop",function(a){a.preventDefault();a.stopPropagation();e._getBusy()||(e._setBusy(!0),a=e._getFileInfo(a),a.ok&&e._execute(a))}));g=this.wabWidget.domNode;this.own(f(g,"dragenter",function(a){a.preventDefault()}));this.own(f(g,
"dragleave",function(a){a.preventDefault()}));this.own(f(g,"dragover",function(a){a.preventDefault()}));this.own(f(g,"drop",function(a){a.preventDefault()}));this.own(f(this.hintButton,"click",c.hitch(this,function(a){a.preventDefault();a='\x3cdiv class\x3d"intro"\x3e\x3clabel\x3e'+w.addFromFile.intro+"\x3c/label\x3e\x3cul\x3e\x3cli\x3e"+w.addFromFile.types.Shapefile+"\x3c/li\x3e\x3cli\x3e"+w.addFromFile.types.CSV+"\x3c/li\x3e\x3cli\x3e"+w.addFromFile.types.KML+"\x3c/li\x3e\x3cli\x3e"+w.addFromFile.types.GPX+
"\x3c/li\x3e\x3cli\x3e"+w.addFromFile.types.GeoJSON+'\x3c/li\x3e\x3cli\x3e\x3cspan class\x3d"note"\x3e'+w.addFromFile.maxFeaturesAllowedPattern.replace("{count}",this.maxRecordCount)+"\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e";this.wabWidget.isPortal&&(a='\x3cdiv class\x3d"intro"\x3e\x3clabel\x3e'+w.addFromFile.intro+"\x3c/label\x3e\x3cul\x3e\x3cli\x3e"+w.addFromFile.types.Shapefile+"\x3c/li\x3e\x3cli\x3e"+w.addFromFile.types.CSV+"\x3c/li\x3e\x3cli\x3e"+w.addFromFile.types.KML+'\x3c/li\x3e\x3cli\x3e\x3cspan class\x3d"note"\x3e'+
w.addFromFile.maxFeaturesAllowedPattern.replace("{count}",this.maxRecordCount)+"\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e");new x({message:a})})))}},_addFeatures:function(a,c){var f,b=[],d=a.map,h=0,g=new E;c.layers&&(h=c.layers.length);n.forEach(c.layers,function(c){c=new e(c,{id:g._generateLayerId(),outFields:["*"]});c.xtnAddData=!0;c.graphics&&(a.numFeatures+=c.graphics.length);0===h?c.name=a.baseFileName:"string"!==typeof c.name||0===c.name.length?c.name=a.baseFileName:0!==c.name.indexOf(a.baseFileName)&&
(c.name=w.addFromFile.layerNamePattern.replace("{filename}",a.baseFileName).replace("{name}",c.name));g._setFeatureLayerInfoTemplate(c,null,null);c.fullExtent&&(f=f?f.union(c.fullExtent):c.fullExtent);b.push(c)});0<b.length&&(d.addLayers(b),f&&d.setExtent(f.expand(1.25),!0))},_analyze:function(a,c){if("csv"!==a.fileType.toLowerCase())return c=new t,c.resolve(null),c;var e=null;this.wabWidget.batchGeocoderServers&&0<this.wabWidget.batchGeocoderServers.length&&(e=this.wabWidget.batchGeocoderServers[0]);
var b={enableGlobalGeocoding:!0,sourceLocale:F.locale};e&&(b.geocodeServiceUrl=e.url,e.isWorldGeocodeServer&&(b.sourceCountry="world",b.sourceCountryHint=""));e=a.sharingUrl+"/content/features/analyze";b={f:"json",filetype:a.fileType.toLowerCase(),analyzeParameters:window.JSON.stringify(b)};c=H({url:e,content:b,form:c,handleAs:"json"});c.then(function(b){b&&b.publishParameters&&(a.publishParameters=b.publishParameters)});return c},_createFileTypeImage:function(a){var e=window.isRTL;n.some(this.SHAPETYPE_ICONS,
c.hitch(this,function(c,b){if(a.toLowerCase()===c.type.toLowerCase()){var d=document.createElement("IMG");d.src=this.wabWidget.folderUrl+c.url;d.alt=a;0===b?d.className+=" "+(e?"last":"first")+"-type-icon":1===b?d.className+=" second-"+(e?"last":"first")+"-type-icon":b===this.SHAPETYPE_ICONS.length-2?d.className+=" second-"+(e?"first":"last")+"-type-icon":b===this.SHAPETYPE_ICONS.length-1&&(d.className+=" "+(e?"first":"last")+"-type-icon");this.supportedFileTypes.appendChild(d)}}))},_execute:function(a){var c=
{map:this.wabWidget.map,sharingUrl:this.wabWidget.getSharingUrl(),baseFileName:a.baseFileName,fileName:a.fileName,fileType:a.fileType,generalize:!!this.generalizeCheckBox.getValue(),publishParameters:{},numFeatures:0};this._setBusy(!0);this._setStatus(w.addFromFile.addingPattern.replace("{filename}",a.fileName));if("kml"===a.fileType.toLowerCase())return this._executeKml(a);var e=a.fileName,b=this,d=new FormData;d.append("file",a.file);b._analyze(c,d).then(function(){return b._generateFeatures(c,
d)}).then(function(a){b._addFeatures(c,a.featureCollection);b._setBusy(!1);b._setStatus(w.addFromFile.featureCountPattern.replace("{filename}",e).replace("{count}",c.numFeatures))}).otherwise(function(a){b._setBusy(!1);b._setStatus(w.addFromFile.addFailedPattern.replace("{filename}",e));console.warn("Error generating features.");console.warn(a);a&&"string"===typeof a.message&&0<a.message.length&&new x({titleLabel:w._widgetLabel,message:w.addFromFile.generalIssue+"\x3cbr\x3e\x3cbr\x3e"+a.message})})},
_executeKml:function(a){var e=this,f=new FileReader,b=this.wabWidget.map,d=function(b,c){e._setBusy(!1);e._setStatus(w.addFromFile.addFailedPattern.replace("{filename}",a.fileName));console.warn(b);console.error(c);c&&"string"===typeof c.message&&0<c.message.length&&new x({titleLabel:w._widgetLabel,message:w.addFromFile.generalIssue+"\x3cbr\x3e\x3cbr\x3e"+c.message})};f.onerror=function(a){d("FileReader::onerror",a)};f.onload=function(m){if(f.error)d("FileReader::error",f.error);else{var l=m.target.result,
k=new E;m=k._generateLayerId();var p=new h("",{id:m,name:a.fileName,linkInfo:{visibility:!1}});p.visible=!0;delete p.linkInfo;p._parseKml=function(){var f=this;this._fireUpdateStart();this._io=H({url:this.serviceUrl,content:{kmlString:encodeURIComponent(l),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:g.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(c){f._io=null;f._initLayer(c);k._waitForLayer(p).then(function(c){var d=0;c.name=a.fileName;c.xtnAddData=!0;
n.forEach(c.getLayers(),function(a){a&&a.graphics&&0<a.graphics.length&&(d+=a.graphics.length)});var f=b.spatialReference,h=c._outSR;f&&h&&(f.equals(h)||f.isWebMercator()&&4326===h.wkid||h.isWebMercator()&&4326===f.wkid)?b.addLayer(c):new x({titleLabel:w._widgetLabel,message:w.addFromFile.kmlProjectionMismatch});e._setBusy(!1);e._setStatus(w.addFromFile.featureCountPattern.replace("{filename}",a.fileName).replace("{count}",d))}).otherwise(function(a){d("kml-_waitForLayer.error",a)})},error:function(a){f._io=
null;a=c.mixin(Error(),a);a.message="Unable to load KML: "+(a.message||"");f._fireUpdateEnd(a);f._errorHandler(a);d("Unable to load KML",a)}},{usePost:!0})};p._parseKml()}};try{f.readAsText(a.file)}catch(p){d("FileReader::readAsText",p)}},_generateFeatures:function(a,e){var f=a.sharingUrl+"/content/features/generate";a.publishParameters=a.publishParameters||{};var b=c.mixin(a.publishParameters,{name:a.baseFileName,targetSR:a.map.spatialReference,maxRecordCount:this.maxRecordCount,enforceInputFileSizeLimit:!0,
enforceOutputJsonSizeLimit:!0});if(a.generalize){var d=A.getExtentForScale(a.map,4E4).getWidth()/a.map.width;b.generalize=!0;b.maxAllowableOffset=d;for(var d=d/10,h=0;1>d;)d*=10,h++;b.reducePrecision=!0;b.numberOfDigitsAfterDecimal=h}a={f:"json",filetype:a.fileType.toLowerCase(),publishParameters:window.JSON.stringify(b)};return H({url:f,content:a,form:e,handleAs:"json"})},_getBaseFileName:function(a){q("ie")&&(a=a.split("\\"),a=a[a.length-1]);a=a.split(".");return a=a[0].replace("c:\\fakepath\\",
"")},_getBusy:function(){return a.contains(this.uploadLabel,"disabled")},_getFileInfo:function(a){var c={ok:!1,file:null,fileName:null,fileType:null};if((a=a?a.dataTransfer.files:this.fileNode.files)&&1===a.length)if(c.file=a=a[0],c.fileName=a.name,z.endsWith(a.name,".zip"))c.ok=!0,c.fileType="Shapefile";else if(z.endsWith(a.name,".csv"))c.ok=!0,c.fileType="CSV";else if(z.endsWith(a.name,".kml"))c.ok=!0,c.fileType="KML";else if(z.endsWith(a.name,".gpx"))c.ok=!0,c.fileType="GPX";else if(z.endsWith(a.name,
".geojson")||z.endsWith(a.name,".geo.json"))c.ok=!0,c.fileType="GeoJSON";c.ok&&(c.ok=n.some(this.SHAPETYPE_ICONS,function(a){return a.type.toLowerCase()===c.fileType.toLowerCase()}));if(c.ok)c.baseFileName=this._getBaseFileName(c.fileName);else{a=w.addFromFile.invalidType;"string"===typeof c.fileName&&0<c.fileName.length&&(a=w.addFromFile.invalidTypePattern.replace("{filename}",c.fileName));this._setBusy(!1);this._setStatus(a);var e=document.createElement("div");e.appendChild(document.createTextNode(a));
new x({titleLabel:w._widgetLabel,message:e})}return c},resize:function(){},_setBusy:function(c){c?(a.add(this.uploadLabel,"disabled"),a.add(this.dropArea,["hit","disabled"])):(a.remove(this.uploadLabel,"disabled"),a.remove(this.dropArea,["hit","disabled"]))},_setStatus:function(a){this.wabWidget&&this.wabWidget._setStatus(a)}})})},"widgets/AddData/search/LayerListPane":function(){define("dojo/_base/declare dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/LayerListPane.html dojo/i18n!../nls/strings ./util".split(" "),
function(m,c,n,g,f,t,a,u,q,v,D){return m([t,a,u],{i18n:v,templateString:q,wabWidget:null,baseClass:"add-data-widget-layers",postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this._buildList(),this._initListeners(),this.inherited(arguments))},_addLayer:function(a,c){var g=this,m=this._getLayerTitle(c),n=f.create("div",{"class":"add-data-layerlist--listitem"},a);f.create("A",{"class":"remove-button",href:"#",innerHTML:"\x3cspan class\x3d'esri-icon-trash'\x3e\x3c/span\x3e",
title:v.layerList.removeLayer,onclick:function(a){a.preventDefault();try{g.wabWidget&&g.wabWidget.map&&(g.wabWidget.map.removeLayer(c),f.destroy(n))}catch(H){console.warn("Error removing layer."),console.warn(H)}}},n);a=f.create("label",{"class":"layer-name"},n);D.setNodeText(a,m)},_buildList:function(){var a=this,g=!1,m=[],n=this.wabWidget.map,q=f.create("div",{"class":"add-data-layerlist--list"});c.forEach(n.layerIds,function(a){m.push(a)});c.forEach(n.graphicsLayerIds,function(a){m.push(a)});m.reverse();
c.forEach(m,function(c){(c=n.getLayer(c))&&c.xtnAddData&&(g=!0,a._addLayer(q,c))});return g?q:f.create("div",{"class":"no-data-message",innerHTML:v.layerList.noLayersAdded})},_getLayerTitle:function(a){var c="...";if("string"===typeof a.label&&0<a.label.length)c=a.label;else if("string"===typeof a.title&&0<a.title.length)c=a.title;else if("string"===typeof a.name&&0<a.name.length)c=a.name;else if(a.url){var f=a.url.indexOf("/FeatureServer");-1===f&&(f=a.url.indexOf("/MapServer"));-1===f&&(f=a.url.indexOf("/ImageServer"));
-1===f&&(f=a.url.indexOf("/service"));-1<f&&(a=a.url.substring(0,f),c=a=a.substring(a.lastIndexOf("/")+1,a.length))}return c},_initListeners:function(){var a=this;this.own(n(this._backButton,"click",function(c){c.preventDefault();a.hide()}))},show:function(){var a=this._buildList();this._title.innerHTML=v.layerList.caption;this._layerlist.innerHTML="";a&&a.tagName&&this._layerlist.appendChild(a);this.wabWidget&&this.wabWidget.domNode&&g.add(this.wabWidget.domNode,"layerlist-show");g.add(this.domNode,
"show")},hide:function(){this.wabWidget&&this.wabWidget.domNode&&g.remove(this.wabWidget.domNode,"layerlist-show");g.remove(this.domNode,"show")}})})},"widgets/AddData/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/AddData/search/templates/SearchPane.html":'\x3cdiv class\x3d"search-pane"\x3e\r\n  \x3cdiv class\x3d"search-pane-header" data-dojo-attach-point\x3d"headerNode"\x3e\r\n    \x3cdiv class\x3d"search-bar main-search-bar"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ScopeOptions"\r\n        data-dojo-attach-point\x3d"scopeOptions"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\x3cspan class\x3d"search-box-placeholder" data-dojo-attach-point\x3d"searchBoxPlaceholder"\x3e\x3c/span\x3e--\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SearchBox"\r\n        data-dojo-attach-point\x3d"searchBox"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar-separator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar search-bar-secondary" data-dojo-attach-point\x3d"optionsNode"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/BBoxOption"\r\n        data-dojo-attach-point\x3d"bboxOption"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"filter-wrapper2"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n      \x3cspan class\x3d"filter-placeholder" data-dojo-attach-point\x3d"filterPlaceholder"\x3e\x3c/span\x3e\r\n      \x3cdiv class\x3d"filter-wrapper" data-dojo-attach-point\x3d"filterWrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultsPane"\r\n      data-dojo-attach-point\x3d"resultsPane"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-footer jimu-float-leading" data-dojo-attach-point\x3d"footerNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/Paging"\r\n      data-dojo-attach-point\x3d"paging"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultCount"\r\n      data-dojo-attach-point\x3d"resultCount"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SearchBox.html":'\x3cdiv class\x3d"search-box2"\x3e\r\n\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\tdata-dojo-attach-point\x3d"searchTextBox"\r\n\t\x3e\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\x3c/button\x3e\r\n\x3c!--\r\n\x3cdiv class\x3d"search-box"\x3e\r\n\t\x3cdiv class\x3d"input-group"\x3e\r\n\t\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\t\tdata-dojo-attach-point\x3d"searchTextBox"\x3e\r\n    \x3cspan class\x3d"search-btn"\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-clear hidden" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"clearButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: clearButtonClicked"\x3e\r\n\t\t\t\t\x3cspan class\x3d"esri-icon-close"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n--\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/BBoxOption.html":'\x3cdiv class\x3d"search-bbox-option"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"bboxSection" class\x3d"switch-toggle-group"\x3e\r\n    \x3clabel class\x3d"checkbox-inline"\x3e\r\n      \x3cinput id\x3d"${id}_bboxId"\r\n\t      data-dojo-type\x3d"dijit/form/CheckBox"\r\n\t      data-dojo-attach-point\x3d"bboxToggle"\r\n\t      data-dojo-attach-event\x3d"onClick: bboxClicked"\r\n\t      data-dojo-props\x3d"class: \'switch-toggle\'"\r\n        title\x3d"${i18n.search.bboxOption.bbox}"/\x3e\r\n      \x3cspan class\x3d"label-text"\x3e${i18n.search.bboxOption.bbox}\x3c/span\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/ScopeOptions.html":'\x3cdiv class\x3d"search-scope-options"\x3e\r\n  \x3ca href\x3d"#" class\x3d"scope-placeholder"\r\n    data-dojo-attach-point\x3d"scopePlaceholder"\r\n    data-dojo-attach-event\x3d"onClick: scopePlaceholderClicked"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"scopePlaceholderText"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"dropdown-arrow"\x3e\x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"btn-group" data-dojo-attach-point\x3d"btnGroup"\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyContentToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyContent"\x3e\r\n      ${i18n.search.scopeOptions.myContent}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyOrganizationToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyOrganization"\x3e\r\n      ${i18n.search.scopeOptions.myOrganization}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"CuratedToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"Curated"\x3e\r\n      ${i18n.search.scopeOptions.curated}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"ArcGISOnlineToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"ArcGISOnline"\x3e\r\n      ${i18n.search.scopeOptions.ArcGISOnline}\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/TypeOptions.html":'\x3cdiv class\x3d"search-data-type-options"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n    \x3cspan\x3e${i18n.search.typeOptions.prompt}\x3c/span\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\r\n         data-dojo-attach-point\x3d"tooltipDialog"\r\n         data-dojo-props\x3d"\'class\':\'add-data-widget-popup\'"\x3e\r\n      \x3clabel for\x3d"${id}_mapServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_mapServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"mapServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Map Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.mapService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_featureServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_featureServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"featureServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Feature Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.featureService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_imageServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_imageServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"imageServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Image Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.imageService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_vectorTileServiceId" class\x3d"search-type-option"\r\n        data-dojo-attach-point\x3d"vectorTileNode"\x3e\r\n        \x3cdiv id\x3d"${id}_vectorTileServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"vectorTileServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Vector Tile Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.vectorTileService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_kmlId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_kmlId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"kmlToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;KML\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.kml}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_wmsId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_wmsId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"wmsToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;WMS\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.wms}\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SortOptions.html":'\x3cdiv class\x3d"search-sort-options"\x3e\r\n  \x3clabel for\x3d"${id}_select" class\x3d"sort-prompt"\x3e${i18n.search.sortOptions.prompt}\x3c/label\x3e \r\n  \x3cselect id\x3d"${id}_select"\r\n    data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"sortSelect"\x3e\r\n    \x3coption value\x3d"" selected\x3d"selected"\x3e${i18n.search.sortOptions.relevance}\x3c/option\x3e\r\n    \x3coption value\x3d"title"\x3e${i18n.search.sortOptions.title}\x3c/option\x3e\r\n    \x3coption value\x3d"owner"\x3e${i18n.search.sortOptions.owner}\x3c/option\x3e\r\n    \x3coption value\x3d"avgrating"\x3e${i18n.search.sortOptions.rating}\x3c/option\x3e\r\n    \x3coption value\x3d"numviews"\x3e${i18n.search.sortOptions.views}\x3c/option\x3e\r\n    \x3coption value\x3d"modified"\x3e${i18n.search.sortOptions.date}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3ca href\x3d"#" class\x3d"sort-order-icon"\r\n    title\x3d"${i18n.search.sortOptions.switchOrder}"\r\n    data-dojo-attach-point\x3d"sortOrderBtn"\r\n    data-dojo-attach-event\x3d"onclick: sortOrderClicked"\x3e\r\n  \x3c/a\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/ResultsPane.html":'\x3cdiv class\x3d"search-results-pane" data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"search-results-pane-no-match empty-data-label" data-dojo-attach-point\x3d"noMatchNode" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"itemsNode" class\x3d"search-results"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/ItemCard.html":'\x3cdiv class\x3d"item-card"\x3e\r\n  \x3cdiv class\x3d"item-card-inner"\x3e\r\n    \x3cdiv class\x3d"thumbnail" data-dojo-attach-point\x3d"thumbnailNode"\x3e\x3c/div\x3e\r\n    \x3ch3 class\x3d"title" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/h3\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"typeByOwnerNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"dateNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-bar"\x3e\r\n      \x3cspan class\x3d"message" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"addButton"\r\n        data-dojo-attach-event\x3d"onClick: addClicked"\r\n        \x3e${i18n.search.item.actions.add}\r\n      \x3c/a\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"detailsButton"\r\n        data-dojo-attach-event\x3d"onClick: detailsClicked"\r\n        \x3e${i18n.search.item.actions.details}\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/Paging.html":'\x3cdiv class\x3d"search-paging"\x3e\r\n\t\x3cul class\x3d"pagination pagination-sm"\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"First"\r\n\t\t\t\tdata-dojo-attach-point\x3d"firstButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: firstButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.firstTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-expand"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Previous"\r\n\t\t\t\tdata-dojo-attach-point\x3d"previousButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: previousButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.previousTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-left"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli class\x3d"current-page"\x3e\r\n\t\t  \x3cspan data-dojo-attach-point\x3d"pageNode"\x3e\x3c/span\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Next"\r\n\t\t\t\tdata-dojo-attach-point\x3d"nextButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: nextButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.nextTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-right"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\x3c/ul\x3e\r\n\x3c/div\x3e',
"url:widgets/AddData/search/templates/ResultCount.html":'\x3cdiv class\x3d"search-result-count"\x3e\r\n  \x3cspan class\x3d"search-count" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/AddFromUrlPane.html":'\x3cdiv class\x3d"secondary-pane add-url-pane"\x3e\r\n  \x3cdiv class\x3d"add-url-pane-container"\x3e\r\n    \x3cdiv class\x3d"add-url-pane-container--inner"\x3e\r\n      \x3clabel for\x3d"${id}_select"\x3e${i18n.addFromUrl.type}\x3c/label\x3e\r\n      \x3cselect id\x3d"${id}_select"\r\n        data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"typeSelect"\x3e\r\n        \x3coption value\x3d"ArcGIS" selected\x3d"selected"\x3e${i18n.addFromUrl.types.ArcGIS}\x3c/option\x3e\r\n        \x3coption value\x3d"WMS"\x3e${i18n.addFromUrl.types.WMS}\x3c/option\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WMTS"\x3e${i18n.addFromUrl.types.WMTS}\x3c/option\x3e --\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WFS"\x3e${i18n.addFromUrl.types.WFS}\x3c/option\x3e --\x3e\r\n        \x3coption value\x3d"KML"\x3e${i18n.addFromUrl.types.KML}\x3c/option\x3e\r\n        \x3coption value\x3d"GeoRSS"\x3e${i18n.addFromUrl.types.GeoRSS}\x3c/option\x3e\r\n        \x3coption value\x3d"CSV"\x3e${i18n.addFromUrl.types.CSV}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n      \x3clabel for\x3d"${id}_url"\x3e${i18n.addFromUrl.url}\x3c/label\x3e\r\n      \x3cinput id\x3d"${id}_url" type\x3d"text" class\x3d"url-textbox jimu-input"\r\n          data-dojo-attach-point\x3d"urlTextBox"\x3e\r\n      \x3cdiv class\x3d"action-bar"\x3e\r\n        \x3ca class\x3d"jimu-float-leading" href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"examplesExpander"\r\n          data-dojo-attach-event\x3d"onClick: examplesExpanderClicked"\r\n          \x3e${i18n.addFromUrl.samplesHint}\x3c/a\x3e\r\n        \x3ca class\x3d"jimu-btn"\r\n          href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"addButton"\r\n          data-dojo-attach-event\x3d"onClick: addClicked"\r\n          \x3e${i18n.search.item.actions.add}\r\n        \x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"examples" data-dojo-attach-point\x3d"examplesNode"\x3e\r\n        \x3cdiv data-examples-type\x3d"ArcGIS"\x3e\r\n          \x3cdiv\x3ehttp://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Cities/FeatureServer/0\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://services.arcgisonline.com/ArcGIS/rest/services/Demographics/USA_Tapestry/MapServer\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://imagery.arcgisonline.com/ArcGIS/rest/services/LandsatGLS/VegetationAnalysis/ImageServer\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"WMS"\x3e\r\n          \x3cdiv\x3ehttp://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service\x3dWMS\x26amp;request\x3dGetCapabilities\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"KML"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_month_age_animated.kml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"GeoRSS"\x3e\r\n          \x3cdiv\x3ehttp://www.gdacs.org/xml/rss.xml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"CSV"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.csv\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/AddFromFilePane.html":'\x3cdiv class\x3d"secondary-pane add-file-pane"\x3e\r\n\r\n  \x3cdiv class\x3d"generalize-options"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n      data-dojo-attach-point\x3d"generalizeCheckBox"\r\n      data-dojo-props\x3d"checked:true"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"browse-or-drop"\x3e\r\n    \x3cdiv class\x3d"drop-container" data-dojo-attach-point\x3d"dropContainer"\x3e\r\n      \x3cdiv class\x3d"drop-area" data-dojo-attach-point\x3d"dropArea"\x3e\r\n        \x3cdiv class\x3d"supported-file-types" data-dojo-attach-point\x3d"supportedFileTypes"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"or"\x3e${i18n.addFromFile.dropOrBrowse}\x3c/div\x3e\r\n        \x3cform class\x3d"file-form" enctype\x3d"multipart/form-data" method\x3d"post"\r\n          data-dojo-attach-point\x3d"fileForm"\x3e\r\n          \x3clabel for\x3d"${id}_file" class\x3d"jimu-btn"\r\n            data-dojo-attach-point\x3d"uploadLabel"\x3e${i18n.addFromFile.browse}\x3c/label\x3e\r\n          \x3cinput id\x3d"${id}_file" name\x3d"file" type\x3d"file" style\x3d"display:none"\r\n            data-dojo-attach-point\x3d"fileNode" /\x3e\r\n        \x3c/form\x3e\r\n        \x3ca href\x3d"#" class\x3d"drop-area-hint" data-dojo-attach-point\x3d"hintButton"\x3e\r\n          \x3ci class\x3d"esri-icon-question"\x3e\x3c/i\x3e\r\n        \x3c/a\x3e\r\n        \x3cspan class\x3d"upload-arrow"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/LayerListPane.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--container" data-dojo-attach-point\x3d"_container"\x3e\r\n    \x3ch2 data-dojo-attach-point\x3d"_title"\x3e\x3c/h2\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_layerlist"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--footer jimu-widget-add-data-footer" data-dojo-attach-point\x3d"_footer"\x3e\r\n    \x3ca href\x3d"#" class\x3d"back-button" data-dojo-attach-point\x3d"_backButton"\x3e\r\n      ${i18n.layerList.back}\x3ci class\x3d"esri-icon-collapse"\x3e\x3c/i\x3e\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tabsNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fileNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/AddData/css/style.css":'.jimu-widget-add-data .jimu-tab3 {height: 100%;}.jimu-widget-add-data .search-pane,.jimu-widget-add-data .secondary-pane {height: 100%; width: 100%; background-color: #f8f8f8; position: relative;}.jimu-widget-add-data .search-pane \x3e *,.jimu-widget-add-data .secondary-pane \x3e * {width: 100%;}.jimu-widget-add-data .search-pane-content {position: absolute; top: 140px; bottom: 0; overflow: auto; background-color: #efefef;}.jimu-widget-add-data .search-pane .search-bar {padding: 10px 15px; line-height: 20px;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn {min-width: 40px; padding-top: 10px; padding-bottom: 13px; background-color: transparent; border: 0; border-bottom: 2px solid transparent; margin-left: 5px; margin-right: 5px; color: #898989; font-size: 12px; font-weight: bold; font-family: inherit;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {background-color: transparent !important; color: #000 !important; border-bottom-color: #24b5cc; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none;}.jimu-widget-add-data .search-pane .search-bar.main-search-bar {background-color: #fff; padding-bottom: 0; position: relative; display: flex;}.jimu-widget-add-data .search-pane .search-scope-options {flex: 1; overflow: hidden;}.jimu-widget-add-data .search-pane .search-bar.search-scope-bar .search-sort-options {margin-top: 5px;}.jimu-widget-add-data .search-pane .search-bar-secondary {background-color: #f8f8f8; padding-top: 5px; padding-bottom: 5px; font-size: 11px;}.jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .search-pane .search-pane-header:before,.jimu-widget-add-data .search-pane .search-pane-header:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-pane-header:after {clear: both;}.jimu-widget-add-data .search-pane .search-bar:before,.jimu-widget-add-data .search-pane .search-bar:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-bar:after {clear: both;}.jimu-widget-add-data .search-pane .search-data-type-options {margin-right: 15px;}.jimu-widget-add-data .search-pane .search-curated-option {display: inline-block; margin-left: 30px;}.jimu-widget-add-data .search-pane .search-bar-separator {border-bottom: 1px solid #e7e7e7;}.jimu-widget-add-data .search-pane .search-pane-default .search-bar {text-align: right; margin-bottom: 24px;}.jimu-widget-add-data .search-pane .search-results-pane {padding: 10px 5px;}.jimu-widget-add-data .search-pane .search-results-pane:after {content: ""; display: table; clear: both;}.jimu-widget-add-data .search-pane .item-card {float: left; width: 100%; padding-left: 5px; padding-right: 5px; -webkit-transition: width 0.1s ease; -moz-transition: width 0.1s ease; -o-transition: width 0.1s ease; transition: width 0.1s ease;}.jimu-widget-add-data .search-pane .item-card .item-card-inner {height: 70px; background: #ffffff; border: 1px solid #e0e0e0; border-bottom-color: #cccccc; padding: 5px; margin-bottom: 10px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;}.jimu-widget-add-data .search-pane .item-card .thumbnail {float: left; margin-right: 10px;}.jimu-widget-add-data .search-pane .item-card .thumbnail img {height: 60px; width: 90px;}.jimu-widget-add-data .search-pane .item-card h3.title {margin: 0 5px; padding: 0; font-size: 12px; font-weight: bold; color: #4c4c4c; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .search-pane .item-card div.info {color: #898989; font-size: 10px; overflow: hidden; white-space: nowrap; padding-top: 3px;}.jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-widget-add-data .secondary-pane .action-bar {text-align: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-rtl .jimu-widget-add-data .secondary-pane .action-bar {text-align: left;}.jimu-widget-add-data .secondary-pane {padding: 20px 15px; overflow: auto;}.jimu-widget-add-data .secondary-pane label {color: #898989; display: block; margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane .dijit {margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane div.action-bar {margin-top: 20px;}.jimu-widget-add-data .secondary-pane .jimu-btn {color: #fff; line-height: 20px; text-decoration: none;}.jimu-widget-add-data .secondary-pane .jimu-btn:active {}.jimu-widget-add-data .search-pane .item-card .action-bar a,.jimu-widget-add-data .add-url-pane .action-bar a,.jimu-widget-add-data .add-file-pane .file-form label {display: inline-block; font-size: 11px; text-transform: uppercase; padding: 5px; margin-right: 5px;}.jimu-widget-add-data .search-pane .item-card .action-bar a.disabled,.jimu-widget-add-data .add-url-pane .action-bar a.disabled,.jimu-widget-add-data .add-file-pane .file-form label.disabled,.jimu-widget-add-data .add-file-pane .drop-area.disabled {opacity: 0.3;}.jimu-widget-add-data .search-pane .item-card .action-bar .message {font-size: 10px; font-style: italic; margin-left: 4px; margin-right: 4px;}.jimu-widget-add-data .add-url-pane .action-bar .jimu-btn,.jimu-widget-add-data .add-file-pane .file-form label {margin-right: 0; min-width: 180px; white-space: normal;}.jimu-widget-add-data .add-url-pane {padding: 0;}.jimu-widget-add-data .add-url-pane-container {background-color: #fff; border-bottom: 1px solid #ccc; padding: 15px 15px 35px;}.jimu-widget-add-data .add-url-pane-container--inner {max-width: 960px; margin: 0 auto;}.jimu-widget-add-data .add-file-pane .intro ul {font-size: 10px; margin: 0; padding: 2px 0 2px 20px;}.jimu-widget-add-data .add-file-pane .intro ul .note {font-style: italic;}.jimu-rtl .jimu-widget-add-data .add-file-pane .intro ul {padding: 2px 20px 2px 0;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .checkbox {margin-top: 0; vertical-align: middle;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .label {font-size: 12px; vertical-align: middle; cursor: pointer;}.jimu-widget-add-data .add-file-pane .browse-or-drop {}.jimu-widget-add-data .add-file-pane .or {display: block; margin: 20px auto; font-size: 11px; color: #898989; width: 90%; max-width: 400px; line-height: 20px; position: relative;}.jimu-widget-add-data .add-file-pane .or:before,.jimu-widget-add-data .add-file-pane .or:after {content: ""; display: block; height: 1px; width: 35%; background: #eee; position: absolute; top: 9px; left: 0;}.jimu-widget-add-data .add-file-pane .or:after {right: 0; left: auto;}.jimu-widget-add-data .add-file-pane .or b {display: inline-block; padding-right: 5px;}.jimu-widget-add-data .add-file-pane .drop-area {width: 100%; background: #fff; margin: 10px auto 0; padding: 25px 50px 35px; border: 1px dashed #ccc; color: #898989; font-size: 12px; text-align: center; line-height: 1.75; text-transform: uppercase; position: relative; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area i {color: #485566; font-style: normal;}.jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {position: absolute; top: 0; right: 0; margin: 5px; padding: 10px; font-size: 14px; line-height: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit {background: #f9f9f9; border-color: #24b5cc;}.jimu-widget-add-data .add-file-pane .drop-area.hit \x3e * {pointer-events: none; display: none;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {display: block;}.jimu-widget-add-data .add-file-pane .drop-area.hit .upload-arrow {display: block; width: 48px; height: 48px; background: url(images/arrow_up.png) no-repeat; margin: 0 auto; -moz-animation: updload-arrow-animation 1s infinite; -webkit-animation: updload-arrow-animation 1s infinite; animation: updload-arrow-animation 1s infinite;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types {margin: 15px 0 35px; opacity: .5; pointer-events: none; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img {width: 45px; margin-left: -5px; position: relative; -webkit-transition: all ease-in-out 0.2s; -moz-transition: all ease-in-out 0.2s; -o-transition: all ease-in-out 0.2s; transition: all ease-in-out 0.2s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.first-type-icon {-moz-transform: rotate(-8deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-8deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-8deg); -o-transform-origin: right bottom; transform: rotate(-8deg); transform-origin: right bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-3deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-3deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-3deg); -o-transform-origin: right bottom; transform: rotate(-3deg); transform-origin: right bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-last-type-icon {-moz-transform: rotate(3deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(3deg); -webkit-transform-origin: left bottom; -o-transform: rotate(3deg); -o-transform-origin: left bottom; transform: rotate(3deg); transform-origin: left bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.last-type-icon {-moz-transform: rotate(8deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(8deg); -webkit-transform-origin: left bottom; -o-transform: rotate(8deg); -o-transform-origin: left bottom; transform: rotate(8deg); transform-origin: left bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {opacity: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img {margin-left: 0px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.first-type-icon {-moz-transform: rotate(-12deg); -webkit-transform: rotate(-12deg); -o-transform: rotate(-12deg); transform: rotate(-12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-5deg); -webkit-transform: rotate(-5deg); -o-transform: rotate(-5deg); transform: rotate(-5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-last-type-icon {-moz-transform: rotate(5deg); -webkit-transform: rotate(5deg); -o-transform: rotate(5deg); transform: rotate(5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.last-type-icon {-moz-transform: rotate(12deg); -webkit-transform: rotate(12deg); -o-transform: rotate(12deg); transform: rotate(12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .file-form {display: inline-block;}.jimu-widget-add-data .search-box2 {display: inline-block;}.jimu-widget-add-data .search-box2 {float: right;}.jimu-widget-add-data .search-box2 .search-textbox {vertical-align: middle; height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-box2 .btn {display: inline-block; height: 30px; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 150px;}.jimu-widget-add-data.width-small .add-file-pane .or:before,.jimu-widget-add-data.width-small .add-file-pane .or:after {width: 25%;}.jimu-widget-add-data.width-medium .search-box2 .search-textbox {width: 140px;}.jimu-widget-add-data.width-medium .filter-wrapper .sort-prompt,.jimu-widget-add-data.width-small .filter-wrapper .sort-prompt {display: none;}.jimu-widget-add-data.width-medium .search-pane .search-results-pane {padding: 5px 0;}.jimu-widget-add-data.width-medium .search-pane .item-card .item-card-inner {margin-bottom: 5px;}.jimu-widget-add-data.height-small .add-file-pane {padding-top: 15px; padding-bottom: 15px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-top: 15px; padding-bottom: 25px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area .supported-file-types {margin-bottom: 20px;}.jimu-widget-add-data .search-bbox-option .checkbox-inline,.jimu-widget-add-data .search-bbox-option .checkbox-inline input,.jimu-widget-add-data .search-pane .filter-placeholder {cursor: pointer;}.jimu-widget-add-data.width-small .search-bbox-option {max-width: 120px; font-size: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data.width-small .search-bbox-option .switch-toggle-group {overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: 38px; margin-right: 25px;}.jimu-widget-add-data .search-pane .search-box .input-group {position: relative; display: table; border-collapse: separate;}.jimu-widget-add-data .search-pane .search-box .input-group \x3e * {display: table-cell; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-box .search-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-pane .search-box .btn {display: inline-block; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data .search-pane .search-box .btn-clear {border-color: transparent; background: transparent; position: absolute; left: -32px;}.jimu-widget-add-data .search-pane .search-box-placeholder,.jimu-widget-add-data .search-pane .filter-placeholder,.jimu-widget-add-data .search-pane .scope-placeholder {display: none;}.jimu-widget-add-data .search-pane .search-sort-options \x3e * {vertical-align: middle;}.jimu-widget-add-data .search-pane .search-sort-options label {font-weight: normal; font-size: 11px; color: #898989;}.jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: right; width: 24px; height: 24px; margin: 3px 0;}.jimu-widget-add-data .search-pane .search-sort-options .dropdown-toggle .sort-order-icon {float: none; padding: 0 5px;}.jimu-widget-add-data .search-pane .sort-order-icon {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px; background-image: url("images/sort-down-arrow.png");}.jimu-widget-add-data .search-pane .sort-order-icon.descending {background-image: url("images/sort-up-arrow.png");}.jimu-widget-add-data .search-pane .scope-options \x3e * {display: inline-block;}.jimu-widget-add-data .search-pane .checkbox-inline,.jimu-widget-add-data .search-pane .radio-inline {position: relative; padding-left: 21px; margin-right: 10px;}.jimu-widget-add-data .search-pane .checkbox-inline .dijitCheckBox,.jimu-widget-add-data .search-pane .radio-inline .dijitCheckBox {}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views {display: block; padding: 5px;}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views [class*\x3d"gd-icon-"] {margin-right: 10px; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-paging .pagination {margin: 0;}.jimu-widget-add-data .search-pane .search-paging,.jimu-widget-add-data .search-pane .search-result-count {display: inline-block; vertical-align: middle; line-height: 1;}.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:focus,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:hover {color: inherit; border-color: transparent; background-color: transparent;}.jimu-widget-add-data .search-pane .pagination \x3e li.current-page \x3e span {padding-left: 15px; padding-right: 15px;}.jimu-widget-add-data .search-pane .pagination [class*\x3d" esri-icon-"],.jimu-widget-add-data .search-pane .pagination [class^\x3d"esri-icon-"] {position: relative; top: 1px;}.jimu-widget-add-data .search-pane .search-result-count {margin: 0 10px;}.jimu-widget-add-data.width-768 .item-card {width: 50%;}.jimu-widget-add-data.width-1200 .item-card {width: 33.3333333333%;}.jimu-widget-add-data.width-medium .search-pane .search-bar,.jimu-widget-add-data.width-small .search-pane .search-bar {padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: 0;}.jimu-rtl .jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-rtl .jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: auto; margin-right: 0;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder,.jimu-widget-add-data.filter-placeholder-on .filter-placeholder {display: block; height: 30px; width: 30px; background-image: url("images/search.png"); background-position: center center; background-repeat: no-repeat; background-size: 12px;}.jimu-widget-add-data.width-medium .search-box,.jimu-widget-add-data.width-small .search-box {display: none; padding: 10px; position: absolute; top: 0; left: 0; right: 40px; background: #ffffff;}.jimu-widget-add-data.width-small .search-box {padding-top: 8px; padding-bottom: 8px;}.jimu-widget-add-data.width-medium .search-box .input-group,.jimu-widget-add-data.width-small .search-box .input-group {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-textbox,.jimu-widget-add-data.width-small .search-box .search-textbox {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-btn,.jimu-widget-add-data.width-small .search-box .search-btn {width: 1%; position: relative;}.jimu-widget-add-data.width-medium .search-box.show,.jimu-widget-add-data.width-small .search-box.show {display: block;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder {margin: 0 0 8px;}.jimu-widget-add-data.width-medium .search-box-placeholder.opened,.jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close.png");}.jimu-widget-add-data.width-medium .filter-placeholder,.jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu.png");}.jimu-widget-add-data.width-medium .scope-placeholder,.jimu-widget-add-data.width-small .scope-placeholder {display: block; padding: 5px 10px 15px; color: #196fa6; font-weight: bold;}.jimu-widget-add-data.width-small .scope-placeholder {display: flex;}.jimu-widget-add-data.width-small .scope-placeholder \x3e span:first-child {white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: calc(100% - 16px); flex: 1;}.jimu-widget-add-data.width-medium .scope-placeholder:focus,.jimu-widget-add-data.width-small .scope-placeholder:focus {text-decoration: none;}.jimu-widget-add-data.width-medium .scope-placeholder \x3e *,.jimu-widget-add-data.width-small .scope-placeholder \x3e * {vertical-align: middle;}.jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow {display: inline-block; background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data.width-medium .btn-group,.jimu-widget-add-data.filter-placeholder-on .filter-wrapper,.jimu-widget-add-data.width-small .btn-group {display: none;}.jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-widget-add-data.width-small .btn-group.show {display: block; position: absolute; right: 0; top: 91px; z-index: 10; padding: 5px 10px; background: #ffffff; border: 1px solid #cccccc; -webkit-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); -moz-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2);}.jimu-rtl .jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: 0; right: auto;}.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .btn-group.show {top: 48px; left: 0; padding: 0; right: auto; min-width: 50%;}.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: auto; right: 0;}.jimu-widget-add-data.width-medium .btn-group.show .btn,.jimu-widget-add-data.width-small .btn-group.show .btn {display: block; width: 100%; padding: 10px 15px; border: 0; font-weight: normal;}.jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #f4f4f4;}.jimu-widget-add-data.width-medium .btn-group.show .btn.active,.jimu-widget-add-data.width-medium .btn-group.show .btn.active:hover,.jimu-widget-add-data.width-small .btn-group.show .btn.active,.jimu-widget-add-data.width-small .btn-group.show .btn.active:hover {background-color: #196fa6 !important; color: #fff !important;}.jimu-widget-add-data.width-small .jimu-tab3 .tab-item-td {padding-left: 20px; padding-right: 20px;}.jimu-widget-add-data.width-small .search-pane .search-bar {padding-top: 5px; padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin: 0; padding-left: 5px; padding-right: 5px; font-size: 11px;}.jimu-widget-add-data.width-small .search-pane .search-results-pane {padding: 0; overflow: hidden;}.jimu-widget-add-data.width-small .search-pane .item-card {padding-left: 0; padding-right: 0;}.jimu-widget-add-data.width-small .search-pane .item-card .item-card-inner {margin-bottom: 0; border-top: 0; border-left: 0; border-right: 0; border-bottom-color: #e0e0e0;}.add-data-widget-popup .search-type-option {display: block; margin-bottom: 10px;}.add-data-widget-popup .search-type-option,.add-data-widget-popup .search-type-option input {cursor: pointer;}.jimu-widget-add-data {position: absolute; top: 0; bottom: 0; left: 0; right: 0; padding-top: 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option,.jimu-widget-add-data .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-widget-add-data .search-paging li.disabled a,.jimu-widget-add-data .search-paging li.disabled a:hover,.jimu-widget-add-data .search-paging li.disabled a:active,.jimu-widget-add-data .search-paging li.disabled a:focus {cursor: default; opacity: 0.35;}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .dijitDropDownButton {margin: 0;}.jimu-widget-add-data .dijitSelect,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {background: transparent; border: 0; padding: 7px 5px; color: #196fa6; font-weight: bold; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;}.jimu-widget-add-data .dijitSelect .dijitButtonContents,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitButtonContents {border-color: transparent;}.jimu-widget-add-data .dijitSelect .dijitInputField,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitInputField {padding: 0 5px;}.jimu-widget-add-data .dijitSelect .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitArrowButton {background: transparent; border: 0;}.jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 0;}.jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data-dialog {background-color: #FFFFFF !important; border-color: #555555 !important; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important;}.jimu-widget-add-data-dialog .dijitDialogPaneContent {border-top: 1px solid #cccccc;}.jimu-widget-add-data-dialog .dijitDialogTitleBar {background: none repeat scroll 0 0 rgba(0, 0, 0, 0); background-color: #FFFFFF; -moz-border-radius: 3px 3px 0 0; -webkit-border-radius: 3px 3px 0 0; border-radius: 3px 3px 0 0;}.jimu-widget-add-data-dialog .dijitDialogTitle {background-color: #FFFFFF; color: #000000; font-size: 16px; font-weight: bold;}.jimu-widget-add-data-dialog div.gap {margin-top: 20px;}.jimu-widget-add-data-dialog div.small-gap {margin-top: 4px;}.jimu-widget-add-data-dialog div.action-bar {margin-top: 10px;}.jimu-widget-add-data-dialog .url-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data-dialog .url-textbox-wide {width: 500px;}.jimu-widget-add-data-dialog .examples {font-size: 9px; font-style: italic; margin-top: 4px; margin-left: 4px; opacity: 0.5;}.jimu-widget-add-data .btn-link {color: #196fa6 !important;}.jimu-widget-add-data .switch-toggle-group {padding: 5px;}.jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: 36px; vertical-align: top;}.jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: -36px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox {height: 16px; width: 28px; border: 0 none; background: #e04f1d; position: relative; display: inline-block; cursor: pointer; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox:before {content: ""; background: #f8f8f8; position: absolute; padding: 0; height: 12px; width: 12px; left: auto; right: 2px; top: 2px; z-index: 1; -webkit-transition: right 0.3s; -moz-transition: right 0.3s; -o-transition: right 0.3s; transition: right 0.3s; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%;}.jimu-widget-add-data .switch-toggle.dijitCheckBox input {width: 100%; height: 100%; position: absolute; left: 0; z-index: 2;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked {background: #50ad4e;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before {right: 14px;}.jimu-widget-add-data .panel-default \x3e .panel-heading {background-color: transparent; border-color: #e0e0e0;}.jimu-widget-add-data .panel-title {font-size: 16px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .panel-footer .btn + .btn {margin-left: 10px;}.jimu-widget-add-data .gp-panel {width: 300px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading {background-color: transparent; border-left: 1px solid rgba(0, 0, 0, 0.35); color: #efefef; height: 40px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .panel-title {font-weight: normal; line-height: 1.5;}.jimu-widget-add-data .gp-panel \x3e .panel-heading [class^\x3d"esri-icon-"],.jimu-widget-add-data .gp-panel \x3e .panel-heading [class*\x3d" esri-icon-"] {display: inline-block; margin-right: 10px; position: relative; top: 1px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {width: 20px; padding: 0; color: #efefef; float: right; margin-right: 0; font-size: 16px; line-height: 1.25; line-height: 20px; text-align: center;}.jimu-widget-add-data .gp-panel \x3e .panel-body {background-color: #f8f8f8; border-left: 1px solid #cccccc; position: absolute; top: 40px; bottom: 0; width: 100%; overflow: auto; padding: 0;}.jimu-widget-add-data .gp-panel .panel-section {background-color: #ffffff;}.jimu-widget-add-data .panel-section {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .panel-section .section-header {display: block; font-size: 16px; line-height: 1.25; line-height: 20px; padding: 10px 15px;}.jimu-widget-add-data .panel-section .section-header:after {content: ""; display: block; clear: both;}.jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-widget-add-data .panel-section .section-header .btn {margin: 0 5px; float: right;}.jimu-widget-add-data .panel-section .section-header .btn {margin: 0; min-width: 80px;}.jimu-widget-add-data .panel-section .btn.section-header {border: 0; text-align: left; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-transition: all 0.25s ease; -moz-transition: all 0.25s ease; -o-transition: all 0.25s ease; transition: all 0.25s ease;}.jimu-widget-add-data .panel-section .btn.section-header:hover {background-color: #e2f1fb; text-decoration: none;}.jimu-widget-add-data .panel-section .btn.section-header:active,.jimu-widget-add-data .panel-section .btn.section-header:focus {background-color: #aadbfa; text-decoration: none;}.jimu-widget-add-data .panel-section .section-body {padding: 10px 15px;}.jimu-widget-add-data a, .add-url-pane a {display: block; color: #196fa6; text-decoration: none; line-height: 20px; padding: 10px 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option, .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-rtl .jimu-widget-add-data .search-paging li {-moz-transform: rotate(180deg); -webkit-transform: rotate(180deg); -o-transform: rotate(180deg); transform: rotate(180deg);}.jimu-rtl .jimu-widget-add-data .search-paging li.current-page {-moz-transform: rotate(0); -webkit-transform: rotate(0); -o-transform: rotate(0); transform: rotate(0);}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .add-url-pane .url-textbox {width: 100%; font-size: 12px; color: #000000;}.jimu-widget-add-data .add-url-pane .examples {display: none; margin: 15px -15px 0; padding: 15px; font-size: 12px; color: #898989; word-wrap: break-word;}.jimu-widget-add-data .add-url-pane .examples \x3e div \x3e div {margin-bottom: 15px;}.jimu-widget-add-data .add-url-pane .examples.show {display: block;}.jimu-widget-add-data .jimu-tab3 \x3e .jimu-viewstack {position: absolute; top: 39px; left: 0px; right: 0; bottom: 0; padding-bottom: 40px;}.jimu-widget-add-data-footer {height: 40px; overflow: hidden; background-color: #f8f8f8; border-top: 1px solid #ccc; padding: 0 15px; color: #898989; font-size: 11px;}.jimu-widget-add-data-footer [class^\x3d"esri-icon-"],.jimu-widget-add-data-footer [class*\x3d" esri-icon-"] {line-height: 20px;}.jimu-widget-add-data-footer .layerlist-button {text-transform: uppercase;}.jimu-widget-add-data-footer .layerlist-button .esri-icon-layers {margin: 0 5px; vertical-align: middle; display: inline-block;}.jimu-widget-add-data-footer .message {display: block; color: #898989; line-height: 20px; padding: 10px 10px 10px 0; text-overflow: ellipsis; overflow: hidden; word-break: break-all; white-space: nowrap;}.jimu-widget-add-data.layerlist-show {overflow: hidden;}.jimu-widget-add-data.layerlist-show .jimu-tab3 {-webkit-filter: blur(5px); filter: blur(5px);}.jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-right .4s; -webkit-animation: slide-from-right .4s; animation: slide-from-right .4s;}.add-data-widget-layers {width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); position: absolute; top: 0; right: 0; z-index: 1;}.add-data-widget-layers {display: none;}.add-data-widget-layers.show {display: block;}.add-data-widget-layers .add-data-layerlist--container {background: #fff; position: absolute; top: 0; right: 0; width: 320px; height: 100%; -webkit-transition: width 0.4s ease; -moz-transition: width 0.4s ease; -o-transition: width 0.4s ease; transition: width 0.4s ease;}.width-small .add-data-widget-layers .add-data-layerlist--container {width: 100%;}.add-data-widget-layers .add-data-layerlist--container h2 {margin: 0; padding: 7px 15px; border-bottom: 1px solid #ccc; color: #898989; font-size: 14px; font-weight: normal; line-height: 2;}.add-data-layerlist--list {width: 100%; padding: 10px 15px; line-height: 20px; position: absolute; top: 45px; bottom: 40px; overflow: auto;}.add-data-layerlist--listitem {margin-bottom: 5px;}.add-data-layerlist--listitem:after {content: ""; display: table; clear: both;}.add-data-layerlist--listitem .remove-button {float: right; padding: 5px 10px;}.add-data-layerlist--listitem .layer-name {display: block; padding-top: 5px;}.add-data-widget-layers .add-data-layerlist--footer {width: 100%; position: absolute; bottom: 0;}.add-data-widget-layers .back-button {float: right; text-transform: uppercase;}.add-data-widget-layers .back-button i {display: inline-block; margin-left: 5px;}.add-data-widget-layers .no-data-message {color: #898989; padding: 25px; text-align: center;}.add-data-widget-popup {padding: 0;}.add-data-widget-popup .dijitTooltipConnector {display: none;}.add-data-widget-popup .dijitTooltipContainer {padding: 10px; border-color: #ccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup.dijitMenuPopup {-webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup .dijitMenu {border-color: #ccc;}.add-data-widget-popup .dijitMenu .dijitMenuItem td {padding: 10px 15px; border: 0;}.add-data-widget-popup .dijitMenu .dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitMenuItemActive td,.add-data-widget-popup .dijitMenu .dijitMenuItemSelected td {background-color: #f4f4f4; background-image: none;}.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemSelected td {background-color: #196fa6; background-image: none; color: #fff; font-weight: normal;}.LaunchpadTheme .jimu-widget-add-data.jimu-widget {position: absolute;}.LaunchpadTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 5px;}.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {color: #196fa6; font-size: inherit; letter-spacing: 0;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect,.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {background-color: transparent; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn {background-color: #3b8fc4; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn:hover {background-color: #2c6b93;}.DartTheme .jimu-widget-add-data .search-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-secondary {background: #3a3a3a;}.DartTheme .jimu-widget-add-data .secondary-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane-content {background-color: #222;}.DartTheme .jimu-tab3 .tab-item-td.jimu-state-active {background: #4C4C4C;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-separator,.DartTheme .jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #262626;}.DartTheme .jimu-widget-add-data .search-box2 .search-textbox {background: #393939; border: 0; -moz-border-radius: 2px; -webkit-border-radius: 2px; border-radius: 2px;}.DartTheme .jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 100px;}.DartTheme .jimu-widget-add-data .search-box2 .btn {background: #393939; border: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card .item-card-inner {background: #4c4c4c; border-color: #787878;}.DartTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.DartTheme .jimu-widget-add-data.width-medium .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-medium .btn-group.show,.DartTheme .jimu-widget-add-data.width-small .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-small .btn-group.show {background: #393939; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.DartTheme .jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #222;}.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {color: #f8f8f8 !important;}.DartTheme .jimu-widget-add-data .search-pane .search-sort-options label {color: #a7a7a7 !important;}.DartTheme .jimu-widget-add-data .secondary-pane {border-bottom: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card div.info {color: #ddd !important;}.DartTheme .jimu-widget-add-data .search-pane .item-card .action-bar a,.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a,.DartTheme .jimu-widget-add-data .add-file-pane .file-form label {color: #15a4fa !important;}.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {padding: 7px;}.DartTheme .jimu-widget-add-data .dijitSelect {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/search_white.png");}.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder.opened,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close_white.png");}.DartTheme.add-data-widget-popup .dijitTooltipContainer {color: #f8f8f8; background: #4c4c4c; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .add-data-widget-layers .add-data-layerlist--container {background-color: #4c4c4c;}.DartTheme .add-data-widget-layers .add-data-layerlist--container h2 {border-color: #262626;}.DartTheme .jimu-widget-add-data-footer,.DartTheme .add-data-widget-layers .add-data-layerlist--footer {background-color: transparent; border-top-color: #262626;}.DartTheme .jimu-widget-add-data .add-url-pane-container {background-color: transparent; border-color: transparent;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a {padding-top: 0; padding-bottom: 0;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar .jimu-btn {min-width: 140px;}.DartTheme .jimu-widget-add-data .add-file-pane .drop-area {background: transparent; border-color: #ccc;}.DartTheme .jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-left: 15px; padding-right: 15px;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card {float: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .thumbnail {float: right; margin-left: 10px; margin-right: 0;}.jimu-rtl .jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: auto; padding-right: 38px; margin-right: auto; margin-left: 25px;}.jimu-rtl .jimu-widget-add-data .search-box2 {float: left;}.jimu-rtl .jimu-widget-add-data .search-box2 .btn {margin-left: auto; margin-right: -1px;}.jimu-rtl .jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: left;}.jimu-rtl .jimu-widget-add-data .search-box, .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: auto; padding-right: 36px;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: auto; margin-right: -36px;}.jimu-rtl .jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {float: left;}.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header .btn {float: left;}.jimu-rtl .jimu-widget-add-data .search-box,.jimu-rtl .jimu-widget-add-data .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-widget-add-data .add-file-pane .or b {padding-left: 5px; padding-right: 0;}.jimu-rtl .jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {left: 0; right: auto;}.jimu-rtl .add-data-widget-layers .add-data-layerlist--container {left: 0; right: auto;}.jimu-rtl .jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-left .4s; -webkit-animation: slide-from-left .4s; animation: slide-from-left .4s;}.jimu-rtl .add-data-layerlist--listitem .remove-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button i {margin-left: 0; margin-right: 5px;}.jimu-rtl .add-data-widget-layers .back-button i.esri-icon-collapse:before {content: "\\e631";}.ar .esri-icon-question {-webkit-transform: rotateY(180deg); transform: rotateY(180deg); display: inline-block;}@-moz-keyframes updload-arrow-animation {0% {-moz-transform: translateY(0px);} 50% {-moz-transform: translateY(-10px);} 100% {-moz-transform: translateY(0px);}}@-webkit-keyframes updload-arrow-animation {0% {-webkit-transform: translateY(0px);} 50% {-webkit-transform: translateY(-10px);} 100% {-webkit-transform: translateY(0px);}}@keyframes updload-arrow-animation {0% {transform: translateY(0px);} 50% {transform: translateY(-10px);} 100% {transform: translateY(0px);}}@-moz-keyframes slide-from-right {0% {-moz-transform: translateX(50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-right {0% {-webkit-transform: translateX(50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-right {0% {transform: translateX(50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}@-moz-keyframes slide-from-left {0% {-moz-transform: translateX(-50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-left {0% {-webkit-transform: translateX(-50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-left {0% {transform: translateX(-50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}',
"*now":function(m){m(['dojo/i18n!*preload*widgets/AddData/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/aspect dojo/Deferred dojo/dom-class jimu/portalUrlUtils jimu/portalUtils jimu/tokenUtils jimu/BaseWidget jimu/dijit/TabContainer3 dijit/_WidgetsInTemplateMixin ./search/SearchContext ./search/util ./search/SearchPane ./search/AddFromUrlPane ./search/AddFromFilePane ./search/LayerListPane dojo/_base/array".split(" "),function(m,c,n,g,f,t,a,u,q,v,D,B,G,w,E,z,F,H,e){return m([v,B],{name:"AddData",baseClass:"jimu-widget-add-data",batchGeocoderServers:null,
isPortal:!1,_isOpen:!1,_searchOnOpen:!1,tabContainer:null,searchPane:null,addFromUrlPane:null,addFromFilePane:null,postCreate:function(){this.inherited(arguments)},startup:function(){if(!this._started){var a=this,c=arguments;this._getUser().then(function(c){a._checkConfig();a._initTabs();return a._initContext(c)}).then(function(){a.inherited(c);a.tabContainer?a.tabContainer.startup():a.searchPane?a.searchPane.startup():a.addFromUrlPane?a.addFromUrlPane.startup():a.addFromFilePane&&a.addFromFilePane.startup();
a._initFooter(a.tabContainer,{searchWidget:a.searchPane,addFromUrlWidget:a.addFromUrlPane,addFromFileWidget:a.addFromFilePane});a._initListeners();a.resize()}).otherwise(function(e){console.warn("AddData.startup error:",e);a.inherited(c);a.resize()})}},_checkConfig:function(){this.config||(this.config={});var a=function(a,e){var f=a[e];f||(f=a[e]={allow:!0,label:null});"boolean"!==typeof f.allow&&(f.allow=!0);"Curated"!==e||"string"===typeof f.filter&&0!==c.trim(f.filter).length||(f.allow=!1)},e=
this.config;e.scopeOptions||(e.scopeOptions={});var f=e.scopeOptions;a(f,"MyContent");a(f,"MyOrganization");a(f,"Curated");a(f,"ArcGISOnline");a(e,"addFromUrl");a(e,"addFromFile")},getSharingUrl:function(){var c=u.getPortal(this.appConfig.portalUrl);return a.getSharingUrl(c.portalUrl)},_getUser:function(){var a=new f,c=this.appConfig.portalUrl;q.userHaveSignInPortal(c)?u.getPortal(c).getUser().then(function(c){a.resolve(c)}).otherwise(function(c){console.warn("AddData._getUser error:",c);a.resolve(null)}):
a.resolve(null);return a},_initBatchGeocoder:function(a,c){var f=!1,h=/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig,g=/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig,m=a&&a.helperServices&&a.helperServices.geocode||[],b,d,n=[];c&&c.privileges&&(f=-1<e.indexOf(c.privileges,"premium:user:geocode"));e.forEach(m,function(c){b=!!c.url.match(h);d=!!c.url.match(g);(b&&!a.isPortal&&f||d||c.batch)&&n.push({isWorldGeocodeServer:b||d,isWorldGeocodeServerProxy:d,label:c.name,
value:c.url,url:c.url,name:c.name})});this.batchGeocoderServers=n},_initContext:function(c){var e=new f,h=!0,g=w.checkMixedContent("http://www.arcgis.com"),m=this.config.scopeOptions,n=c&&"string"===typeof c.username&&0<c.username.length,b=new G,d=u.getPortal(this.appConfig.portalUrl);this.isPortal=d.isPortal;b.portal=d;d.isPortal&&(b.orgId=d.id);c&&"string"===typeof c.orgId&&0<c.orgId.length&&(b.orgId=c.orgId);n?b.username=c.username:m.MyContent.allow=!1;this.searchPane&&(this.searchPane.searchContext=
b,this.searchPane.portal=d);this._initBatchGeocoder(d,c);if(d.isPortal)try{var p=a.getSharingUrl(d.portalUrl)+"/kml",p=p.replace("/sharing/rest/kml","/sharing/kml");window.esri.config.defaults.kmlService=p;window.esri.config.defaults.geoRSSService=p.replace("/kml","/rss")}catch(C){console.error(C)}var l=this.nls.search.loadError+g,k=m.ArcGISOnline;b.allowArcGISOnline=k.allow;if(d.isPortal&&b.allowArcGISOnline){var q=u.getPortal(g);q?q.helperServices||(h=!1,q.loadSelfInfo().then(function(){q.helperServices?
b.arcgisOnlinePortal=q:(console.warn(l),b.allowArcGISOnline=!1,k.allow=!1);e.resolve()}).otherwise(function(a){b.allowArcGISOnline=!1;k.allow=!1;console.warn(l);console.warn(a);e.resolve()})):(console.warn(l),b.allowArcGISOnline=!1,k.allow=!1)}else!n&&!d.isPortal&&m.MyOrganization.allow&&m.ArcGISOnline.allow&&(m.MyOrganization.allow=!1);h&&e.resolve();return e},_initFooter:function(a,e){if(a){var f=e.searchWidget,h=!1;f&&f.footerNode&&f.footerNode.nodeName&&(h=!0);e=this.footerContainer=document.createElement("DIV");
e.className=this.baseClass+"-footer";h&&e.appendChild(f.footerNode);var g=document.createElement("A");g.className="layerlist-button jimu-float-trailing";g.href="#";g.innerHTML="\x3cspan class\x3d'esri-icon-layers'\x3e\x3c/span\x3e"+this.nls.layerList.caption;this.own(n(g,"click",c.hitch(this,function(a){a.preventDefault();this.showLayers()})));e.appendChild(g);var m=this.messageNode=document.createElement("SPAN");m.className="message";e.appendChild(m);a=a.containerNode||a.domNode||a;a.nodeName&&a.appendChild(e);
this.own(n(this.tabContainer,"tabChanged",c.hitch(this,function(a){this._setStatus("");h&&(f.footerNode.style.display=a===this.nls.tabs.search?"":"none");this.nls.tabs.search===a?(h&&(f.footerNode.style.display=""),m.style.display="none"):(h&&(f.footerNode.style.display="none"),m.style.display="")})))}},_initListeners:function(){var a=this;this.map&&this.own(this.map.on("extent-change",function(){try{a.searchPane&&a.searchPane.bboxOption.bboxToggle.get("checked")&&(a._isOpen?a.searchPane.search():
a._searchOnOpen=!0)}catch(A){console.warn(A)}}))},_initTabs:function(){var a=this.config,c=[],e=!!(window.File&&window.FileReader&&window.FormData),f=!1,m=a.scopeOptions,n=function(a){f||m&&m[a]&&m[a].allow&&(f=!0)};n("MyContent");n("MyOrganization");n("Curated");n("ArcGISOnline");f&&(this.searchPane=new E({wabWidget:this},this.searchNode),c.push({title:this.nls.tabs.search,content:this.searchPane.domNode}));a.addFromUrl&&a.addFromUrl.allow&&(this.addFromUrlPane=new z({wabWidget:this},this.urlNode),
c.push({title:this.nls.tabs.url,content:this.addFromUrlPane.domNode}));e&&a.addFromFile&&a.addFromFile.allow&&(this.addFromFilePane=new F({wabWidget:this},this.fileNode),c.push({title:this.nls.tabs.file,content:this.addFromFilePane.domNode}));var b=this;if(0<c.length){this.tabContainer=new D({average:!0,tabs:c},this.tabsNode);try{1===c.length&&this.tabContainer.controlNode&&this.tabContainer.containerNode&&(this.tabContainer.controlNode.style.display="none",this.tabContainer.containerNode.style.top=
"0px")}catch(d){}this.own(g.after(this.tabContainer,"selectTab",function(a){b.searchPane&&a===b.nls.tabs.search&&b.searchPane.resize()},!0))}else 0===c.length&&this.tabsNode.appendChild(document.createTextNode(this.nls.noOptionsConfigured))},_setStatus:function(a){this.messageNode&&(w.setNodeText(this.messageNode,a),this.messageNode.title=a)},onClose:function(){this._isOpen=!1},onOpen:function(){var a=this.searchPane&&this._searchOnOpen;this._isOpen=!0;this._searchOnOpen=!1;this.resize();a&&this.searchPane.search()},
resize:function(){var a=this.domNode.clientWidth,c=this.domNode.clientHeight;1E3<a?(t.remove(this.domNode,"width-768"),t.add(this.domNode,"width-1200")):768<a?(t.remove(this.domNode,"width-1200"),t.add(this.domNode,"width-768")):t.remove(this.domNode,["width-768","width-1200"]);420>a?(t.remove(this.domNode,"width-medium"),t.add(this.domNode,"width-small")):750>a?(t.remove(this.domNode,"width-small"),t.add(this.domNode,"width-medium")):t.remove(this.domNode,["width-small","width-medium"]);340>a?t.add(this.domNode,
"filter-placeholder-on"):t.remove(this.domNode,"filter-placeholder-on");400>c?t.add(this.domNode,"height-small"):t.remove(this.domNode,"height-small");this.searchPane&&this.searchPane.resize()},showLayers:function(){this.layerListPane||(this.layerListPane=new H({wabWidget:this}),this.layerListPane.placeAt(this.domNode));this.layerListPane.show()}})});