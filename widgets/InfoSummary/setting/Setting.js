// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/LayerChooserFromMapWithDropbox":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/keys dojo/Evented dojo/Deferred dijit/popup dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/LayerChooserFromMapWithDropbox.html jimu/LayerInfos/LayerInfos".split(" "),function(l,q,p,n,b,a,f,k,d,m,y,g){return l([d,m,a],{templateString:y,baseClass:"jimu-layer-chooser-from-map-withdropbox",declaredClass:"jimu.dijit.LayerChooserFromMapWithDropbox",
_selectedItem:null,_isLayerChooserShow:!1,layerInfosObj:null,layerChooser:null,customClass:"",postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.queryableLayerSource;this.nls.customSelectLayer=this.label?this.label:this.nls.selectLayer},postCreate:function(){this.inherited(arguments);this.layerInfosObj=g.getInstanceSync();this.layerChooser.domNode.style.zIndex=1;this.layerChooser.tree.domNode.style.borderTop="0";this.layerChooser.tree.domNode.style.maxHeight="290px";
this.own(n(this.layerChooser,"tree-click",q.hitch(this,this._onTreeClick)));this.own(n(this.layerChooser,"update",q.hitch(this,this._onLayerChooserUpdate)));this.own(n(document.body,"click",q.hitch(this,this._onBodyClicked)));this.own(n(document.body,"keydown",q.hitch(this,function(a){a.keyCode===b.ENTER&&this._onBodyClicked(a)})));this.own(n(this.layerChooser.domNode,"keydown",q.hitch(this,function(a){a.keyCode===b.ESCAPE&&this.hideLayerChooser()})))},destroy:function(){this.hideLayerChooser();this.layerChooser&&
this.layerChooser.destroy();this.layerChooser=null;this.inherited(arguments)},getLayerChooser:function(){return this.layerChooser},setSelectedLayer:function(a){var b=new f;if(a){var d=this.layerInfosObj.getLayerInfoById(a.id);d?this.layerChooser.filter(d).then(q.hitch(this,function(t){t?(this._onSelectNewItem({layerInfo:d,name:d.title,url:a.url}),b.resolve(!0)):b.resolve(!1)}),q.hitch(this,function(){b.resolve(!1)})):b.resolve(!1)}else this._onSelectNewItem(null),b.resolve(!0);return b},getSelectedItem:function(){return this._selectedItem},
getSelectedItems:function(){return[this._selectedItem]},_onBodyClicked:function(a){a=a.target||a.srcElement;a===this.domNode||p.isDescendant(a,this.domNode)||a===this.layerChooser.domNode||p.isDescendant(a,this.layerChooser.domNode)||this.hideLayerChooser()},_onDropDownClick:function(a){a.stopPropagation();a.preventDefault();this._isLayerChooserShow?this.hideLayerChooser():(this.isActive=!0,this.showLayerChooser())},_onDropDownKeydown:function(a){a.keyCode===b.ENTER&&this._onDropDownClick(a)},_getSelectedItems:function(){return this.layerChooser.getSelectedItems()},
showLayerChooser:function(){this.layerChooser.domNode.style.minWidth=this.domNode.clientWidth+2+"px";k.open({parent:this,popup:this.layerChooser,around:this.domNode});var a=this.layerChooser.domNode.parentNode;a&&(p.addClass(a,"jimu-layer-chooser-from-map-withdropbox-popup"),this.customClass&&p.addClass(a,this.customClass),this.layerChooser.tree.domNode.focus());this._isLayerChooserShow=!0},hideLayerChooser:function(){k.close(this.layerChooser);this._isLayerChooserShow=!1;this.isActive&&(this.dropDownBtn.focus(),
this.isActive=!1)},_onLayerChooserUpdate:function(){this._selectedItem&&this.layerChooser.onlyShowVisible&&!this._selectedItem.layerInfo.isShowInMap()&&(this._selectedItem=null,this.emit("selection-change",[]))},_onSelectNewItem:function(a){var b=q.getObject("layerInfo.id",!1,this._selectedItem)||-1,d=q.getObject("layerInfo.id",!1,a)||-1,b=b!==d;this._selectedItem=a;this.hideLayerChooser();a=q.getObject("layerInfo.title",!1,this._selectedItem)||"";this.layerNameNode.innerHTML=a;p.setAttr(this.layerNameNode,
"title",a);a=q.getObject("layerInfo.layerObject",!1,this._selectedItem);b&&this.emit("selection-change",[a])},_onTreeClick:function(){var a=this._getSelectedItems();this._onSelectNewItem(0<a.length?a[0]:null)}})})},"widgets/InfoSummary/setting/MySymbolPicker":function(){define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dijit/form/Select dijit/form/ValidationTextBox dojo/_base/lang dojo/_base/html dojo/dom-style dojo/dom-construct dojo/on dojo/dom dojox/gfx dojo/query dojo/_base/Color dijit/registry esri/symbols/jsonUtils esri/request esri/Color jimu/dijit/SymbolPicker jimu/BaseWidget jimu/dijit/TabContainer3 jimu/utils jimu/dijit/SimpleTable jimu/dijit/Message jimu/dijit/ColorPicker jimu/dijit/ImageChooser jimu/dijit/CheckBox dojo/_base/array esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/PictureMarkerSymbol dojo/text!./MySymbolPicker.html dojo/Evented dijit/focus dojox/form/FileUploader".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y,g,w,u,x,t,C,L,A,I,G,z,H,O,B,E,c,F,K,M,h,D,N){return l([A,q,D],{templateString:h,baseClass:"jimu-widget-InfoSummary-setting",nls:null,row:null,layerInfo:null,clusteringEnabled:null,symbolInfo:null,symbolType:"",map:null,supportsDynamic:!0,tabContainer:null,field_options:[],groupFeaturesEnabled:!1,lyrSymbolSet:[],_highLightColor:"#ffffff",defaultSymbol:null,panelHTML:null,svg:null,constructor:function(e){this.nls=e.nls;this.row=e.callerRow;this.layerInfo=e.layerInfo;this.renderer=
e.layerInfo.renderer;this.geometryType=e.layerInfo.geometryType;this.symbolInfo=e.symbolInfo;this.map=e.map;this.ac=e.ac;this.layerId=e.value;this.supportsDynamic=e.layerInfo.supportsDynamic;this.fields=e.layerInfo.fields;this.hidePanel=e.hidePanel;this.oidFieldName=e.layerInfo.oidFieldName;this.loadSymbolPicker=e.loadSymbolPicker;this.popupFields=[];if(e.layerInfo.infoTemplate&&e.layerInfo.infoTemplate.info&&(e=e.layerInfo.infoTemplate.info.fieldInfos))for(var c=0;c<e.length;c++)e[c].visible&&this.popupFields.push(e[c].fieldName)},
postMixInProperties:function(){this.inherited(arguments);this.nls.common=window.jimuNls.common},postCreate:function(){this.inherited(arguments);this.defaultSymbol=null;this._initCheckBoxes();this._initRadioButtons();this._initImageChoosers();this._setFields(this.fields);this._initTabControl();this._initSymbolPickerTab(this.geometryType);this._initFeatureOptionsTab();if(this.hidePanel)a.removeClass(this.btnAddField,"btn-add-section"),a.addClass(this.btnAddField,"btn-add-section-disabled"),a.addClass(this.iconOptionsTextLabel,
"text-disabled"),a.addClass(this.featureOptionsTextLabel,"text-disabled"),a.addClass(this.groupOptionsTextLabel,"text-disabled"),a.addClass(this.rdoLayerIconLabel,"text-disabled"),a.addClass(this.rdoCustomIconLabel,"text-disabled");else{this.own(d(this.btnAddField,"click",b.hitch(this,this._addFieldRow,this.fieldOptionsTable,"loSelect")));var e=this.fieldOptionsTable.getRows();e&&3<=e.length?(a.removeClass(this.btnAddField,"btn-add-section"),a.addClass(this.btnAddField,"btn-add-section-disabled")):
(a.removeClass(this.btnAddField,"btn-add-section-disabled"),a.addClass(this.btnAddField,"btn-add-section"));a.removeClass(this.iconOptionsTextLabel,"text-disabled");a.removeClass(this.featureOptionsTextLabel,"text-disabled");a.removeClass(this.groupOptionsTextLabel,"text-disabled");a.removeClass(this.rdoLayerIconLabel,"text-disabled");a.removeClass(this.rdoCustomIconLabel,"text-disabled")}this.chkGroup.setStatus(!this.hidePanel);this.rdoLayerIcon.set("disabled",this.hidePanel);this.rdoCustomIcon.set("disabled",
this.hidePanel);this.own(d(this.symbolPicker.domNode,"click",b.hitch(this,function(e){e.stopPropagation();e.preventDefault();this.symbolPicker._isTooltipDialogOpened||"EsriSymbol"!==this.symbolType||this._validateSymbolChooserWidthField()||this.symbolPicker._showTooltipDialog()})))},_initRadioButtons:function(){this.own(d(this.rdoLayerSym,"change",b.hitch(this,this._rdoLayerSymChanged)));this.own(d(this.rdoEsriSym,"change",b.hitch(this,this._rdoEsriSymChanged)));this.own(d(this.rdoCustomSym,"change",
b.hitch(this,this._rdoCustomSymChanged)));this.own(d(this.rdoLayerIcon,"change",b.hitch(this,this._rdoLayerIconChanged)));this.own(d(this.rdoCustomIcon,"change",b.hitch(this,this._rdoCustomIconChanged)));this.own(d(this.rdoGroupField,"change",b.hitch(this,this._rdoGroupByFieldChanged)));this.own(d(this.rdoGroupRenderer,"change",b.hitch(this,this._rdoGroupByRendererChanged)))},_initCheckBoxes:function(){this.chkClusterSym=this._initCheckBox(this.nls.chkCluster,this.div_chkCluster);this.own(d(this.chkClusterSym,
"change",b.hitch(this,this._chkClusterChanged)));this.chkClusterCnt=this._initCheckBox(this.nls.displayClusterCnt,this.div_chkGroupCluster);this.own(d(this.chkClusterCnt,"change",b.hitch(this,this._chkClusterCntChanged)));this.chkGroup=this._initCheckBox(this.nls.chkGroup,this.div_chkGroup);this.own(d(this.chkGroup,"change",b.hitch(this,this._chkGroupChanged)))},_initCheckBox:function(e,c){var h=new E;h.setLabel(e);h.placeAt(c);return h},_initImageChoosers:function(){this.imageIconChooser=new B({format:[B.GIF,
B.JPEG,B.PNG],cropImage:!1,showTip:!1,goldenWidth:10,goldenHeight:15});a.addClass(this.imageIconChooser.domNode,"uploadCustom");a.place(this.imageIconChooser.domNode,this.uploadCustomIcon,"replace");this.imageSymbolChooser=new B({format:[B.GIF,B.JPEG,B.PNG],cropImage:!1,showTip:!1,goldenWidth:10,goldenHeight:15});a.addClass(this.imageSymbolChooser.domNode,"uploadCustom");a.place(this.imageSymbolChooser.domNode,this.uploadCustomSymbol,"replace")},_setFields:function(e){if(e){this.field_options=[];
for(var c=[""," ",void 0,null],h=0;h<e.length;h++)this.field_options.push({value:e[h].name,label:-1===c.indexOf(e[h].alias)?e[h].alias:e[h].name})}},_initTabControl:function(){this.tabContainer=new I({tabs:[{title:this.nls.symbolOptions,content:this.symbolPickerContainer},{title:this.nls.panelFeatureDisplay,content:this.panelFeatureDisplayContainer}],isNested:!0},this.tabParent);this.tabContainer.startup()},_initSymbolPickerTab:function(e){e=G.getTypeByGeometryType(e);this._loadLayerSymbol();this.supportsDynamic&&
this.loadSymbolPicker&&this._initSymbolPicker(e);this._initClusterSymbolPicker(e);this._addEventHandlers(e);this._initSymbolUI()},_initFeatureOptionsTab:function(){this.isInitalLoad=!0;this.fieldLoadCount=0;this.fieldOptionsTable=new z({fields:[{name:"field",title:this.nls.selectField,"class":"label",type:"empty",width:"100px"},{name:"label","class":"label",title:this.nls.fieldLabel,type:"empty",width:"100px"},{name:"actions","class":"label",title:this.nls.actions,type:"actions",actions:["up","down",
"delete"],width:"50px"}],selectable:!1,autoHeight:!0});this.fieldOptionsTable.placeAt(this.fieldOptions);this.fieldOptionsTable.startup();this.fieldOptionsTable.on("row-delete",b.hitch(this,this._rowDeleted));this.groupOptionsTable=new z({fields:[{name:"field",title:this.nls.selectField,"class":"label",type:"empty",width:"180px"},{name:"label","class":"label",title:this.nls.fieldLabel,type:"empty",width:"140px"}],selectable:!1,autoHeight:!0});this.groupOptionsTable.placeAt(this.groupFieldOptions);
this.groupOptionsTable.startup();this._initFeatureOptionsUI();this.isInitalLoad=!1},_initFeatureOptionsUI:function(){var e;this.symbolInfo&&this.symbolInfo.featureDisplayOptions&&(e=this.symbolInfo.featureDisplayOptions);if(e&&e.fields)for(var c=0;c<e.fields.length;c++)this._populateLayerRow(this.fieldOptionsTable,e.fields[c],"loSelect");else if(this._addFieldRow(this.groupOptionsTable,"goSelect"),this.popupFields&&0<this.popupFields.length)for(var c=2<this.popupFields.length?3:this.popupFields.length,
h=0;h<c;h++)this._populateLayerRow(this.fieldOptionsTable,{name:this.popupFields[h]},"loSelect");this.groupFeaturesEnabled=e&&"undefined"!==typeof e.groupEnabled?e.groupEnabled:!1;this._chkGroupChanged(this.groupFeaturesEnabled);this.chkGroup.setValue(this.groupFeaturesEnabled);e&&e.groupField&&this._populateLayerRow(this.groupOptionsTable,e.groupField,"goSelect");c=!0;e&&"undefined"!==typeof e.groupByField&&(this._rdoGroupByFieldChanged(e.groupByField),c=!1);h=!1;this.renderer&&(this.renderer.attributeField||
this.renderer.field||this.renderer.field1)&&(h=!0);h||f.set(this.grpRenderer,"display","none");e&&"undefined"!==typeof e.groupByRenderer&&(this._rdoGroupByRendererChanged(e.groupByRenderer),c=!1);c&&this._rdoGroupByFieldChanged(c)},_rowDeleted:function(e){3>this.fieldOptionsTable.getRows().length&&(a.removeClass(this.btnAddField,"btn-add-section-disabled"),a.addClass(this.btnAddField,"btn-add-section"))},_populateLayerRow:function(e,c,h){this.fieldLoadCount+=1;e=e.addRow({});e.success&&e.tr&&(e=e.tr,
this._addFieldsOption(e,h),this._addLabelOption(e),e.selectFields.set("value",c.name),e.labelText.set("value",c.label))},_addFieldRow:function(e,c){if(e===this.fieldOptionsTable&&3<=e.getRows().length)new H({message:this.nls.max_records});else{this.isInitalLoad=!1;var h=e.addRow({});h.success&&h.tr&&(h=h.tr,this._addFieldsOption(h,c),this._addLabelOption(h));e===this.fieldOptionsTable&&3<=e.getRows().length&&(a.removeClass(this.btnAddField,"btn-add-section"),a.addClass(this.btnAddField,"btn-add-section-disabled"))}},
_addFieldsOption:function(e,c){var h=b.clone(this.field_options),t=g(".simple-table-cell",e)[0];t&&(a.setStyle(t,"verticalAlign","middle"),a.setStyle(t,"line-height","inherit"),c=new p({style:{width:"100%",height:"28px"},"class":c,options:h}),c.placeAt(t),c.startup(),e.selectFields=c,this.own(d(c,"change",b.hitch(this,function(){this.fieldLoadCount&&0<this.fieldLoadCount?--this.fieldLoadCount:e.labelText.set("value","");e.cells[0].title=e.cells[0].innerText}))),e.cells[0].title=e.cells[0].innerText)},
_addLabelOption:function(e){var c=g(".simple-table-cell",e)[1];a.setStyle(c,"verticalAlign","middle");a.setStyle(c,"line-height","inherit");var h=new n({style:{width:"100%",height:"28px"}});h.placeAt(c);h.startup();e.labelText=h},_initSymbolUI:function(){"undefined"!==typeof this.symbolInfo?(this.symbolType=this.symbolInfo.symbolType,this.clusterType=this.symbolInfo.clusterType,this.iconType=this.symbolInfo.iconType,this.displayFeatureCount=this.symbolInfo.displayFeatureCount,this.clusteringEnabled=
this.symbolInfo.clusteringEnabled,this.userDefinedSymbol=this.symbolInfo.userDefinedSymbol,this._highLightColor=this.symbolInfo._highLightColor,this._setSymbolType(this.symbolInfo.symbolType),this._setClusterType(this.symbolInfo.clusterType),this._setIconType(this.symbolInfo.iconType),"undefined"!==typeof this.symbolInfo.clusterType&&("CustomCluster"===this.symbolInfo.clusterType&&this.symbolInfo.clusterSymbol&&this.clusterPicker.showBySymbol(x.fromJson(this.symbolInfo.clusterSymbol)),this.userDefinedSymbol=
!0),this.chkClusterSym.setValue(this.symbolInfo.clusteringEnabled),this._chkClusterChanged(this.symbolInfo.clusteringEnabled)):(this.rdoLayerSym.set("checked",!0),this._rdoEsriSymChanged(!1),this._rdoCustomSymChanged(!1),this.chkClusterSym.setValue(!1),this.chkClusterCnt.setValue(!1),this.rdoLayerIcon.set("checked",!0),this._rdoCustomIconChanged(!1),this.symbolType="LayerSymbol",this.iconType="LayerIcon",this.userDefinedSymbol=this.clusteringEnabled=!1);"esriGeometryPoint"===this.geometryType&&this.supportsDynamic||
(f.set(this.parent_div_uploadCustomSymbol,"display","none"),this.supportsDynamic||f.set(this.div_rdoEsriSym,"display","none"))},_setSymbolType:function(e){switch(e){case "LayerSymbol":this.symbolInfo.symbolOverride?(this.userDefinedSymbol=!0,this.rdoEsriSym.set("checked",!0),this._rdoLayerSymChanged(!1),this._rdoCustomSymChanged(!1),this.symbolPicker.showBySymbol(x.fromJson(this.symbolInfo.symbol))):(this.rdoLayerSym.set("checked",!0),this._rdoEsriSymChanged(!1),this._rdoCustomSymChanged(!1));break;
case "EsriSymbol":this.userDefinedSymbol=!0;this.rdoEsriSym.set("checked",!0);this._rdoLayerSymChanged(!1);this._rdoCustomSymChanged(!1);this.symbolPicker.showBySymbol(x.fromJson(this.symbolInfo.symbol));break;case "CustomSymbol":this.userDefinedSymbol=!0,this.rdoCustomSym.set("checked",!0),this._rdoEsriSymChanged(!1),this._rdoLayerSymChanged(!1),this._createImageDataDiv(this.symbolInfo.symbol,!0,this.customSymbolPlaceholder)}},_setIconType:function(e){switch(e){case "LayerIcon":this.rdoLayerIcon.set("checked",
!0);break;case "CustomIcon":this.userDefinedSymbol=!0,this.rdoCustomIcon.set("checked",!0),this.symbolInfo.icon&&(this.updateImg(),e=x.fromJson(this.symbolInfo.icon),this._createImageDataDiv(e,!0,this.customIconPlaceholder))}},_setClusterType:function(e){switch(e){case "ThemeCluster":this.userDefinedSymbol=!0;this.clusterType="ThemeCluster";break;case "CustomCluster":this.userDefinedSymbol=!0,this.clusterType="CustomCluster",this.chkClusterCnt.setValue(this.displayFeatureCount),this.colorPicker.setColor(new w(this._highLightColor))}},
updateImg:function(){if(-1<this.symbolInfo.icon.toString().indexOf("\x3cimg")){var e=document.createElement("div");e.innerHTML=this.symbolInfo.icon;var c=new M(e.children[0].src,26,26);this.symbolInfo.icon=c.toJson();e.remove()}},_addEventHandlers:function(e){var c;"point"===e&&this.own(d(this.imageSymbolChooser,"ImageChange",b.hitch(this,function(e){this.uploadImage("Symbol",e);this.emit("onImageSelected")})));this.own(d(this.imageIconChooser,"ImageChange",b.hitch(this,function(e){this.uploadImage("Icon",
e)})));this.btnOk.innerText=this.nls.common.ok;this.own(d(this.btnOk,"click",b.hitch(this,function(){"EsriSymbol"!==this.symbolType||this._validateSymbolChooserWidthField()?(this._setSymbol(),this.emit("ok",this.symbolInfo)):(c=new H({message:this.nls.invalidSymbolWidthMessage}),c.buttons[0].onClick=b.hitch(this,function(){c.close();setTimeout(b.hitch(this,function(){this.symbolPicker.domNode.click();this._validateSymbolChooserWidthField()}),100)}))})));this.btnCancel.innerText=this.nls.common.cancel;
this.own(d(this.btnCancel,"click",b.hitch(this,function(){this.emit("cancel")})))},_setSymbol:function(){var e;switch(this.symbolType){case "LayerSymbol":e=this.symbol;break;case "EsriSymbol":this.userDefinedSymbol=!0;e=this.symbolPicker.getSymbol();break;case "CustomSymbol":this.userDefinedSymbol=!0,0<this.customSymbolPlaceholder.children.length&&(e="undefined"!==typeof this.customSymbolPlaceholder.children[0].src?new M(this.customSymbolPlaceholder.children[0].src,26,26):x.fromJson(this.symbolInfo.symbol))}var c;
"LayerIcon"===this.iconType?c=e:0<this.customIconPlaceholder.children.length&&("undefined"!==typeof this.customIconPlaceholder.children[0].src?(a.removeClass(this.customIconPlaceholder.firstChild,"customPlaceholder"),a.addClass(this.customIconPlaceholder.firstChild,"customPlaceholderSettings"),c=new M(this.customIconPlaceholder.children[0].src,26,26)):c=x.fromJson(this.symbolInfo.icon));this.clusteringEnabled&&"esriGeometryPoint"===this.geometryType?(this.clusterSymbol="ThemeCluster"===this.clusterType?
"custom":this.clusterPicker.getSymbol().toJson(),this.userDefinedSymbol=!0):(this.clusterSymbol=void 0,this.clusteringEnabled=!1);e&&"undefined"!==typeof e.toJson&&(e=e.toJson());var h;h=0<this.customIconPlaceholder.children.length?this.customIconPlaceholder.children[0].src:0<this.layerSym.children.length?this.layerSym.children[0].innerHTML:this.customIconPlaceholder.outerHTML;if("undefined"!==typeof c){var b="LayerIcon"!==this.iconType||"CustomSymbol"===this.symbolType;this._createImageDataDiv2(c,
44,44,!0,b);this._createImageDataDiv2(c,28,28,!1,b)}var t;if("undefined"!==typeof this.ren)for(t=[],b=0;b<this.ren.length;b++){var r=this.ren[b],v,d,D;if("undefined"!==typeof r.value)d=isNaN(r.value)?"'"+r.value+"'":r.value,v="undefined"!==typeof r.label?r.label:r.value,d="undefined"!==typeof d?" \x3d\x3d\x3d "+d:void 0,D="undefined"!==typeof r.description&&""!==r.description?r.description:void 0;else if("undefined"!==typeof r.classMaxValue){v=r.label;var g;v&&(g=v.split(" - "));g&&(d=1<g.length?
" \x3e\x3d "+g[0]+" \x26\x26 \x3c\x3d "+g[1]:" \x3d\x3d\x3d "+g[0]);D="undefined"!==typeof r.description&&""!==r.description?r.description:void 0}t.push({value:d,label:v,description:D})}v=[];this.renderer&&this.renderer.attributeField?(v.push({name:this.renderer.attributeField}),this.renderer.attributeField2&&v.push({name:this.renderer.attributeField2}),this.renderer.attributeField3&&v.push({name:this.renderer.attributeField3})):this.renderer&&this.renderer.field?v.push({name:this.renderer.field}):
this.renderer&&this.renderer.field1&&v.push({name:this.renderer.field1});g=this.fieldOptionsTable?this._getFields(this.fieldOptionsTable):null;this.symbolInfo={symbolType:this.symbolType,symbol:e,clusterSymbol:this.clusterSymbol,clusteringEnabled:this.clusteringEnabled,displayFeatureCount:this.displayFeatureCount,_highLightColor:this.colorPicker.color.toHex(),icon:c&&c.toJson?c.toJson():c,clusterType:this.clusterType,iconType:this.iconType,renderer:this.renderer,s:h,svg:this.svg,panelHTML:this.panelHTML,
userDefinedSymbol:this.userDefinedSymbol?this.userDefinedSymbol:!1,layerId:this.layerId,selectedId:this.selectedID,featureDisplayOptions:{groupEnabled:this.groupFeaturesEnabled,listDisabled:g&&0<g.length?!1:!0,groupByRenderer:"undefined"===typeof this.groupByRenderer?!1:this.groupByRenderer,groupByField:"undefined"===typeof this.groupByField?!1:this.groupByField,fields:g,groupField:this.groupOptionsTable?this._getFields(this.groupOptionsTable)[0]:null,groupByRendererOptions:{fields:v,values:t}}}},
_getFields:function(e){e=e.getRows();var h=[];c.forEach(e,function(e){e.selectFields&&h.push({name:e.selectFields.value,label:e.labelText.value})});return h},_rdoLayerSymChanged:function(e){e&&(this.symbolType="LayerSymbol",this.selectedID&&this.setLayerSymbol(m.byId(this.selectedID)),this.emit("enableOkButton"));a.setStyle(this.layerSym,"display",e?"block":"none");this.defaultSymbol&&(this.symbol=b.clone(this.defaultSymbol))},_rdoEsriSymChanged:function(e){e&&(this.symbolType="EsriSymbol",this.emit("enableOkButton"));
a.setStyle(this.symbolPicker.domNode,"display",e?"block":"none")},_rdoCustomSymChanged:function(e){e&&(this.symbolType="CustomSymbol",0===this.customSymbolPlaceholder.children.length&&this.emit("customSymbolButtonClicked"));a.setStyle(this.customSymbolDIV,"display",e?"block":"none")},_chkClusterChanged:function(e){this.clusteringEnabled=e;a.setStyle(this.grpClusterOptions,"display",e?"block":"none");a.setStyle(this.featureFont,"display",e?"block":"none");a.setStyle(this.clusterPickerContainer,"display",
e?"block":"none");e&&"undefined"===typeof this.clusterType&&(this.clusterType="CustomCluster")},_chkClusterCntChanged:function(e){this.displayFeatureCount=e;a.setStyle(this.featureFont,"display",e&&this.clusteringEnabled?"block":"none")},_rdoLayerIconChanged:function(e){e&&(this.iconType="LayerIcon");a.setStyle(this.imageIconChooser.domNode,"display",e?"none":"block");a.setStyle(this.customIconPlaceholder,"display",e?"none":"block")},_rdoCustomIconChanged:function(e){e&&(this.iconType="CustomIcon");
a.setStyle(this.imageIconChooser.domNode,"display",e?"block":"none");a.setStyle(this.customIconPlaceholder,"display",e?"block":"none")},_initSymbolPicker:function(e){this.symbolPicker.showByType("point"===e?"marker":"polyline"===e?"line":"polygon"===e?"fill":"")},_initClusterSymbolPicker:function(e){"point"===e&&this.clusterPicker.showByType("fill");f.set(this.parent_div_clusterOptions,"display","point"===e?"block":"none")},_loadLayerSymbol:function(){this.ren=this.infos=void 0;if("undefined"!==typeof this.renderer){var e=
this.renderer,c;if("undefined"!==typeof e.symbol)this._createImageDataDiv(e.symbol,!0,this.layerSym,!0);else if("undefined"!==typeof e.infos)c=e.infos;else if("undefined"!==typeof e.uniqueValueInfos)c=e.uniqueValueInfos;else if("undefined"!==typeof e.classBreakInfos)c=e.classBreakInfos;else if(e.type&&"heatmap"===e.type&&e.colorStops){var e=e.colorStops,h=[];if(e&&1<=e.length){var b=e[0].color,b=C.fromArray([b.r,b.g,b.b]);h.push({symbol:new F(F.STYLE_CIRCLE,10,new K(K.STYLE_SOLID,b),b)});2<e.length&&
(b=e[e.length-1].color,b=C.fromArray([b.r,b.g,b.b]),h.push({symbol:new F(F.STYLE_CIRCLE,10,new K(K.STYLE_SOLID,b),b)}))}this.infos=h;0<h.length?this.layerSym.appendChild(this._createCombinedImageDataDiv(h)):(this._createImageDataDiv2(void 0,44,44,!0,!1),this._createImageDataDiv2(void 0,28,28,!1,!1))}else this.rdoEsriSym.set("checked",!0),this.symbolType="EsriSymbol",this.iconType="LayerIcon",this._initSymbolPicker(G.getTypeByGeometryType(this.geometryType)),this._setFields(this.fields),this._setSymbol(),
this.symbolInfo.symbolType="LayerSymbol",this.symbolInfo.symbolOverride=!0;c&&(this.ren=c,this.layerSym.innerHTML="\x3cdiv\x3e\x3c/div\x3e",this.layerSym.appendChild(this._createCombinedImageDataDiv(c)),a.setStyle(this.layerSym,"cursor","pointer"))}},_createImageDataDiv2:function(e,c,h,a,b){var r;if("string"===typeof e)r=k.create("div",{"class":"imageDataGFX",innerHTML:e}),a?this.panelHTML=r.innerHTML:this.svg=r;else if("undefined"===typeof e)r=k.create("div",{"class":"imageDataGFX"}),r.innerHTML=
"\x3cdiv\x3e\x3c/div\x3e",a?this.panelHTML=r.innerHTML:this.svg=r;else{var v=x.fromJson(e);v||(v=e);v?(e=h,h=c,v.height&&v.width&&(r=v.width/v.height,v.height>v.width?h=c*r:v.width>v.height&&(e=h/r)),"undefined"!==typeof v.setWidth?"undefined"!==typeof v.setHeight?(v.setWidth(b?h-.25*h:h),v.setHeight(b?e-.25*e:e)):v.setWidth(2):"undefined"!==typeof v.size&&20<v.size&&v.setSize(20),r=k.create("div",{"class":"imageDataGFX"}),c=y.createSurface(r,h,e),v=x.getShapeDescriptors(v),c.createShape(v.defaultShape).setFill(v.fill).setStroke(v.stroke).applyTransform({dx:h/
2,dy:e/2}),a?this.panelHTML=r.innerHTML:this.svg=r):"undefined"!==typeof e.url&&(r=k.create("div",{"class":"imageDataGFX"}),f.set(r,"background-image","url("+e.url+")"),f.set(r,"background-repeat","no-repeat"),a?this.panelHTML=r.innerHTML:this.svg=r)}return r},_createImageDataDiv:function(e,c,h,a){h=k.create("div",{"class":"imageDataGFX-display"},h);(c=c?x.fromJson(e):e)||(c=e);this.symbol=c;var b=e=26;c.height&&c.width&&c.height>c.width&&(b=c.width/c.height,e=26,b*=26);var r=y.createSurface(h,b,
e),v=x.getShapeDescriptors(this.setSym(c,b,e));r.createShape(v.defaultShape).setFill(v.fill).setStroke(v.stroke).applyTransform({dx:b/2,dy:e/2});this.svg=h.firstChild;a&&(this.defaultSymbol=c);return h},_createCombinedImageDataDiv:function(c){var e=k.create("div",{"class":"imageDataGFXMulti"},this.customSymbolPlaceholder);this.lyrSymbolSet=[];for(var h=this.symbolInfo&&this.symbolInfo.selectedId?!1:!0,d=0;d<c.length;d++){var t=c[d].symbol,r=x.fromJson(t);r||(r=t);"undefined"===typeof this.symbol&&
(this.symbol=r);this.lyrSymbolSet.push(r);var v=t=26;r.height&&r.width&&r.height>r.width&&(v=r.width/r.height,t=26,v*=26);var g=k.create("div",{"class":"imageDataGFX imageDataGFX2",id:"imageGFX_"+d,onclick:b.hitch(this,this.layerSymbolClick)},e),D=y.createSurface(g,v,t),r=x.getShapeDescriptors(this.setSym(r,v,t));D.createShape(r.defaultShape).setFill(r.fill).setStroke(r.stroke).applyTransform({dx:v/2,dy:t/2});e.insertBefore(g,e.firstChild);e.appendChild(g);if(h||this.symbolInfo&&g.id===this.symbolInfo.selectedId)this.setLayerSymbol(g),
h=!1;D.rawNode&&(a.setStyle(D.rawNode,"display","block"),a.setStyle(D.rawNode,"margin","auto"))}return e},layerSymbolClick:function(c){this.setLayerSymbol(c.currentTarget)},setLayerSymbol:function(c){for(var e,h=0;h<c.parentElement.children.length;h++){var b=c.parentElement.children[h];a.removeClass(b,"lyrSymbolSelected");b.id===c.id&&(e=h)}a.addClass(c,"lyrSymbolSelected");this.selectedID=c.id;this.svg=c;this.panelHTML=c.innerHTML;this.symbol=this.lyrSymbolSet[e]},setSym:function(c,h,a){"undefined"!==
typeof c.setWidth?("esriGeometryPoint"===this.geometryType&&c.setWidth(h),"undefined"!==typeof c.setHeight&&c.setHeight(a)):("undefined"!==typeof c.size&&20<c.size&&c.setSize(20),"undefined"!==typeof c.width&&(c.width=h),"undefined"!==typeof c.height&&(c.height=a));return c},uploadImage:function(c,h){var e="Symbol"===c?this.customSymbolPlaceholder:this.customIconPlaceholder;e.innerHTML="";e.innerHTML=k.create("div",{"class":"customPlaceholder",innerHTML:['\x3cimg class\x3d"customPlaceholder" src\x3d"',
h,'"/\x3e'].join(""),title:"Symbol"===c?this.nls.editCustomSymbol:this.nls.editCustomIcon}).innerHTML},_chkGroupChanged:function(c){this.groupFeaturesEnabled=c;a.setStyle(this.groupByOptions,"display",c?"inline-block":"none")},_rdoGroupByFieldChanged:function(c){this.groupByField=c;this.rdoGroupField.set("checked",c);a.setStyle(this.groupFieldOptions,"display",c?"inline-block":"none")},_rdoGroupByRendererChanged:function(c){this.groupByRenderer=c;this.rdoGroupRenderer.set("checked",c)},destroy:function(){this.symbolInfo=
null;this.tabContainer.destroyRecursive()},_validateSymbolChooserWidthField:function(){return this._validatePointSymbolSize()?this._validatePointOutlineWidth()?this._validateLineWidth()?this._validatePolygonOutlineWidth()?!0:(N.focus(this.symbolPicker.symbolChooser.fillOutlineWidth.focusNode),!1):(N.focus(this.symbolPicker.symbolChooser.lineWidth.focusNode),!1):(N.focus(this.symbolPicker.symbolChooser.pointOutlineWidth.focusNode),!1):(N.focus(this.symbolPicker.symbolChooser.pointSize.focusNode),!1)},
_validatePointSymbolSize:function(){return this.symbolPicker.symbolChooser&&this.symbolPicker.symbolChooser.hasOwnProperty("pointSize")?this.symbolPicker.symbolChooser.pointSize.isValid():!0},_validatePolygonOutlineWidth:function(){return this.symbolPicker.symbolChooser&&this.symbolPicker.symbolChooser.hasOwnProperty("fillOutlineWidth")?this.symbolPicker.symbolChooser.fillOutlineWidth.isValid():!0},_validatePointOutlineWidth:function(){return this.symbolPicker.symbolChooser&&this.symbolPicker.symbolChooser.hasOwnProperty("pointOutlineWidth")?
this.symbolPicker.symbolChooser.pointOutlineWidth.isValid():!0},_validateLineWidth:function(){if(this.symbolPicker.symbolChooser&&this.symbolPicker.symbolChooser.hasOwnProperty("lineWidth"))if(this.symbolPicker.symbolChooser.lineWidth.isValid()){var c=this.symbolPicker.symbolChooser.lineWidth.getValue();if(""===c||null===c||void 0===c||isNaN(c))return this.symbolPicker.symbolChooser.lineWidth.setValue("0"),!1}else return!1;return!0}})})},"jimu/dijit/SymbolPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dijit/TooltipDialog dijit/popup dijit/registry jimu/dijit/SymbolChooser jimu/symbolUtils".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y,g,w,u){return l([q,p,n],{baseClass:"jimu-symbol-picker",declaredClass:"jimu.dijit.SymbolPicker",templateString:'\x3cdiv\x3e\x3cdiv data-dojo-attach-point\x3d"symbolNode" class\x3d"symbol-node jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"separator jimu-float-leading"\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8 jimu-float-leading"\x3e\x3c/div\x3e\x3c/div\x3e',tooltipDialog:null,_isTooltipDialogOpened:!1,symbol:null,type:null,cropImage:!1,
customZIndex:null,postCreate:function(){this.inherited(arguments);this._createTooltipDialog();this._hideTooltipDialog();var a=this.symbolChooser.getSymbol();a&&this._drawSymbol(a)},destroy:function(){this._hideTooltipDialog();this.symbolChooser&&this.symbolChooser.destroy();this.symbolChooser=null;this.inherited(arguments)},_createTooltipDialog:function(){var d=a.create("div");this.tooltipDialog=new m({content:d});this.symbolChooser=new w({cropImage:this.cropImage,customZIndex:this.customZIndex,symbol:this.symbol,
type:this.type});this.symbolChooser.placeAt(d);this.symbolChooser.startup();this.own(k(this.symbolChooser,"change",b.hitch(this,function(a){this._drawSymbol(a);this.emit("change",a)})));this.own(k(this.domNode,"click",b.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(k(document.body,"click",b.hitch(this,function(b){var d=b.target||b.srcElement;b=this._getColorPickers();if(!(0<b.length&&f.some(b,
function(a){return a.isPartOfPopup(d)})))if(b=this.tooltipDialog.domNode,b=d===b||a.isDescendant(d,b),this.cropImage&&this.symbolChooser._isCustomImageOptionSelected()){var g=this.symbolChooser.imageChooser,t=g.msgPopupOpen;g.cropPopupOpen||t||b||this._hideTooltipDialog();g.cropPopup&&g.cropPopup.domNode||(g.cropPopupOpen=!1);g.msgPopup&&g.msgPopup.domNode||(g.msgPopupOpen=!1)}else b||this._hideTooltipDialog()})));this.own(k(this.symbolChooser,"resize",b.hitch(this,function(){this._isTooltipDialogOpened&&
(this._hideTooltipDialog(),this._showTooltipDialog())})))},_getColorPickers:function(){var a=d(".jimu-color-picker",this.symbolChooser.domNode);return f.map(a,b.hitch(this,function(a){return g.byNode(a)}))},reset:function(){this.symbol=this.type=null;a.empty(this.symbolNode);this.symbolChooser.reset()},showBySymbol:function(a){this.reset();a&&(this._drawSymbol(a),this.symbolChooser.showBySymbol(a))},showByType:function(a){this.reset();this.symbolChooser.showByType(a);(a=this.symbolChooser.getSymbol())&&
this._drawSymbol(a)},getSymbol:function(){return this.symbolChooser.getSymbol()},_drawSymbol:function(b){a.empty(this.symbolNode);b&&(b=u.createSymbolNode(b,{width:16,height:16}))&&a.place(b,this.symbolNode)},_showTooltipDialog:function(){this.tooltipDialog&&(y.open({parent:this.getParent(),popup:this.tooltipDialog,around:this.domNode}),this._isTooltipDialogOpened=!0)},_hideTooltipDialog:function(){this.tooltipDialog&&(y.close(this.tooltipDialog),this._isTooltipDialogOpened=!1)}})})},"dojox/form/FileUploader":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/window dojo/_base/sniff dojo/query dojo/dom dojo/dom-style dojo/dom-geometry dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-form dojo/_base/config dijit/_base/manager dojo/io/iframe dojo/_base/Color dojo/_base/unload dijit/_Widget dijit/_TemplatedMixin dijit/_Contained dojox/embed/Flash dojox/embed/flashVars dojox/html/styles".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y,g,w,u,x,t,C,L,A,I,G,z,H,O,B,E){l.deprecated("dojox.form.FileUploader","Use dojox.form.Uploader","2.0");return q("dojox.form.FileUploader",[G,z,H],{swfPath:t.uploaderPath||require.toUrl("dojox/form/resources/fileuploader.swf"),templateString:'\x3cdiv\x3e\x3cdiv dojoAttachPoint\x3d"progNode"\x3e\x3cdiv dojoAttachPoint\x3d"progTextNode"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv dojoAttachPoint\x3d"insideNode" class\x3d"uploaderInsideNode"\x3e\x3c/div\x3e\x3c/div\x3e',uploadUrl:"",
isDebug:!1,devMode:!1,baseClass:"dojoxUploaderNorm",hoverClass:"dojoxUploaderHover",activeClass:"dojoxUploaderActive",disabledClass:"dojoxUploaderDisabled",force:"",uploaderType:"",flashObject:null,flashMovie:null,insideNode:null,deferredUploading:1,fileListId:"",uploadOnChange:!1,selectMultipleFiles:!0,htmlFieldName:"uploadedfile",flashFieldName:"flashUploadFiles",fileMask:null,minFlashVersion:9,tabIndex:-1,showProgress:!1,progressMessage:"Loading",progressBackgroundUrl:require.toUrl("dijit/themes/tundra/images/buttonActive.png"),
progressBackgroundColor:"#ededed",progressWidgetId:"",skipServerCheck:!1,serverTimeout:5E3,log:function(){this.isDebug&&console.log(Array.prototype.slice.call(arguments).join(" "))},constructor:function(){this._subs=[]},postMixInProperties:function(){this.fileList=[];this._cons=[];this.fileMask=this.fileMask||[];this.fileInputs=[];this.fileCount=0;this._disabled=this.flashReady=!1;this.force=this.force.toLowerCase();this.uploaderType=(O.available>=this.minFlashVersion||"flash"==this.force)&&"html"!=
this.force?"flash":"html";this.deferredUploading=!0===this.deferredUploading?1:this.deferredUploading;this._refNode=this.srcNodeRef;this.getButtonStyle()},startup:function(){},postCreate:function(){this.inherited(arguments);this.setButtonStyle();var c;"flash"==this.uploaderType?c="createFlashUploader":(this.uploaderType="html",c="createHtmlUploader");this[c]();this.fileListId&&this.connect(d.byId(this.fileListId),"click",function(c){c=c.target.parentNode.parentNode.parentNode;c.id&&-1<c.id.indexOf("file_")&&
this.removeFile(c.id.split("file_")[1])});I.addOnUnload(this,this.destroy)},getHiddenNode:function(c){if(!c)return null;var a=null;for(c=c.parentNode;c&&"body"!=c.tagName.toLowerCase();){if("none"==m.get(c,"display")){a=c;break}c=c.parentNode}return a},getButtonStyle:function(){var c=this.srcNodeRef;(this._hiddenNode=this.getHiddenNode(c))&&m.set(this._hiddenNode,"display","block");if(!c&&this.button&&this.button.domNode){var a=!0,c=this.button.domNode.className+" dijitButtonNode",b=this.getText(k(".dijitButtonText",
this.button.domNode)[0]);this.srcNodeRef=c=u.place('\x3cbutton id\x3d"'+this.button.id+'" class\x3d"'+c+'"\x3e'+b+"\x3c/button\x3e",this.button.domNode,"after");this.button.destroy();this.baseClass="dijitButton";this.hoverClass="dijitButtonHover";this.pressClass="dijitButtonActive";this.disabledClass="dijitButtonDisabled"}else!this.srcNodeRef&&this.button&&(c=this.button);g.get(c,"class")&&(this.baseClass+=" "+g.get(c,"class"));g.set(c,"class",this.baseClass);this.norm=this.getStyle(c);this.width=
this.norm.w;this.height=this.norm.h;"flash"==this.uploaderType?(this.over=this.getTempNodeStyle(c,this.baseClass+" "+this.hoverClass,a),this.down=this.getTempNodeStyle(c,this.baseClass+" "+this.activeClass,a),this.dsbl=this.getTempNodeStyle(c,this.baseClass+" "+this.disabledClass,a),this.fhtml={cn:this.getText(c),nr:this.norm,ov:this.over,dn:this.down,ds:this.dsbl}):(this.fhtml={cn:this.getText(c),nr:this.norm},"middle"==this.norm.va&&(this.norm.lh=this.norm.h));this.devMode&&(this.log("classes - base:",
this.baseClass," hover:",this.hoverClass,"active:",this.activeClass),this.log("fhtml:",this.fhtml),this.log("norm:",this.norm),this.log("over:",this.over),this.log("down:",this.down))},setButtonStyle:function(){m.set(this.domNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+"px",padding:"0px",lineHeight:"normal",position:"relative"});"html"==this.uploaderType&&"middle"==this.norm.va&&m.set(this.domNode,"lineHeight",this.norm.lh+"px");this.showProgress?(this.progTextNode.innerHTML=this.progressMessage,
m.set(this.progTextNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",lineHeight:this.fhtml.nr.h+0+"px",position:"absolute"}),m.set(this.progNode,{width:this.fhtml.nr.w+"px",height:this.fhtml.nr.h+0+"px",padding:"0px",margin:"0px",left:"0px",position:"absolute",display:"none",backgroundImage:"url("+this.progressBackgroundUrl+")",backgroundPosition:"bottom",backgroundRepeat:"repeat-x",backgroundColor:this.progressBackgroundColor})):u.destroy(this.progNode);
m.set(this.insideNode,{position:"absolute",top:"0px",left:"0px",display:""});w.add(this.domNode,this.srcNodeRef.className);-1<this.fhtml.nr.d.indexOf("inline")&&w.add(this.domNode,"dijitInline");try{this.insideNode.innerHTML=this.fhtml.cn}catch(F){if("flash"==this.uploaderType){this.insideNode=this.insideNode.parentNode.removeChild(this.insideNode);a.body().appendChild(this.insideNode);this.insideNode.innerHTML=this.fhtml.cn;var c=b.connect(this,"onReady",this,function(){b.disconnect(c);this.insideNode=
this.insideNode.parentNode.removeChild(this.insideNode);this.domNode.appendChild(this.insideNode)})}else this.insideNode.appendChild(document.createTextNode(this.fhtml.cn))}this._hiddenNode&&m.set(this._hiddenNode,"display","none")},onChange:function(c){},onProgress:function(c){},onComplete:function(c){},onCancel:function(){},onError:function(c){},onReady:function(c){},onLoad:function(c){},submit:function(c){c=c?x.toObject(c):null;this.upload(c);return!1},upload:function(c){if(!this.fileList.length)return!1;
if(!this.uploadUrl)return console.warn("uploadUrl not provided. Aborting."),!1;this.showProgress||this.set("disabled",!0);if(this.progressWidgetId){var a=C.byId(this.progressWidgetId).domNode;"none"==m.get(a,"display")&&(this.restoreProgDisplay="none",m.set(a,"display","block"));"hidden"==m.get(a,"visibility")&&(this.restoreProgDisplay="hidden",m.set(a,"visibility","visible"))}c&&!c.target&&(this.postData=c);this.log("upload type:",this.uploaderType," - postData:",this.postData);for(c=0;c<this.fileList.length;c++)a=
this.fileList[c],a.bytesLoaded=0,a.bytesTotal=a.size||1E5,a.percent=0;"flash"==this.uploaderType?this.uploadFlash():this.uploadHTML();return!1},removeFile:function(c,a){var b;for(b=0;b<this.fileList.length;b++)if(this.fileList[b].name==c){a||this.fileList.splice(b,1);break}"flash"==this.uploaderType?this.flashMovie.removeFile(c):a||(u.destroy(this.fileInputs[b]),this.fileInputs.splice(b,1),this._renumberInputs());this.fileListId&&u.destroy("file_"+c)},destroy:function(){"flash"!=this.uploaderType||
this.flashMovie?(n.forEach(this._subs,b.unsubscribe,dojo),n.forEach(this._cons,b.disconnect,dojo),this.scrollConnect&&b.disconnect(this.scrollConnect),"flash"==this.uploaderType?(this.flashObject.destroy(),delete this.flashObject):(u.destroy(this._fileInput),u.destroy(this._formNode)),this.inherited(arguments)):this._cons.push(b.connect(this,"onLoad",this,"destroy"))},_displayProgress:function(c){!0===c?("flash"==this.uploaderType?m.set(this.insideNode,"top","-2500px"):m.set(this.insideNode,"display",
"none"),m.set(this.progNode,"display","")):!1===c?(m.set(this.insideNode,{display:"",top:"0"}),m.set(this.progNode,"display","none")):m.set(this.progNode,"width",c*this.fhtml.nr.w+"px")},_animateProgress:function(){this._displayProgress(!0);var c=!1,a=b.connect(this,"_complete",function(){b.disconnect(a);c=!0}),d=0,g=setInterval(p.hitch(this,function(){d+=5;d>this.fhtml.nr.w&&(d=0,c=!0);this._displayProgress(d/this.fhtml.nr.w);c&&(clearInterval(g),setTimeout(p.hitch(this,function(){this._displayProgress(!1)}),
500))}),50)},_error:function(c){"string"==typeof c&&(c=Error(c));this.onError(c)},_addToFileList:function(){if(this.fileListId){var c="";n.forEach(this.fileList,function(a){c+='\x3ctable id\x3d"file_'+a.name+'" class\x3d"fileToUpload"\x3e\x3ctr\x3e\x3ctd class\x3d"fileToUploadClose"\x3e\x3c/td\x3e\x3ctd class\x3d"fileToUploadName"\x3e'+a.name+'\x3c/td\x3e\x3ctd class\x3d"fileToUploadSize"\x3e'+(a.size?Math.ceil(.001*a.size)+"kb":"")+"\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e"},this);d.byId(this.fileListId).innerHTML=
c}},_change:function(c){f("ie")&&n.forEach(c,function(c){c.name=c.name.split("\\")[c.name.split("\\").length-1]});this.selectMultipleFiles?this.fileList=this.fileList.concat(c):(this.fileList[0]&&this.removeFile(this.fileList[0].name,!0),this.fileList=c);this._addToFileList();this.onChange(c);this.uploadOnChange?("html"==this.uploaderType&&this._buildFileInput(),this.upload()):"html"==this.uploaderType&&this.selectMultipleFiles&&(this._buildFileInput(),this._connectInput())},_complete:function(c){c=
p.isArray(c)?c:[c];n.forEach(c,function(c){c.ERROR&&this._error(c.ERROR)},this);n.forEach(this.fileList,function(c){c.bytesLoaded=1;c.bytesTotal=1;c.percent=100;this._progress(c)},this);n.forEach(this.fileList,function(c){this.removeFile(c.name,!0)},this);this.onComplete(c);this.fileList=[];this._resetHTML();this.set("disabled",!1);this.restoreProgDisplay&&setTimeout(p.hitch(this,function(){m.set(C.byId(this.progressWidgetId).domNode,"none"==this.restoreProgDisplay?"display":"visibility",this.restoreProgDisplay)}),
500)},_progress:function(c){for(var a=0,b=0,d=0;d<this.fileList.length;d++){var h=this.fileList[d];h.name==c.name&&(h.bytesLoaded=c.bytesLoaded,h.bytesTotal=c.bytesTotal,h.percent=Math.ceil(h.bytesLoaded/h.bytesTotal*100),this.log(h.name,"percent:",h.percent));b+=Math.ceil(.001*h.bytesLoaded);a+=Math.ceil(.001*h.bytesTotal)}c=Math.ceil(b/a*100);this.progressWidgetId&&C.byId(this.progressWidgetId).update({progress:c+"%"});this.showProgress&&this._displayProgress(.01*c);this.onProgress(this.fileList)},
_getDisabledAttr:function(){return this._disabled},_setDisabledAttr:function(c){if(this._disabled!=c){if("flash"==this.uploaderType){if(!this.flashReady){var a=b.connect(this,"onLoad",this,function(){b.disconnect(a);this._setDisabledAttr(c)});return}this._disabled=c;this.flashMovie.doDisable(c)}else this._disabled=c,m.set(this._fileInput,"display",this._disabled?"none":"");w.toggle(this.domNode,this.disabledClass,c)}},_onFlashBlur:function(){this.flashMovie.blur();if(!this.nextFocusObject&&this.tabIndex)for(var c=
k("[tabIndex]"),a=0;a<c.length;a++)if(c[a].tabIndex>=Number(this.tabIndex)+1){this.nextFocusObject=c[a];break}this.nextFocusObject.focus()},_disconnect:function(){n.forEach(this._cons,b.disconnect,dojo)},uploadHTML:function(){this.selectMultipleFiles&&u.destroy(this._fileInput);this._setHtmlPostData();this.showProgress&&this._animateProgress();L.send({url:this.uploadUrl.toString(),form:this._formNode,handleAs:"json",error:p.hitch(this,function(c){this._error("HTML Upload Error:"+c.message)}),load:p.hitch(this,
function(c,a,b){this._complete(c)})})},createHtmlUploader:function(){this._buildForm();this._setFormStyle();this._buildFileInput();this._connectInput();this._styleContent();m.set(this.insideNode,"visibility","visible");this.onReady()},_connectInput:function(){this._disconnect();this._cons.push(b.connect(this._fileInput,"mouseover",this,function(c){w.add(this.domNode,this.hoverClass);this.onMouseOver(c)}));this._cons.push(b.connect(this._fileInput,"mouseout",this,function(c){setTimeout(p.hitch(this,
function(){w.remove(this.domNode,this.activeClass);w.remove(this.domNode,this.hoverClass);this.onMouseOut(c);this._checkHtmlCancel("off")}),0)}));this._cons.push(b.connect(this._fileInput,"mousedown",this,function(c){w.add(this.domNode,this.activeClass);w.remove(this.domNode,this.hoverClass);this.onMouseDown(c)}));this._cons.push(b.connect(this._fileInput,"mouseup",this,function(c){w.remove(this.domNode,this.activeClass);this.onMouseUp(c);this.onClick(c);this._checkHtmlCancel("up")}));this._cons.push(b.connect(this._fileInput,
"change",this,function(){this._checkHtmlCancel("change");var c=this._fileInput.value;c?this._change([{name:c,type:"",size:0}]):this._change([])}));0<=this.tabIndex&&g.set(this.domNode,"tabIndex",this.tabIndex)},_checkHtmlCancel:function(c){"change"==c&&(this.dialogIsOpen=!1);"up"==c&&(this.dialogIsOpen=!0);if("off"==c){if(this.dialogIsOpen)this.onCancel();this.dialogIsOpen=!1}},_styleContent:function(){var c=this.fhtml.nr;m.set(this.insideNode,{width:c.w+"px",height:"middle"==c.va?c.h+"px":"auto",
textAlign:c.ta,paddingTop:c.p[0]+"px",paddingRight:c.p[1]+"px",paddingBottom:c.p[2]+"px",paddingLeft:c.p[3]+"px"});try{m.set(this.insideNode,"lineHeight","inherit")}catch(F){}},_resetHTML:function(){"html"==this.uploaderType&&this._formNode&&(this.fileInputs=[],k("*",this._formNode).forEach(function(c){u.destroy(c)}),this.fileCount=0,this._buildFileInput(),this._connectInput())},_buildForm:function(){this._formNode||(9>f("ie")||f("ie")&&f("quirks")?(this._formNode=document.createElement('\x3cform enctype\x3d"multipart/form-data" method\x3d"post"\x3e'),
this._formNode.encoding="multipart/form-data",this._formNode.id=C.getUniqueId("FileUploaderForm"),this.domNode.appendChild(this._formNode)):this._formNode=u.create("form",{enctype:"multipart/form-data",method:"post",id:C.getUniqueId("FileUploaderForm")},this.domNode))},_buildFileInput:function(){this._fileInput&&(this._disconnect(),this._fileInput.id+=this.fileCount,m.set(this._fileInput,"display","none"));this._fileInput=document.createElement("input");this.fileInputs.push(this._fileInput);var c=
this.htmlFieldName;this.selectMultipleFiles&&(c+=this.fileCount,this.fileCount++);g.set(this._fileInput,{id:this.id,name:c,type:"file"});w.add(this._fileInput,"dijitFileInputReal");this._formNode.appendChild(this._fileInput);c=y.getMarginBox(this._fileInput);m.set(this._fileInput,{position:"relative",left:this.fhtml.nr.w-c.w+"px",opacity:0})},_renumberInputs:function(){if(this.selectMultipleFiles){var c;this.fileCount=0;n.forEach(this.fileInputs,function(a){c=this.htmlFieldName+this.fileCount;this.fileCount++;
g.set(a,"name",c)},this)}},_setFormStyle:function(){E.insertCssRule("#"+this._formNode.id+" input","font-size:"+Math.max(2,Math.max(Math.ceil(this.fhtml.nr.w/60),Math.ceil(this.fhtml.nr.h/15)))+"em");m.set(this.domNode,{overflow:"hidden",position:"relative"});m.set(this.insideNode,"position","absolute")},_setHtmlPostData:function(){if(this.postData)for(var c in this.postData)u.create("input",{type:"hidden",name:c,value:this.postData[c]},this._formNode)},uploadFlash:function(){try{if(this.showProgress){this._displayProgress(!0);
var c=b.connect(this,"_complete",this,function(){b.disconnect(c);this._displayProgress(!1)})}var a={},d;for(d in this.postData)a[d]=this.postData[d];this.flashMovie.doUpload(a)}catch(M){this._error("FileUploader - Sorry, the SWF failed to initialize."+M)}},createFlashUploader:function(){if(this.uploadUrl=this.uploadUrl.toString())if(0>this.uploadUrl.toLowerCase().indexOf("http")&&0!=this.uploadUrl.indexOf("/")){var c=window.location.href.split("/");c.pop();c=c.join("/")+"/";this.uploadUrl=c+this.uploadUrl;
this.log("SWF Fixed - Relative loc:",c," abs loc:",this.uploadUrl)}else this.log("SWF URL unmodified:",this.uploadUrl);else console.warn("Warning: no uploadUrl provided.");c={expressInstall:!0,path:this.swfPath.uri||this.swfPath,width:this.fhtml.nr.w,height:this.fhtml.nr.h,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName,uploadUrl:this.uploadUrl,uploadOnSelect:this.uploadOnChange,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.selectMultipleFiles,
id:this.id,isDebug:this.isDebug,devMode:this.devMode,flashButton:B.serialize("fh",this.fhtml),fileMask:B.serialize("fm",this.fileMask),noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new O(c,this.insideNode);this.flashObject.onError=p.hitch(function(c){this._error("Flash Error: "+c)});this.flashObject.onReady=p.hitch(this,function(){m.set(this.insideNode,"visibility","visible");
this.log("FileUploader flash object ready");this.onReady(this)});this.flashObject.onLoad=p.hitch(this,function(c){this.flashMovie=c;this.flashReady=!0;this.onLoad(this)});this._connectFlash()},_connectFlash:function(){this._doSub("/filesSelected","_change");this._doSub("/filesUploaded","_complete");this._doSub("/filesProgress","_progress");this._doSub("/filesError","_error");this._doSub("/filesCanceled","onCancel");this._doSub("/stageBlur","_onFlashBlur");this._doSub("/up","onMouseUp");this._doSub("/down",
"onMouseDown");this._doSub("/over","onMouseOver");this._doSub("/out","onMouseOut");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus()});0<=this.tabIndex&&g.set(this.domNode,"tabIndex",this.tabIndex)},_doSub:function(c,a){this._subs.push(b.subscribe(this.id+c,this,a))},urlencode:function(c){return c&&"none"!=c?c.replace(/:/g,"||").replace(/\./g,"^^").replace("url(","").replace(")","").replace(/'/g,"").replace(/"/g,""):!1},isButton:function(c){c=c.tagName.toLowerCase();
return"button"==c||"input"==c},getTextStyle:function(c){var a={};a.ff=m.get(c,"fontFamily");if(a.ff){a.ff=a.ff.replace(", ",",");a.ff=a.ff.replace(/\"|\'/g,"");a.ff="sans-serif"==a.ff?"Arial":a.ff;a.fw=m.get(c,"fontWeight");a.fi=m.get(c,"fontStyle");a.fs=parseInt(m.get(c,"fontSize"),10);if(-1<m.get(c,"fontSize").indexOf("%"))for(var b=c;b.tagName;){if(-1==m.get(b,"fontSize").indexOf("%")){a.fs=parseInt(m.get(b,"fontSize"),10);break}"body"==b.tagName.toLowerCase()&&(a.fs=.16*parseInt(m.get(b,"fontSize"),
10));b=b.parentNode}a.fc=(new A(m.get(c,"color"))).toHex();a.fc=parseInt(a.fc.substring(1,Infinity),16)}a.lh=m.get(c,"lineHeight");a.ta=m.get(c,"textAlign");a.ta="start"!=a.ta&&a.ta?a.ta:"left";a.va=this.isButton(c)?"middle":a.lh==a.h?"middle":m.get(c,"verticalAlign");return a},getText:function(c){c=p.trim(c.innerHTML);-1<c.indexOf("\x3c")&&(c=escape(c));return c},getStyle:function(c){var a={},b=y.getContentBox(c),d=y.getPadExtents(c);a.p=[d.t,d.w-d.l,d.h-d.t,d.l];a.w=b.w+d.w;a.h=b.h+d.h;a.d=m.get(c,
"display");b=new A(m.get(c,"backgroundColor"));a.bc=0==b.a?"#ffffff":b.toHex();a.bc=parseInt(a.bc.substring(1,Infinity),16);if(b=this.urlencode(m.get(c,"backgroundImage")))a.bi={url:b,rp:m.get(c,"backgroundRepeat"),pos:escape(m.get(c,"backgroundPosition"))},a.bi.pos||(b=m.get(c,"backgroundPositionX"),d=m.get(c,"backgroundPositionY"),a.bi.pos=escape(("left"==b?"0%":"right"==b?"100%":b)+" "+("top"==d?"0%":"bottom"==d?"100%":d)));return p.mixin(a,this.getTextStyle(c))},getTempNodeStyle:function(c,a,
b){if(b){b=u.place("\x3c"+c.tagName+"\x3e\x3cspan\x3e"+c.innerHTML+"\x3c/span\x3e\x3c/"+c.tagName+"\x3e",c.parentNode);var d=b.firstChild;w.add(d,c.className);w.add(b,a);c=this.getStyle(d)}else b=u.place("\x3c"+c.tagName+"\x3e"+c.innerHTML+"\x3c/"+c.tagName+"\x3e",c.parentNode),w.add(b,c.className),w.add(b,a),b.id=c.id,c=this.getStyle(b);u.destroy(b);return c}})})},"dojo/io/iframe":function(){define("../_base/config ../_base/json ../_base/kernel ../_base/lang ../_base/xhr ../sniff ../_base/window ../dom ../dom-construct ../query require ../aspect ../request/iframe".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y,g,w){p.deprecated("dojo/io/iframe","Use dojo/request/iframe.","2.0");a=w._iframeName;a=a.substring(0,a.lastIndexOf("_"));var u=n.delegate(w,{create:function(){return u._frame=w.create.apply(w,arguments)},get:null,post:null,send:function(a){var d,m=b._ioSetArgs(a,function(a){d&&d.cancel()},function(a){var b=null;a=a.ioArgs;try{var g=a.handleAs;"xml"===g||"html"===g?b=d.response.data:(b=d.response.text,"json"===g?b=q.fromJson(b):"javascript"===g&&(b=p.eval(b)))}catch(B){b=
B}return b},function(a,b){b.ioArgs._hasError=!0;return a}),f=m.ioArgs,u="GET",I=k.byId(a.form);a.method&&"POST"===a.method.toUpperCase()&&I&&(u="POST");a={method:u,handleAs:"json"===a.handleAs||"javascript"===a.handleAs?"text":a.handleAs,form:a.form,query:I?null:a.content,data:I?a.content:null,timeout:a.timeout,ioArgs:f};a.method&&(a.method=a.method.toUpperCase());if(l.ioPublish&&p.publish&&!1!==f.args.ioPublish)var G=g.after(w,"_notifyStart",function(a){a.options.ioArgs===f&&(G.remove(),b._ioNotifyStart(m))},
!0);d=w(f.url,a,!0);f._callNext=d._callNext;d.then(function(){m.resolve(m)}).otherwise(function(a){m.ioArgs.error=a;m.reject(a)});return m},_iframeOnload:f.global[a+"_onload"]});n.setObject("dojo.io.iframe",u);return u})},"dojox/embed/Flash":function(){define("dojo/_base/lang dojo/_base/unload dojo/_base/array dojo/query dojo/has dojo/dom dojo/on dojo/window dojo/string".split(" "),function(l,q,p,n,b,a,f,k,d){function m(a){a=l.delegate(u,a);if(!("path"in a))return console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided."),
null;"id"in a||(a.id="dojox-embed-flash-"+w++);return a}var y,g,w=0,u={expressInstall:!1,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};b("ie")?(y=function(a){a=m(a);if(!a)return null;var b,g=a.path;if(a.vars){var t=[];for(b in a.vars)t.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(a.vars[b]));a.params.FlashVars=t.join("\x26");delete a.vars}g='\x3cobject id\x3d"'+d.escape(String(a.id))+'" classid\x3d"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width\x3d"'+
d.escape(String(a.width))+'" height\x3d"'+d.escape(String(a.height))+'"'+(a.style?' style\x3d"'+d.escape(String(a.style))+'"':"")+'\x3e\x3cparam name\x3d"movie" value\x3d"'+d.escape(String(g))+'" /\x3e';if(a.params)for(b in a.params)g+='\x3cparam name\x3d"'+d.escape(b)+'" value\x3d"'+d.escape(String(a.params[b]))+'" /\x3e';return{id:a.id,markup:g+"\x3c/object\x3e"}},g=function(){for(var a=10,b=null;!b&&7<a;)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a--)}catch(L){}return b?(a=b.GetVariable("$version").split(" ")[1].split(","),
{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}(),q.addOnWindowUnload(function(){console.warn("***************UNLOAD");var a=function(){};n("object").reverse().style("display","none").forEach(function(b){for(var d in b)if("FlashVars"!=d&&"function"==typeof b[d])try{b[d]=a}catch(A){}})})):(y=function(a){a=m(a);if(!a)return null;var b,g=a.path;if(a.vars){var f=[];for(b in a.vars)f.push(encodeURIComponent(b)+"\x3d"+encodeURIComponent(a.vars[b]));
a.params.flashVars=f.join("\x26");delete a.vars}g='\x3cembed type\x3d"application/x-shockwave-flash" src\x3d"'+d.escape(String(g))+'" id\x3d"'+d.escape(String(a.id))+'" width\x3d"'+d.escape(String(a.width))+'" height\x3d"'+d.escape(String(a.height))+'"'+(a.style?' style\x3d"'+d.escape(String(a.style))+'" ':"")+'pluginspage\x3d"'+window.location.protocol+'//www.adobe.com/go/getflashplayer" ';if(a.params)for(b in a.params)g+=" "+d.escape(b)+'\x3d"'+d.escape(String(a.params[b]))+'"';return{id:a.id,markup:g+
" /\x3e"}},g=function(){var a=navigator.plugins["Shockwave Flash"];return a&&a.description?(a=a.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."),{major:null!=a[0]?parseInt(a[0]):0,minor:null!=a[1]?parseInt(a[1]):0,rev:null!=a[2]?parseInt(a[2]):0}):{major:0,minor:0,rev:0}}());var x=function(b,d){if(-1<location.href.toLowerCase().indexOf("file://"))throw Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");
this.available=g.major;this.minimumVersion=b.minimumVersion||9;this.domNode=this.movie=this.id=null;d&&(d=a.byId(d));setTimeout(l.hitch(this,function(){if(b.expressInstall||this.available&&this.available>=this.minimumVersion)if(b&&d)this.init(b,d);else this.onError("embed.Flash was not provided with the proper arguments.");else if(this.available)this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);else this.onError("Flash is not installed.")}),
100)};l.extend(x,{onReady:function(a){},onLoad:function(a){},onError:function(a){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie)},init:function(b,d){this.destroy();d=a.byId(d||this.domNode);if(!d)throw Error("dojox.embed.Flash: no domNode reference has been passed.");var g=0;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;x.initialized&&(this.id=x.place(b,d),this.domNode=d,setTimeout(l.hitch(this,
function(){this.movie=this.byId(this.id,b.doc);this.onReady(this.movie);this._poller=setInterval(l.hitch(this,function(){try{g=this.movie.PercentLoaded()}catch(A){console.warn("this.movie.PercentLoaded() failed",A,this.movie)}if(100==g)this._onload();else if(0==g&&this._pollCount++>this._pollMax)throw clearInterval(this._poller),Error("Building SWF failed.");}),this.pollTime)}),1))},_destroy:function(){try{this.domNode.removeChild(this.movie)}catch(t){}this.id=this.movie=this.domNode=null},destroy:function(){if(this.movie){var a=
l.delegate({id:!0,movie:!0,domNode:!0,onReady:!0,onLoad:!0}),b;for(b in this)a[b]||delete this[b];this._poller?f(this,"Load",this,"_destroy"):this._destroy()}},byId:function(a,b){b=b||document;return b.embeds[a]?b.embeds[a]:b[a]?b[a]:window[a]?window[a]:document[a]?document[a]:null}});l.mixin(x,{minSupported:8,available:g.major,supported:g.major>=g.required,minimumRequired:g.required,version:g,initialized:!1,onInitialize:function(){x.initialized=!0},__ie_markup__:function(a){return y(a)},proxy:function(a,
b){p.forEach(b instanceof Array?b:[b],function(a){this[a]=l.hitch(this,function(){return function(){return eval(this.movie.CallFunction('\x3cinvoke name\x3d"'+a+'" returntype\x3d"javascript"\x3e\x3carguments\x3e'+p.map(arguments,function(a){return __flash__toXML(a)}).join("")+"\x3c/arguments\x3e\x3c/invoke\x3e"))}.apply(this,arguments||[])})},a)}});x.place=function(b,d){b=y(b);d=a.byId(d);d||(d=k.doc.createElement("div"),d.id=b.id+"-container",k.body().appendChild(d));return b?(d.innerHTML=b.markup,
b.id):null};x.onInitialize();l.setObject("dojox.embed.Flash",x);return x})},"dojox/embed/flashVars":function(){define(["dojo"],function(l){l.deprecated("dojox.embed.flashVars","Will be removed in 2.0","2.0");var q={serialize:function(p,n){var b=function(a){"string"==typeof a&&(a=a.replace(/;/g,"_sc_"),a=a.replace(/\./g,"_pr_"),a=a.replace(/\:/g,"_cl_"));return a},a=dojox.embed.flashVars.serialize,f="";if(l.isArray(n)){for(var k=0;k<n.length;k++)f+=a(p+"."+k,b(n[k]))+";";return f.replace(/;{2,}/g,
";")}if(l.isObject(n)){for(k in n)f+=a(p+"."+k,b(n[k]))+";";return f.replace(/;{2,}/g,";")}return p+":"+n}};l.setObject("dojox.embed.flashVars",q);return q})},"dojox/html/styles":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(l,q,p,n){var b=l.getObject("dojox.html",!0),a={},f={},k=[];b.insertCssRule=function(a,m,f){f=b.getDynamicStyleSheet(f);var d=a+" {"+m+"}";console.log("insertRule:",d);n("ie")?(f.cssText+=d,console.log("ss.cssText:",f.cssText)):
f.sheet?f.sheet.insertRule(d,f._indicies.length):f.appendChild(p.doc.createTextNode(d));f._indicies.push(a+" "+m);return a};b.removeCssRule=function(b,m,f){var d,k=-1,u,l;for(u in a)if(!f||f===u){d=a[u];for(l=0;l<d._indicies.length;l++)if(b+" "+m===d._indicies[l]){k=l;break}if(-1<k)break}if(!d)return console.warn("No dynamic style sheet has been created from which to remove a rule."),!1;if(-1===k)return console.warn("The css rule was not found and could not be removed."),!1;d._indicies.splice(k,1);
n("ie")?d.removeRule(k):d.sheet&&d.sheet.deleteRule(k);return!0};b.modifyCssRule=function(a,b,f){};b.getStyleSheet=function(d){if(a[d||"default"])return a[d||"default"];if(!d)return!1;var f=b.getStyleSheets();if(f[d])return b.getStyleSheets()[d];for(var k in f)if(f[k].href&&-1<f[k].href.indexOf(d))return f[k];return!1};b.getDynamicStyleSheet=function(b){b||(b="default");a[b]||(p.doc.createStyleSheet?(a[b]=p.doc.createStyleSheet(),9>n("ie")&&(a[b].title=b)):(a[b]=p.doc.createElement("style"),a[b].setAttribute("type",
"text/css"),p.doc.getElementsByTagName("head")[0].appendChild(a[b]),console.log(b," ss created: ",a[b].sheet)),a[b]._indicies=[]);return a[b]};b.enableStyleSheet=function(a){if(a=b.getStyleSheet(a))a.sheet?a.sheet.disabled=!1:a.disabled=!1};b.disableStyleSheet=function(a){if(a=b.getStyleSheet(a))a.sheet?a.sheet.disabled=!0:a.disabled=!0};b.activeStyleSheet=function(a){var d=b.getToggledStyleSheets(),f;if(1===arguments.length)q.forEach(d,function(b){b.disabled=b.title===a?!1:!0});else for(f=0;f<d.length;f++)if(!1===
d[f].disabled)return d[f];return!0};b.getPreferredStyleSheet=function(){};b.getToggledStyleSheets=function(){var a;if(!k.length){var f=b.getStyleSheets();for(a in f)f[a].title&&k.push(f[a])}return k};b.getStyleSheets=function(){if(f.collected)return f;q.forEach(p.doc.styleSheets,function(a){var b=a.sheet?a.sheet:a;a=b.title||b.href;if(n("ie"))-1===b.cssText.indexOf("#default#VML")&&(b.href?f[a]=b:b.imports.length?q.forEach(b.imports,function(a){f[a.title||a.href]=a}):f[a]=b);else{f[a]=b;f[a].id=b.ownerNode.id;
a=[];try{a=b[b.cssRules?"cssRules":"rules"]}catch(y){console.warn("Reading css rules from stylesheet "+b.href+" is forbidden due to same-origin policy. See http://www.w3.org/TR/CSP/#cascading-style-sheet-css-parsing",b)}q.forEach(a,function(a){a.href&&(f[a.href]=a.styleSheet,f[a.href].id=b.ownerNode.id)})}});f.collected=!0;return f};return b})},"widgets/InfoSummary/setting/UniqueLayerChooser":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Deferred","jimu/dijit/LayerChooserFromMap"],
function(l,q,p,n){return l([n],{parent:null,row:null,constructor:function(b){q.mixin(this,b)},postMixInProperties:function(){this.inherited(arguments);this.filter=q.hitch(this,n.andCombineFilters([this.filter,q.hitch(this,this._customFilter)]))},_customFilter:function(b){var a=["WMSLayer","ArcGISImageServiceLayer","ArcGISImageServiceVectorLayer","ArcGISTiledMapServiceLayer","ClusterLayer"],f=new p;if(b.isTable)f.resolve(!1);else{var k=!0;this.parent&&this.parent.used_layers&&b.getLayerType().then(q.hitch(this,
function(d){-1<a.indexOf(d)?k=!1:this.row.layerID!==b.id&&(k=-1===this.parent.used_layers.indexOf(b.id)&&-1===this.parent.unsupported_ids.indexOf(b.id));f.resolve(k)}))}return f}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y,g,w,u,x,t,C,L){var A=p([n,b,a,q],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);w.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new L({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=g.hitch(this,this.basicFilter);this.filter=A.andCombineFilters([this.basicFilter,
this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new k;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new k;a.resolve(!0);return a},getSelectedItems:function(){var a=this.tree.getSelectedItems();return u.map(a,g.hitch(this,function(a){return this.getHandledItem(a)}))},getAllItems:function(){var a=this.tree.getAllItems(),b=[];u.forEach(a,g.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),
b.push(a))}));return b},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(a){this.createMapResponse=a;C.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(g.hitch(this,function(a){this.layerInfosObj=a;this.own(l(this.layerInfosObj,"layerInfosChanged",g.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(l(this.layerInfosObj,"layerInfosIsShowInMapChanged",
g.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(a){this._clear();w.setStyle(this.errorTipSection,"display","block");var b=[];this.onlyShowWebMapLayers?(b=a.getLayerInfoArrayOfWebmap(),b=b.concat(a.getTableInfoArrayOfWebmap())):(b=a.getLayerInfoArray(),
b=b.concat(a.getTableInfoArray()));0!==b.length&&(w.setStyle(this.errorTipSection,"display","none"),u.forEach(b,g.hitch(this,function(a){this._addDirectLayerInfo(a)})))},_addDirectLayerInfo:function(a){a&&a.getLayerObject().then(g.hitch(this,function(){this._addItem("root",a)}),g.hitch(this,function(a){console.error(a)}))},_clear:function(){var a=this._store.query({parent:"root"});u.forEach(a,g.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_addItem:function(a,b){var d=null,
f=b.getLayerType(),k=this.filter(b);y({layerType:f,valid:k}).then(g.hitch(this,function(f){if(f.valid){var k=g.hitch(this,function(c,g){this._id++;d={name:b.title||"",parent:a,layerInfo:b,type:f.layerType,layerClass:b.layerObject.declaredClass,id:this._id.toString(),isLeaf:c,hasChildren:g};this._store.add(d)}),c=b.getSubLayers(),m=0===c.length;m?k(m,!1):(c=u.map(c,g.hitch(this,function(a){return this.filter(a)})),y(c).then(g.hitch(this,function(a){(a=u.some(a,function(a){return a}))&&k(m,a)})))}}))},
_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var a=this._getRootItem(),a=new f({data:[a],getChildren:function(a){return this.query({parent:a.id})}});this._store=new d(a);a=new m({store:this._store,query:{id:"root"},mayHaveChildren:g.hitch(this,this._mayHaveChildren)});this.tree=new t({multiple:this.multiple,model:a,showRoot:!1,isLeafItem:g.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:g.hitch(this,function(a,b){"root"!==
a.id&&this._onTreeOpen(a,b)}),onClick:g.hitch(this,function(a,b,d){this._onTreeClick(a,b,d);this.emit("tree-click",a,b,d)}),getIconStyle:g.hitch(this,function(a,b){var d=null;if(!a||"root"===a.id)return null;var g={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},f=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(a=this._getIconInfo(a,b).imageName)g.backgroundImage="url("+f+"/css/images/"+a+")",d=g;return d}),
getIconClass:g.hitch(this,function(a,b){return this._getIconInfo(a,b).className}),getTooltip:g.hitch(this,function(a){return this.displayTooltipForTreeNode?a.layerInfo.title:""})});w.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,b){var d="",g="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?b?(d="mapserver_open.png",g="mapservice-layer-icon open"):
(d="mapserver_close.png",g="mapservice-layer-icon close"):"GroupLayer"===a.type?b?(d="group_layer2.png",g="group-layer-icon open"):(d="group_layer1.png",g="group-layer-icon close"):"FeatureLayer"===a.type?(a=x.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(d="point_layer1.png",g="point-layer-icon"):"polyline"===a?(d="line_layer1.png",g="line-layer-icon"):"polygon"===a&&(d="polygon_layer1.png",g="polygon-layer-icon")):"Table"===a.type?(d="table.png",g="table-icon"):"ArcGISImageServiceLayer"===
a.type||"ArcGISImageServiceVectorLayer"===a.type?(d="image_layer.png",g="iamge-layer-icon"):b?(d="mapserver_open.png",g="mapservice-layer-icon open"):(d="mapserver_close.png",g="mapservice-layer-icon close");return{imageName:d,className:g}},_onTreeOpen:function(a,b){if("root"!==a.id){var d=[];b=[];d=a.layerInfo.getSubLayers();a.checked||(this.shelter.show(),b=u.map(d,g.hitch(this,function(a){return a.getLayerObject()})),y(b).then(g.hitch(this,function(){this.domNode&&(u.forEach(d,g.hitch(this,function(b){this._addItem(a.id,
b)})),a.checked=!0,this.shelter.hide())}),g.hitch(this,function(a){console.error(a);this.shelter.hide()})))}},_onTreeClick:function(a,b,d){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});A.createFilterByLayerType=function(a){g.isArrayLike(a)||(a=[]);return function(b){var d=new k;if(0===a.length)d.resolve(!0);else{var g=[];b.traversal(function(a){g.push(a.getLayerType())});y(g).then(function(b){for(var g=0;g<
b.length;g++)for(var f=0;f<a.length;f++)if(b[g]===a[f]){d.resolve(!0);return}d.resolve(!1)},function(a){console.error(a);d.reject(a)})}return d}};A.createFeaturelayerFilter=function(a,b,d,g){var f=["point","polyline","polygon"];a&&0<a.length?(a=u.filter(a,function(a){return 0<=f.indexOf(a)}),0===a.length&&(a=f)):a=f;return function(f){var k=f.getLayerType();f=f.getLayerObject();return y({layerType:k,layerObject:f}).then(function(c){var f=c.layerType;c=c.layerObject;if("ArcGISDynamicMapServiceLayer"===
f||"ArcGISTiledMapServiceLayer"===f||"GroupLayer"===f||"FeatureCollection"===f)return!0;if("FeatureLayer"===f){var f=x.getTypeByGeometryType(c.geometryType),f=0<=u.indexOf(a,f),k=A._shouldPassStatisticsCheck(g,c);return c.url?(c=x.isFeaturelayerUrlSupportQuery(c.url,c.capabilities),f&&c&&k):b&&f}return"Table"===f?(f=x.isFeaturelayerUrlSupportQuery(c.url,c.capabilities),c=A._shouldPassStatisticsCheck(g,c),d&&f&&c):!1})}};A.createImageServiceLayerFilter=function(a,b){return function(d){var g=d.getLayerType();
d=d.getLayerObject();return y({layerType:g,layerObject:d}).then(function(d){var g=d.layerType,f=d.layerObject;return"ArcGISImageServiceLayer"===g||"ArcGISImageServiceVectorLayer"===g?a?x.isImageServiceSupportQuery(d.layerObject.capabilities)?b?A._shouldPassStatisticsCheck(b,f):!0:!1:!0:!1})}};A._shouldPassStatisticsCheck=function(a,b){return a?(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};A.createQueryableLayerFilter=function(a){var b=
A.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=A.createImageServiceLayerFilter(!0,a);return A.orCombineFilters([b,a])};A.andCombineFilters=function(a){return A._combineFilters(a,!0)};A.orCombineFilters=function(a){return A._combineFilters(a,!1)};A._combineFilters=function(a,b){return function(d){var g=new k,f=u.map(a,function(a){return a(d)});y(f).then(function(a){var d=!1,d=b?u.every(a,function(a){return a}):u.some(a,function(a){return a});g.resolve(d)},function(a){console.error(a);
g.reject(a)});return g}};return A})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(l,q,p,n,b,a,f){return p("dijit.tree.ObjectStoreModel",f,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(a){b.mixin(this,a);this.childrenCache={}},getRoot:function(f,d){if(this.root)f(this.root);else{var k=this.store.query(this.query);k.then&&this.own(k);
a(k,b.hitch(this,function(a){if(1!=a.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+a.length+" items, but must return exactly one");this.root=a[0];f(this.root);k.observe&&k.observe(b.hitch(this,function(a){this.onChange(a)}),!0)}),d)}},mayHaveChildren:function(){return!0},getChildren:function(f,d,m){var k=this.store.getIdentity(f);if(this.childrenCache[k])a(this.childrenCache[k],d,m);else{var g=this.childrenCache[k]=this.store.getChildren(f);g.then&&this.own(g);g.observe&&
this.own(g.observe(b.hitch(this,function(d,k,m){this.onChange(d);k!=m&&a(g,b.hitch(this,"onChildrenChange",f))}),!0));a(g,d,m)}},isItem:function(){return!0},getIdentity:function(a){return this.store.getIdentity(a)},getLabel:function(a){return a[this.labelAttr]},newItem:function(a,b,f,l){return this.store.put(a,{parent:b,before:l})},pasteItem:function(a,d,f,p,g,w){var k=new n;if(d===f&&!p&&!w)return k.resolve(!0),k;d&&!p?this.getChildren(d,b.hitch(this,function(b){b=[].concat(b);var g=l.indexOf(b,
a);b.splice(g,1);this.onChildrenChange(d,b);k.resolve(this.store.put(a,{overwrite:!0,parent:f,oldParent:d,before:w,isCopy:!1}))})):k.resolve(this.store.put(a,{overwrite:!0,parent:f,oldParent:d,before:w,isCopy:!0}));return k},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y,g,w,u,x,t){var C=l([x._TreeNode,w],{templateString:n,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=a.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=a.toDom('\x3cinput type\x3d"checkbox" /\x3e');a.addClass(this.checkNode,"jimu-tree-check-node");a.place(this.checkNode,this.contentNode,
"first");this.own(y(this.checkNode,"click",b.hitch(this,this._onClick)));this.own(y(this.rowNode,"keydown",b.hitch(this,function(a,b){b.target=a;b.keyCode!==g.ENTER&&b.keyCode!==g.SPACE||this._onClick(b)},this.checkNode)));this.isLeaf?this.groupId?a.setStyle(this.checkNode,"display","none"):a.setStyle(this.checkNode,"display","inline"):a.setStyle(this.checkNode,"display","none");this.isLeaf?a.addClass(this.domNode,"jimu-tree-leaf-node"):a.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,a.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,a.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(b.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return l([x,w],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+t.getRandomString()},postCreate:function(){this.inherited(arguments);a.addClass(this.domNode,"jimu-tree");this.own(m.before(this,"onClick",b.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&a.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;a.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return f.map(a,b.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=f.filter(a,b.hitch(this,function(a){return a.checkNode.checked}));return f.map(a,
b.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var d=this.getAllTreeNodeWidgets(),d=f.map(d,b.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return f.filter(d,b.hitch(this,function(b){return a(b)}))},getTreeNodeByItemId:function(a){for(var b=this._getAllTreeNodeDoms(),d=0;d<b.length;d++){var g=u.byNode(b[d]);if(g.item.id.toString()===a.toString())return g}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},
unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return f.filter(a,b.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return f.map(a,b.hitch(this,function(a){return u.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return d(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);
this.multiple||(a.groupId=this.uniqueId);return new C(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(b,d,g){d.isLeaf&&(a.hasClass(g.target||g.srcElement,"jimu-tree-check-node")||(this.multiple?d.toggleSelect():this.selectNodeWidget(d)));return arguments},_onCheckNodeClick:function(a,
d,g){!this.multiple&&d&&this.unselectAllLeafNodeWidgets();k.stop(g);this.focusNode(a);setTimeout(b.hitch(this,function(){d?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,a,g)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();f.forEach(a,b.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y,g,w,u,x,t,C,L,A,I,G,z,H,O,B,E,c,F,K,M,h,D,N,e,R){function J(a){return t.delegate(a.promise||a,{addCallback:function(a){this.then(a)},addErrback:function(a){this.otherwise(a)}})}var Q=n("dijit._TreeNode",[B,E,c,F,K],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(a){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=a;this._set("label",a);w("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:h,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(a){var b=Math.max(a,0)*this.tree._nodePixelIndent+"px";m.set(this.domNode,
"backgroundPosition",b+" 0px");m.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",b);l.forEach(this.getChildren(),function(b){b.set("indent",a+1)});this._set("indent",a)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(a){var b=this.tree,c=b.model;b._v10Compat&&a===c.root&&(a=null);this._applyClassAndStyle(a,"icon","Icon");this._applyClassAndStyle(a,"label","Label");this._applyClassAndStyle(a,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(a,b,c){var h="_"+b+"Class";b+="Node";var e=this[h];this[h]=this.tree["get"+c+"Class"](a,this.isExpanded);k.replace(this[b],this[h]||"",e||"");m.set(this[b],this.tree["get"+c+"Style"](a,this.isExpanded)||{})},_updateLayout:function(){var a=this.getParent(),a=!a||!a.rowNode||"none"==a.rowNode.style.display;k.toggle(this.domNode,"dijitTreeIsRoot",a);k.toggle(this.domNode,"dijitTreeIsLast",!a&&!this.getNextSibling())},_setExpando:function(a){var b=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];a=a?0:this.isExpandable?this.isExpanded?1:2:3;k.replace(this.expandoNode,b[a],b);this.expandoNodeText.innerHTML=["*","-","+","*"][a]},expand:function(){if(this._expandDeferred)return J(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");k.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var a=g.wipeIn({node:this.containerNode,duration:O.defaultDuration}),c=this._expandDeferred=new b(function(){a.stop()});q.after(a,"onEnd",function(){c.resolve(!0)},!0);a.play();return J(c)},collapse:function(){if(this._collapseDeferred)return J(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");k.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var a=g.wipeOut({node:this.containerNode,duration:O.defaultDuration}),c=this._collapseDeferred=new b(function(){a.stop()});q.after(a,"onEnd",
function(){c.resolve(!0)},!0);a.play();return J(c)},indent:0,setChildItems:function(b){var h=this.tree,e=h.model,r=[],d=h.focusedChild,g=this.getChildren();l.forEach(g,function(a){c.prototype.removeChild.call(this,a)},this);this.defer(function(){l.forEach(g,function(a){if(!a._destroyed&&!a.getParent()){var b=function(a){var c=e.getIdentity(a.item),r=h._itemNodesMap[c];1==r.length?delete h._itemNodesMap[c]:(c=l.indexOf(r,a),-1!=c&&r.splice(c,1));l.forEach(a.getChildren(),b)};h.dndController.removeTreeNode(a);
b(a);if(h.persist){var c=l.map(a.getTreePath(),function(a){return h.model.getIdentity(a)}).join("/"),r;for(r in h._openedNodes)r.substr(0,c.length)==c&&delete h._openedNodes[r];h._saveExpandedNodes()}h.lastFocusedChild&&!f.isDescendant(h.lastFocusedChild.domNode,h.domNode)&&delete h.lastFocusedChild;d&&!f.isDescendant(d.domNode,h.domNode)&&h.focus();a.destroyRecursive()}})});this.state="Loaded";b&&0<b.length?(this.isExpandable=!0,l.forEach(b,function(a){var b=e.getIdentity(a),c=h._itemNodesMap[b],
d;if(c)for(var g=0;g<c.length;g++)if(c[g]&&!c[g].getParent()){d=c[g];d.set("indent",this.indent+1);break}d||(d=this.tree._createTreeNode({item:a,tree:h,isExpandable:e.mayHaveChildren(a),label:h.getLabel(a),labelType:h.model&&h.model.labelType||"text",tooltip:h.getTooltip(a),ownerDocument:h.ownerDocument,dir:h.dir,lang:h.lang,textDir:h.textDir,indent:this.indent+1}),c?c.push(d):h._itemNodesMap[b]=[d]);this.addChild(d);(this.tree.autoExpand||this.tree._state(d))&&r.push(h._expandNode(d))},this),l.forEach(this.getChildren(),
function(a){a._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);b=a(r);this.tree._startPaint(b);return J(b)},getTreePath:function(){for(var a=this,b=[];a&&a!==this.tree.rootNode;)b.unshift(a.item),a=a.getParent();b.unshift(this.tree.rootNode.item);return b},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(a){this.inherited(arguments);var b=this.getChildren();0==b.length&&(this.isExpandable=!1,
this.collapse());l.forEach(b,function(a){a._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(a){this.labelNode.setAttribute("aria-selected",a?"true":"false");k.toggle(this.rowNode,"dijitTreeRowSelected",a)},focus:function(){z.focus(this.focusNode)}});w("dojo-bidi")&&Q.extend({_setTextDirAttr:function(a){!a||this.textDir==a&&this._created||(this._set("textDir",a),this.applyTextDir(this.labelNode),l.forEach(this.getChildren(),function(b){b.set("textDir",
a)},this))}});var P=n("dijit.Tree",[B,M,E,K],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:D,persist:!1,autoExpand:!1,dndController:R,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(a,b){L.publish(this.id,t.mixin({tree:this,event:a},b||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new b;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(C(this.containerNode,
C.selector(".dijitTreeNode",A.enter),function(b){a._onNodeMouseEnter(H.byNode(this),b)}),C(this.containerNode,C.selector(".dijitTreeNode",A.leave),function(b){a._onNodeMouseLeave(H.byNode(this),b)}),C(this.containerNode,C.selector(".dijitTreeRow",G.press),function(b){a._onNodePress(H.getEnclosingWidget(this),b)}),C(this.containerNode,C.selector(".dijitTreeRow",G),function(b){a._onClick(H.getEnclosingWidget(this),b)}),C(this.containerNode,C.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(H.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(q.after(this.model,"onChange",t.hitch(this,"_onItemChange"),!0),q.after(this.model,"onChildrenChange",t.hitch(this,"_onItemChildrenChange"),!0),q.after(this.model,"onDelete",t.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){t.isString(this.dndController)&&(this.dndController=t.getObject(this.dndController));for(var b={},c=0;c<this.dndParams.length;c++)this[this.dndParams[c]]&&(b[this.dndParams[c]]=this[this.dndParams[c]]);
this.dndController=new this.dndController(this,b)}this._load();this.onLoadDeferred=J(this.pendingCommandsPromise);this.onLoadDeferred.then(t.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;u.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var a={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(a.mayHaveChildren=t.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(a.getChildren=t.hitch(this,function(a,b,c){this.getItemChildren(this._v10Compat&&a===this.model.root?null:a,b,c)}));this.model=new e(a);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(t.hitch(this,function(a){var b=this.rootNode=this.tree._createTreeNode({item:a,tree:this,isExpandable:!0,label:this.label||this.getLabel(a),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(b.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(b.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(b.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
b.labelNode.setAttribute("role","presentation"),b.labelNode.removeAttribute("aria-selected"),b.containerNode.setAttribute("role","tree"),b.containerNode.setAttribute("aria-expanded","true"),b.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(b.domNode);a=this.model.getIdentity(a);this._itemNodesMap[a]?this._itemNodesMap[a].push(b):this._itemNodesMap[a]=[b];b._updateLayout();this._expandNode(b).then(t.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),t.hitch(this,function(a){console.error(this,": error loading root: ",a)}))},getNodesByItem:function(a){if(!a)return[];a=t.isString(a)?a:this.model.getIdentity(a);return[].concat(this._itemNodesMap[a])},_setSelectedItemAttr:function(a){this.set("selectedItems",[a])},_setSelectedItemsAttr:function(a){var b=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(t.hitch(this,function(){var c=
l.map(a,function(a){return!a||t.isString(a)?a:b.model.getIdentity(a)}),h=[];l.forEach(c,function(a){h=h.concat(b._itemNodesMap[a]||[])});this.set("selectedNodes",h)}))},_setPathAttr:function(a){return a.length?J(this.set("paths",[a]).then(function(a){return a[0]})):J(this.set("paths",[]).then(function(a){return a[0]}))},_setPathsAttr:function(b){function c(a,b){var e=a.shift(),d=l.filter(b,function(a){return a.getIdentity()==e})[0];if(d)return a.length?h._expandNode(d).then(function(){return c(a,
d.getChildren())}):d;throw new P.PathError("Could not expand path at "+e);}var h=this;return J(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return a(l.map(b,function(a){a=l.map(a,function(a){return a&&t.isObject(a)?h.model.getIdentity(a):a});if(a.length)return c(a,[h.rootNode]);throw new P.PathError("Empty path");}))}).then(function(a){h.set("selectedNodes",a);return h.paths}))},_setSelectedNodeAttr:function(a){this.set("selectedNodes",[a])},_setSelectedNodesAttr:function(a){this.dndController.setSelection(a)},
expandAll:function(){function b(h){return c._expandNode(h).then(function(){var c=l.filter(h.getChildren()||[],function(a){return a.isExpandable});return a(l.map(c,b))})}var c=this;return J(b(this.rootNode))},collapseAll:function(){function b(h){var e=l.filter(h.getChildren()||[],function(a){return a.isExpandable}),e=a(l.map(e,b));return!h.isExpanded||h==c.rootNode&&!c.showRoot?e:e.then(function(){return c._collapseNode(h)})}var c=this;return J(b(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(a){return this.model.getLabel(a)},getIconClass:function(a,b){return!a||this.model.mayHaveChildren(a)?b?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(a,b){(a=this._getNext(b))&&a.isTreeNode&&this.focusNode(a)},_onUpArrow:function(a,b){if(a=b.getPreviousSibling())for(b=a;b.isExpandable&&b.isExpanded&&
b.hasChildren();)b=b.getChildren(),b=b[b.length-1];else if(a=b.getParent(),this.showRoot||a!==this.rootNode)b=a;b&&b.isTreeNode&&this.focusNode(b)},_onRightArrow:function(a,b){b.isExpandable&&!b.isExpanded?this._expandNode(b):b.hasChildren()&&(b=b.getChildren()[0])&&b.isTreeNode&&this.focusNode(b)},_onLeftArrow:function(a,b){b.isExpandable&&b.isExpanded?this._collapseNode(b):(a=b.getParent())&&a.isTreeNode&&(this.showRoot||a!==this.rootNode)&&this.focusNode(a)},focusLastChild:function(){var a=this._getLast();
a&&a.isTreeNode&&this.focusNode(a)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var a=this.rootNode;a.isExpanded;){var b=a.getChildren();if(!b.length)break;a=b[b.length-1]}return a},_getNext:function(a){if(a.isExpandable&&a.isExpanded&&a.hasChildren())return a.getChildren()[0];for(;a&&a.isTreeNode;){var b=a.getNextSibling();if(b)return b;a=a.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(a,b){return f.isDescendant(a,
b.expandoNode)||f.isDescendant(a,b.expandoNodeText)},_onNodePress:function(a,b){this.focusNode(a)},__click:function(a,b,c,h){var e=this.isExpandoNode(b.target,a);a.isExpandable&&(c||e)?this._onExpandoClick({node:a}):(this._publish("execute",{item:a.item,node:a,evt:b}),this[h](a.item,a,b),this.focusNode(a));b.stopPropagation();b.preventDefault()},_onClick:function(a,b){this.__click(a,b,this.openOnClick,"onClick")},_onDblClick:function(a,b){this.__click(a,b,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(a){a=
a.node;this.focusNode(a);a.isExpanded?this._collapseNode(a):this._expandNode(a)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(a){u.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(a)},_getRootOrFirstNode:function(){u.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(a){a._expandNodeDeferred&&
delete a._expandNodeDeferred;if("Loading"!=a.state&&a.isExpanded){var b=a.collapse();this.onClose(a.item,a);this._state(a,!1);this._startPaint(b);return b}},_expandNode:function(a){if(a._expandNodeDeferred)return a._expandNodeDeferred;var c=this.model,h=a.item,e=this;a._loadDeferred||(a.markProcessing(),a._loadDeferred=new b,c.getChildren(h,function(b){a.unmarkProcessing();a.setChildItems(b).then(function(){a._loadDeferred.resolve(b)})},function(b){console.error(e,": error loading "+a.label+" children: ",
b);a._loadDeferred.reject(b)}));c=a._loadDeferred.then(t.hitch(this,function(){var b=a.expand();this.onOpen(a.item,a);this._state(a,!0);return b}));this._startPaint(c);return c},focusNode:function(a){for(var b=[],c=this.domNode;c&&c.tagName&&"IFRAME"!==c.tagName.toUpperCase();c=c.parentNode)b.push({domNode:c.contentWindow||c,scrollLeft:c.scrollLeft||0,scrollTop:c.scrollTop||0});this.focusChild(a);this.defer(function(){for(var a=0,c=b.length;a<c;a++)b[a].domNode.scrollLeft=b[a].scrollLeft,b[a].domNode.scrollTop=
b[a].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(a){var b=this.model.getIdentity(a);if(b=this._itemNodesMap[b]){var c=this.getLabel(a),h=this.getTooltip(a);l.forEach(b,function(b){b.set({item:a,label:c,tooltip:h});b._updateItemClasses(a)})}},_onItemChildrenChange:function(a,b){a=this.model.getIdentity(a);(a=this._itemNodesMap[a])&&l.forEach(a,function(a){a.setChildItems(b)})},_onItemDelete:function(a){a=this.model.getIdentity(a);var b=this._itemNodesMap[a];
b&&(l.forEach(b,function(a){this.dndController.removeTreeNode(a);var b=a.getParent();b&&b.removeChild(a);this.lastFocusedChild&&!f.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!f.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();a.destroyRecursive()},this),delete this._itemNodesMap[a])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var a=p(this.cookieName);a&&l.forEach(a.split(","),function(a){this._openedNodes[a]=
!0},this)}},_state:function(a,b){if(!this.persist)return!1;var c=l.map(a.getTreePath(),function(a){return this.model.getIdentity(a)},this).join("/");if(1===arguments.length)return this._openedNodes[c];b?this._openedNodes[c]=!0:delete this._openedNodes[c];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var a=[],b;for(b in this._openedNodes)a.push(b);p(this.cookieName,a.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!t.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(a){a&&d.setMarginBox(this.domNode,a);this._nodePixelIndent=d.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(t.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(a){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var b=t.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});I(a,b,b)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(a){return new Q(a)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});w("dojo-bidi")&&P.extend({_setTextDirAttr:function(a){a&&this.textDir!=a&&(this._set("textDir",a),this.rootNode.set("textDir",a))}});P.PathError=y("TreePathError");P._TreeNode=Q;return P})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(l,q,p,n){return p("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(b){n.mixin(this,b);this.connects=[];b=this.store;if(!b.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");b.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([q.after(b,
"onNew",n.hitch(this,"onNewItem"),!0),q.after(b,"onDelete",n.hitch(this,"onDeleteItem"),!0),q.after(b,"onSet",n.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var b;b=this.connects.pop();)b.remove()},getRoot:function(b,a){this.root?b(this.root):this.store.fetch({query:this.query,onComplete:n.hitch(this,function(a){if(1!=a.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+a.length+" items, but must return exactly one");this.root=a[0];b(this.root)}),onError:a})},mayHaveChildren:function(b){return l.some(this.childrenAttrs,
function(a){return this.store.hasAttribute(b,a)},this)},getChildren:function(b,a,f){var k=this.store;if(k.isItemLoaded(b)){for(var d=[],m=0;m<this.childrenAttrs.length;m++)var p=k.getValues(b,this.childrenAttrs[m]),d=d.concat(p);var g=0;this.deferItemLoadingUntilExpand||l.forEach(d,function(a){k.isItemLoaded(a)||g++});0==g?a(d):l.forEach(d,function(b,l){k.isItemLoaded(b)||k.loadItem({item:b,onItem:function(b){d[l]=b;0==--g&&a(d)},onError:f})})}else{var w=n.hitch(this,arguments.callee);k.loadItem({item:b,
onItem:function(b){w(b,a,f)},onError:f})}},isItem:function(b){return this.store.isItem(b)},fetchItemByIdentity:function(b){this.store.fetchItemByIdentity(b)},getIdentity:function(b){return this.store.getIdentity(b)},getLabel:function(b){return this.labelAttr?this.store.getValue(b,this.labelAttr):this.store.getLabel(b)},newItem:function(b,a,f){var k={parent:a,attribute:this.childrenAttrs[0]},d;this.newItemIdAttr&&b[this.newItemIdAttr]?this.fetchItemByIdentity({identity:b[this.newItemIdAttr],scope:this,
onItem:function(l){l?this.pasteItem(l,null,a,!0,f):(d=this.store.newItem(b,k))&&void 0!=f&&this.pasteItem(d,a,a,!1,f)}}):(d=this.store.newItem(b,k))&&void 0!=f&&this.pasteItem(d,a,a,!1,f)},pasteItem:function(b,a,f,k,d){var m=this.store,n=this.childrenAttrs[0];a&&l.forEach(this.childrenAttrs,function(d){if(m.containsValue(a,d,b)){if(!k){var g=l.filter(m.getValues(a,d),function(a){return a!=b});m.setValues(a,d,g)}n=d}});if(f)if("number"==typeof d){var g=m.getValues(f,n).slice();g.splice(d,0,b);m.setValues(f,
n,g)}else m.setValues(f,n,m.getValues(f,n).concat(b))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(b,a){a&&this.getChildren(a.item,n.hitch(this,function(b){this.onChildrenChange(a.item,b)}))},onDeleteItem:function(b){this.onDelete(b)},onSetItem:function(b,a){if(-1!=l.indexOf(this.childrenAttrs,a))this.getChildren(b,n.hitch(this,function(a){this.onChildrenChange(b,a)}));else this.onChange(b)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(l,q,p,n,b){return q("dijit.tree.ForestStoreModel",b,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(a){this.root={store:this,root:!0,id:a.rootId,label:a.rootLabel,children:a.rootChildren}},mayHaveChildren:function(a){return a===this.root||this.inherited(arguments)},getChildren:function(a,b,k){a===this.root?this.root.children?b(this.root.children):this.store.fetch({query:this.query,onComplete:n.hitch(this,
function(a){this.root.children=a;b(a)}),onError:k}):this.inherited(arguments)},isItem:function(a){return a===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(a){if(a.identity==this.root.id){var b=a.scope||p.global;a.onItem&&a.onItem.call(b,this.root)}else this.inherited(arguments)},getIdentity:function(a){return a===this.root?this.root.id:this.inherited(arguments)},getLabel:function(a){return a===this.root?this.root.label:this.inherited(arguments)},newItem:function(a,b,k){return b===
this.root?(this.onNewRootItem(a),this.store.newItem(a)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(a,b,k,d,l){if(b===this.root&&!d)this.onLeaveRoot(a);this.inherited(arguments,[a,b===this.root?null:b,k===this.root?null:k,d,l]);if(k===this.root)this.onAddToRoot(a)},onAddToRoot:function(a){console.log(this,": item ",a," added to root")},onLeaveRoot:function(a){console.log(this,": item ",a," removed from root")},_requeryTop:function(){var a=this.root.children||[];this.store.fetch({query:this.query,
onComplete:n.hitch(this,function(b){this.root.children=b;if(a.length!=b.length||l.some(a,function(a,d){return b[d]!=a}))this.onChildrenChange(this.root,b)})})},onNewItem:function(a,b){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(a){-1!=l.indexOf(this.root.children,a)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(a,b,k,d){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(l,q,p,n,b,a,f,k,d,m,y){return q("dijit.tree._dndSelector",y,{constructor:function(){this.selection={};this.anchor=null;this.events.push(k(this.tree.domNode,d.press,n.hitch(this,"onMouseDown")),k(this.tree.domNode,d.release,n.hitch(this,"onMouseUp")),k(this.tree.domNode,d.move,n.hitch(this,"onMouseMove")),k(this.tree.domNode,m.press,n.hitch(this,"onClickPress")),k(this.tree.domNode,m.release,n.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],b=this.selection,
d;for(d in b)a.push(b[d]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,b){this.setSelection(this.getSelectedTreeNodes().concat([a]));b&&(this.anchor=a);return a},removeTreeNode:function(b){var d=l.filter(this.getSelectedTreeNodes(),function(d){return!a.isDescendant(d.domNode,b.domNode)});this.setSelection(d);return b},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var b=this.getSelectedTreeNodes();l.forEach(this._setDifference(b,a),n.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));l.forEach(this._setDifference(a,b),n.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,b){l.forEach(b,function(a){a.__exclude__=!0});a=l.filter(a,function(a){return!a.__exclude__});l.forEach(b,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),b=[],d=[];l.forEach(a,function(a){var g=a.getTreePath();d.push(a);b.push(g)},this);a=l.map(d,function(a){return a.item});this.tree._set("paths",b);this.tree._set("path",b[0]||[]);this.tree._set("selectedNodes",d);this.tree._set("selectedNode",d[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&f.isLeft(a)&&a.preventDefault();var d="keydown"==a.type?this.tree.focusedChild:this.current;if(d){var g=b.getCopyKeyState(a),k=d.id;this.singular||a.shiftKey||!this.selection[k]?(this._doDeselect=!1,this.userSelect(d,g,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,b.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,b){if(a===b)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-b.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(b)&2?1:-1;if(document.createRange){var d=doc.createRange();d.setStartBefore(a);a=doc.createRange();a.setStartBefore(b);return d.compareBoundaryPoints(d.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,b,d){if(this.singular)this.anchor==a&&b?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(d&&this.anchor){b=this._compareNodes(this.anchor.rowNode,a.rowNode);d=this.anchor;0>b?b=d:(b=a,a=d);for(d=[];b!=a;)d.push(b),b=this.tree._getNext(b);d.push(a);this.setSelection(d)}else this.selection[a.id]&&b?this.removeTreeNode(a):b?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
b){b=b||p.global;for(var d in this.selection)a.call(b,this.getItem(d),d,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(l,q,p,n,b,a){return q("dijit.tree._dndContainer",null,{constructor:function(f,k){this.tree=f;this.node=f.domNode;n.mixin(this,k);this.containerState="";p.add(this.node,"dojoDndContainer");this.events=[b(this.node,a.enter,n.hitch(this,"onOverEvent")),b(this.node,a.leave,
n.hitch(this,"onOutEvent")),l.after(this.tree,"_onNodeMouseEnter",n.hitch(this,"onMouseOver"),!0),l.after(this.tree,"_onNodeMouseLeave",n.hitch(this,"onMouseOut"),!0),b(this.node,"dragstart, selectstart",function(a){a.preventDefault()})]},destroy:function(){for(var a;a=this.events.pop();)a.remove();this.node=this.parent=null},onMouseOver:function(a){this.current=a},onMouseOut:function(){this.current=null},_changeState:function(a,b){var d="dojoDnd"+a;a=a.toLowerCase()+"State";p.replace(this.node,d+
b,d+this[a]);this[a]=b},_addItemClass:function(a,b){p.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){p.remove(a,"dojoDndItem"+b)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"widgets/InfoSummary/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/LayerChooserFromMapWithDropbox.html":'\x3cdiv\x3e\r\n\x3ctable role\x3d"listbox" aria-haspopup\x3d"true" data-dojo-attach-point\x3d"dropDownBtn" data-dojo-attach-event\x3d"onclick: _onDropDownClick,onkeydown: _onDropDownKeydown"\r\n  tabindex\x3d"0" title\x3d"${nls.customSelectLayer}" aria-label\x3d"${nls.customSelectLayer}"\x3e\r\n    \x3ccaption class\x3d"screen-readers-only-no-position"\x3e${nls.customSelectLayer}\x3c/caption\x3e\r\n    \x3ccolgroup\x3e\r\n      \x3ccol width\x3d"10px"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n      \x3ccol width\x3d"30px"\x3e\x3c/col\x3e\r\n    \x3c/colgroup\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd\x3e\x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"layer-name jimu-ellipsis" data-dojo-attach-point\x3d"layerNameNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"drop-select jimu-float-trailing" data-dojo-attach-point\x3d"dropArrowNode"\x3e\r\n            \x3cdiv class\x3d"jimu-icon jimu-icon-down-arrow-8"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/InfoSummary/setting/MySymbolPicker.html":'\x3cdiv style\x3d"width: 100%;"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"tabParent"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"symbolPickerContainer" class\x3d"symbolPickerContainer"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"div_symbolOptionsContainer" class\x3d"symbolOptionsContainer"\x3e\r\n        \x3cdiv class\x3d"label iconOptionsText"\x3e\r\n          ${nls.symbolOptionsText}\r\n        \x3c/div\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_symbolOptions" class\x3d"symbolOptions"\x3e\r\n          \x3c!--Symbol Options--\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10"\r\n               data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_rdoLayerSym" class\x3d"height30"\x3e\r\n              \x3cinput name\x3d"a" data-dojo-type\x3d"dijit/form/RadioButton"\r\n                     class\x3d"jimu-radio-btn"\r\n                     data-dojo-attach-point\x3d"rdoLayerSym"\r\n                     title\x3d"${nls.rdoLayer}"\r\n                     id\x3d"rdo-layer"/\x3e\r\n              \x3clabel class\x3d"label" for\x3d"rdo-layer"\x3e${nls.rdoLayer}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"jimu-r-row symPick marginLR20 layer-sym-container" data-dojo-attach-point\x3d"layerSym"\x3e \x3c/div\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_rdoEsriSym" class\x3d"height30"\x3e\r\n              \x3cinput name\x3d"a" id\x3d"rdo-esri" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"rdoEsriSym" title\x3d"${nls.rdoEsri}" /\x3e\r\n              \x3clabel class\x3d"label" for\x3d"rdo-esri"\x3e${nls.rdoEsri}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"symbolPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker" class\x3d"jimu-r-row symPick marginLR20"\x3e\x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"parent_div_uploadCustomSymbol"\x3e\r\n            \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpSymbolOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"div_rdoCustomSym" class\x3d"rdoCustomSym"\x3e\r\n                \x3cinput name\x3d"a" id\x3d"rdo-custom" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"rdoCustomSym" title\x3d"${nls.rdoCustom}" /\x3e\r\n                \x3clabel class\x3d"label" for\x3d"rdo-custom"\x3e${nls.rdoCustom}\x3c/label\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"customSymbolDIV" class\x3d"jimu-r-row padTop10 sHeight marginLR20"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"uploadCustomSymbol" class\x3d"uploadCustom"\x3e\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"customSymbolPlaceholder" class\x3d"customPlaceholder"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3c!--Clustering Options--\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"parent_div_clusterOptions" class\x3d"clusterOptions"\x3e\r\n            \x3chr class\x3d"w" /\x3e\r\n            \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpClusterOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"div_chkCluster" class\x3d"padTop20"\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv data-dojo-attach-point\x3d"clusterPickerContainer" class\x3d"jimu-r-row marginLR22 grpClusterOptions"\x3e\r\n              \x3cdiv class\x3d"jimu-float-leading"\x3e${nls.defineClusterSymbol}:\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"clusterPicker" data-dojo-type\x3d"jimu/dijit/SymbolPicker" class\x3d"jimu-float-trailing colorPick"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n\r\n            \x3cdiv class\x3d"jimu-r-row grpClusterOptions marginLR22" data-dojo-attach-point\x3d"grpClusterOptions"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"div_chkGroupCluster"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"jimu-r-row grpClusterOptions" data-dojo-attach-point\x3d"featureFont" style\x3d"display: none; margin-left: 45px; margin-right: 45px;"\x3e\r\n              \x3cdiv class\x3d"jimu-float-leading"\x3e${nls.defineClusterFont}:\x3c/div\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"colorPicker" data-dojo-type\x3d"jimu/dijit/ColorPicker" data-dojo-props\x3d\'color:"${_highLightColor}"\' class\x3d"marginLR30 colorPick2 jimu-float-trailing"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"label iconOptionsText padTop20" data-dojo-attach-point\x3d"iconOptionsTextLabel"\x3e\r\n          ${nls.iconOptionsText}\r\n        \x3c/div\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_iconOptions" class\x3d"iconOptions"\x3e\r\n          \x3c!--Main Panel and cluster center Icon Options--\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpIconOptions"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_rdoLayerIcon"\x3e\r\n              \x3cinput name\x3d"b" id\x3d"rdo-layer-icon" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"rdoLayerIcon" title\x3d"${nls.rdoLayerIcon}" /\x3e\r\n              \x3clabel class\x3d"label" for\x3d"rdo-layer-icon" data-dojo-attach-point\x3d"rdoLayerIconLabel"\x3e${nls.rdoLayerIcon}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpCustomIconOptions"\x3e\r\n            \x3cdiv class\x3d"rdoCustomSym" data-dojo-attach-point\x3d"div_rdoCustomIcon"\x3e\r\n              \x3cinput name\x3d"b" id\x3d"rdo-custom-icon" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"rdoCustomIcon" title\x3d"${nls.rdoCustomIcon}" /\x3e\r\n              \x3clabel class\x3d"label" for\x3d"rdo-custom-icon" data-dojo-attach-point\x3d"rdoCustomIconLabel"\x3e${nls.rdoCustomIcon}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10 sHeight marginLR30"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"uploadCustomIcon" class\x3d"uploadCustom"\x3e\x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"customIconPlaceholder" class\x3d"customPlaceholder"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"panelFeatureDisplayContainer" class\x3d"panelFeatureContainer"\x3e\r\n      \x3cdiv class\x3d"label iconOptionsText padTop10" data-dojo-attach-point\x3d"featureOptionsTextLabel"\x3e\r\n        ${nls.featureOptionsText}\r\n      \x3c/div\x3e\r\n      \x3chr /\x3e\r\n      \x3cdiv class\x3d"btn-add-section enable" data-dojo-attach-point\x3d"btnAddField"\x3e\r\n        \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n        \x3cspan class\x3d"btn-add-label"\x3e${nls.addField}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"fieldOptions" class\x3d"fieldOptions"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"label iconOptionsText padTop20" data-dojo-attach-point\x3d"groupOptionsTextLabel"\x3e\r\n        ${nls.groupOptionsText}\r\n      \x3c/div\x3e\r\n      \x3chr /\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"groupOptions" class\x3d"groupOptions"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"div_chkGroup"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"groupByOptions" class\x3d"groupByOptions"\x3e\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpField"\x3e\r\n            \x3cdiv class\x3d"rdoGroupField" data-dojo-attach-point\x3d"div_rdoGroupField"\x3e\r\n              \x3cinput name\x3d"c" id\x3d"rdo-group-field" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"rdoGroupField" title\x3d"${nls.rdoGroupByField}" /\x3e\r\n              \x3clabel class\x3d"label" for\x3d"rdo-group-field" data-dojo-attach-point\x3d"rdoGroupFieldLabel"\x3e${nls.rdoGroupByField}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"groupFieldOptions" class\x3d"groupFieldOptions"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n\r\n          \x3cdiv class\x3d"jimu-r-row padTop10" data-dojo-attach-point\x3d"grpRenderer"\x3e\r\n            \x3cdiv class\x3d"rdoGroupField" data-dojo-attach-point\x3d"div_rdoGroupRenderer"\x3e\r\n              \x3cinput name\x3d"c" id\x3d"rdo-group-render" data-dojo-type\x3d"dijit/form/RadioButton" class\x3d"jimu-radio-btn" data-dojo-attach-point\x3d"rdoGroupRenderer" title\x3d"${nls.rdoGroupByRenderer}" /\x3e\r\n              \x3clabel class\x3d"label" for\x3d"rdo-group-render" data-dojo-attach-point\x3d"rdoGroupRendererLabel"\x3e${nls.rdoGroupByRenderer}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3c!--Footer--\x3e\r\n  \x3cdiv class\x3d"footer padTop20"\x3e\r\n    \x3cdiv class\x3d"jimu-btn ok" data-dojo-attach-point\x3d"btnOk"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-btn cancel" data-dojo-attach-point\x3d"btnCancel"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/InfoSummary/setting/Setting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"jimu-r-row"\x3e\r\n    \x3cdiv class\x3d"btn-add-section enable" data-dojo-attach-point\x3d"btnAddLayer"\x3e\r\n      \x3cspan class\x3d"btn-add-icon"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"btn-add-label"\x3e${nls.addLayer}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"layerTable" class\x3d"padBottom20"/\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cfieldset class\x3d"fieldSet optionsFieldSet"\x3e\r\n    \x3clegend class\x3d"fieldSetLegend"\x3e${nls.optionsText}\x3c/legend\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"optionsContainer"\x3e\r\n      \x3cdiv\x3e\r\n        \x3cdiv class\x3d"refreshOptions refreshOff" data-dojo-attach-point\x3d"refreshOptions"\x3e\r\n          \x3cdiv class\x3d"refreshIntervalTitle" title\x3d"${nls.refreshIntervalTitle}"\x3e\r\n            \x3cspan style\x3d"padding-right: 10px;"\x3e${nls.refreshIntervalInstruction}\x3c/span\x3e\r\n            \x3cinput type\x3d"text" name\x3d"refreshInterval"\r\n                   placeholder\x3d"${nls.refreshInterval}"\r\n                   data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n                   data-dojo-props\x3d"regExp:\'[\\\\d]+\', _hasBeenBlurred:true, trim:true"\r\n                   data-dojo-attach-point\x3d"refreshInterval"\r\n                   data-dojo-attach-event\x3d"onKeyUp:_updateOK"\r\n                   class\x3d"refreshInterval" required\x3d"true"\x3e\r\n            \x3cspan style\x3d"padding-left: 10px;"\x3e${nls.refreshUnit}\x3c/span\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"displayOptionsContainer" data-dojo-attach-point\x3d"displayOptionsContainer"\x3e\r\n        \x3cdiv title\x3d"${nls.panelCountOptionHelp}" data-dojo-attach-point\x3d"div_panelCountOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"padTop20" title\x3d"${nls.panelIconOptionHelp}" data-dojo-attach-point\x3d"div_panelIconOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"padTop20"\x3e\r\n          \x3cdiv class\x3d"mainPanelPreviewContainerOff" data-dojo-attach-point\x3d"mainPanelPreviewContainer"\x3e\r\n            \x3cdiv class\x3d"leftContainer"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"mainPanelPreviewButton" class\x3d"mainPanelPreviewButton"\x3e\r\n              \x3c/div\x3e\r\n              \x3cdiv class\x3d"instruction2"\x3e\r\n                ${nls.mainPanelText}\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"rightContainer"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"mainPanelPreview" class\x3d"bg rounded mainPanelPreview"\x3e\r\n                \x3cdiv class\x3d"panelContent bg"\x3e\r\n                  \x3cdiv class\x3d"page"\x3e\r\n                    \x3cdiv data-dojo-attach-point\x3d"panelMainIcon"\x3e\x3c/div\x3e\r\n                  \x3c/div\x3e\r\n                \x3c/div\x3e\r\n              \x3c/div\x3e\r\n              \x3cinput type\x3d"text" name\x3d"mainPanelText"\r\n                     placeholder\x3d"${nls.mainPanelTextPlaceholder}"\r\n                     data-dojo-type\x3d"dijit/form/TextBox"\r\n                     data-dojo-props\x3d"trim:true"\r\n                     data-dojo-attach-point\x3d"mainPanelText"\r\n                     class\x3d"mainPanelText"\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv\x3e\r\n          \x3cdiv title\x3d"${nls.expandListHelp}" data-dojo-attach-point\x3d"div_expandListOptions"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"padTop20"\x3e\r\n          \x3cdiv title\x3d"${nls.showAllFeaturesHelp}" data-dojo-attach-point\x3d"div_showAllFeaturesOptions"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"hidePanelContainer padTop20"\x3e\r\n          \x3cdiv title\x3d"${nls.hidePanelHelp}"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_hidePanelOptions"\x3e\r\n              \x3c!-- \x3cinput data-dojo-attach-point\x3d"hidePanelOptions" data-dojo-type\x3d"dijit/form/CheckBox" /\x3e\r\n              \x3cspan class\x3d"label"\x3e ${nls.hidePanel}\x3c/span\x3e --\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"padTop10 help-off" data-dojo-attach-point\x3d"hidePanelHelpText"\x3e\r\n              \x3cspan class\x3d"label note-help"\x3e ${nls.continuousRefreshHelp}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"padTop20"\x3e\r\n          \x3cdiv title\x3d"${nls.displayClusterLayer}" data-dojo-attach-point\x3d"div_displayClusterLayerOptions"\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/fieldset\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/InfoSummary/setting/css/style.css":".jimu-widget-InfoSummary-setting {width: 100%; height: 100%;}.jimu-widget-InfoSummary-setting .btn-add-section {display: inline-block; overflow: hidden; height: 24px; margin-left: 1px; margin-bottom: 3px; cursor: pointer; font-size: 13px; color: #538ec8; padding-left: 5px; padding-right: 5px;}.jimu-widget-InfoSummary-setting .btn-add-section-disabled {display: inline-block; overflow: hidden; height: 24px; margin-left: 1px; margin-bottom: 3px; cursor: default; font-size: 13px; color: #a0acbf; padding-left: 5px; padding-right: 5px;}.jimu-widget-InfoSummary-setting .jimu-icon-edit {margin-left: 5px; margin-top: 5px;}.jimu-rtl .jimu-widget-InfoSummary-setting .jimu-icon-edit {margin-right: 5px; margin-top: 5px;}.jimu-widget-InfoSummary-setting .btn-add-section .btn-add-icon {height: 100%; width: 14px; background-repeat: no-repeat; background-position: center center; background-image: url(images/add.png); display: inline-block; vertical-align: top;}.jimu-widget-InfoSummary-setting .btn-add-section-disabled .btn-add-icon {height: 100%; width: 14px; background-repeat: no-repeat; background-position: center center; background-image: url(images/add.png); display: inline-block; vertical-align: top; opacity: .6;}.jimu-widget-InfoSummary-setting .btn-add-section .btn-add-icon:hover {background-image: url(images/add_hover.png);}.jimu-widget-InfoSummary-setting .btn-add-section .btn-add-label {height: 100%; line-height: 24px; margin-left: 7px; text-decoration: underline; display: inline-block; vertical-align: top;}.jimu-widget-InfoSummary-setting .btn-add-section-disabled .btn-add-label {height: 100%; line-height: 24px; margin-left: 7px; text-decoration: underline; display: inline-block; vertical-align: top;}.jimu-widget-InfoSummary-setting .instruction2{padding-top: 140px;}.jimu-widget-InfoSummary-setting .instruction2 span{color: #596679;}.jimu-widget-InfoSummary-setting .panelContent {position: relative; width: 340px; height: 150px;}.jimu-widget-InfoSummary-setting .page {position: relative; width: 340px; height: 150px; display: block; background-color: rgba(0,0,0,0.15);}.jimu-widget-InfoSummary-setting .panelMain {display: block;}.jimu-widget-InfoSummary-setting .hidePanelContainer {height: auto; float: left; display: block; padding-bottom: 20px;}.jimu-rtl .jimu-widget-InfoSummary-setting .hidePanelContainer {height: auto; float: right; display: block; padding-bottom: 20px;}.jimu-widget-InfoSummary-setting .displayOptionsContainer {height: auto; float: left; display: block; padding-left: 10px;}.jimu-rtl .jimu-widget-InfoSummary-setting .displayOptionsContainer {height: auto; float: right; display: block; padding-right: 10px;}.jimu-widget-InfoSummary-setting .marginLR20 {margin-left: 20px; margin-right: 20px;}.jimu-widget-InfoSummary-setting .marginLR22 {margin-left: 22px; margin-right: 22px;}.jimu-widget-InfoSummary-setting .marginLR25 {margin-left: 25px; margin-right: 25px;}.jimu-widget-InfoSummary-setting .marginLR30 {margin-left: 30px; margin-right: 30px;}.jimu-widget-InfoSummary-setting .continuousContainer {float: left; clear: left;}.jimu-rtl .jimu-widget-InfoSummary-setting .continuousContainer {float: right; clear: right;}.jimu-widget-InfoSummary-setting .rightContainer {float: left; position: relative; height: 210px;}.jimu-rtl .jimu-widget-InfoSummary-setting .rightContainer {float: right;}.jimu-widget-InfoSummary-setting .leftContainer {float: left; padding-right: 20px; position: relative; height: 210px;}.jimu-rtl .jimu-widget-InfoSummary-setting .leftContainer {float: right; padding-left: 20px; position: relative;}.jimu-widget-InfoSummary-setting .mainPanelPreviewContainerOn {display: table; padding-bottom: 10px;}.jimu-widget-InfoSummary-setting .mainPanelPreviewContainerOff {display: none;}.jimu-widget-InfoSummary-setting .refreshOff {display: none;}.jimu-widget-InfoSummary-setting .refreshOn {display: block;}.jimu-widget-InfoSummary-setting .uploadCustom {display: block; width: 25px; height: 25px; cursor: pointer; background-image: url(../css/images/edit_default.png); background-repeat: no-repeat;}.jimu-widget-InfoSummary-setting .uploadCustom:hover {display: block; width: 25px; height: 25px; cursor: pointer; background-image: url(../css/images/edit_hover.png); background-repeat: no-repeat;}.jimu-widget-InfoSummary-setting .sHeight{min-height: 25px; display: block; left: 10px;}.jimu-rtl .jimu-widget-InfoSummary-setting .sHeight{min-height: 25px; display: block; right: 10px;}.jimu-widget-InfoSummary-setting .customPlaceholderSettings {display: block; width: 25px; height: 25px; cursor: default;}.jimu-widget-InfoSummary-setting .customPlaceholder {display: block; width: 25px; height: 25px; cursor: pointer; position: absolute; top: 5px; left: 20px;}.jimu-rtl .jimu-widget-InfoSummary-setting .customPlaceholder {display: block; width: 25px; height: 25px; cursor: pointer; position: absolute; top: 5px; right: 20px;}.jimu-widget-InfoSummary-setting .imageDataGFX {height:27px; float: left;}.jimu-rtl .jimu-widget-InfoSummary-setting .imageDataGFX {height:27px; float: right;}.jimu-widget-InfoSummary-setting .imageDataGFX-display {width:27px; height:27px;}.jimu-widget-InfoSummary-setting .imageDataGFX2 {display: block; margin-left: 5px; margin-bottom: 5px; margin-right: 10px;}.jimu-rtl .jimu-widget-InfoSummary-setting .imageDataGFX2 {display: block; margin-right: 5px; margin-bottom: 5px; margin-left: 10px;}.jimu-widget-InfoSummary-setting .imageDataGFXMulti {width:100%; padding-right: 10px;}.jimu-rtl .jimu-widget-InfoSummary-setting .imageDataGFXMulti {width:100%; padding-left: 10px;}.jimu-widget-InfoSummary-setting .displayOptions {padding-left: 40px; padding-right: 0px;}.jimu-rtl .jimu-widget-InfoSummary-setting .displayOptions {padding-right: 40px; padding-left: 0px;}.jimu-widget-InfoSummary-setting .symPickers{float:right; overflow:visible;}.jimu-widget-InfoSummary-setting .symPick {padding-top: 1px; padding-bottom: 1px; border: 0px solid #D7D7D7;}.jimu-widget-InfoSummary-setting .layer-sym-container {overflow-y: auto; max-height: 100px; min-height: 33px; max-width: 340px;}.jimu-widget-InfoSummary-setting .colorPick {border: 0px solid #D7D7D7;}.jimu-widget-InfoSummary-setting .colorPick2 {width: 28px; height: 28px;}.jimu-widget-InfoSummary-setting .symbolPreview {float: left; width: 280px; height: 340px; margin-left: 20px; margin-top:10px; border: 5px dashed gray;}.jimu-widget-InfoSummary-setting .iconPreview {float: left; width: 280px; height: 90px; margin-left: 20px; margin-top: 10px; margin-bottom: 10px; border: 5px dashed gray;}.jimu-widget-InfoSummary-setting .symbolOptionsContainer {overflow: hidden;}.jimu-widget-InfoSummary-setting .symbolPickerContainer {height: 100%; width: 100%; overflow: auto; padding-bottom: 8px; margin-top: 15px;}.jimu-widget-InfoSummary-setting .panelFeatureContainer {height: auto; display: none;}.jimu-widget-InfoSummary-setting .fieldOptions {width: 360px; max-height: 130px; overflow-y: auto; padding-left: 5px; padding-right: 5px;}.jimu-widget-InfoSummary-setting .groupOptions {position: relative;}.jimu-widget-InfoSummary-setting .groupFieldOptions {margin-top: 15px; width: 100%; height: auto; display: none; float: left; margin-bottom: 15px;}.jimu-widget-InfoSummary-setting .symbolOptionText {font-weight: bold;}.jimu-widget-InfoSummary-setting .symbolOptions{}.jimu-widget-InfoSummary-setting .w{width: 240px; position: absolute; left: 0px;}.jimu-rtl .jimu-widget-InfoSummary-setting .w{width: 240px; position: absolute; right: 0px;}.jimu-widget-InfoSummary-setting .rdoCustomSym{vertical-align: middle;}.jimu-widget-InfoSummary-setting .clusterOptions{min-width: 250px;}.jimu-widget-InfoSummary-setting .grpClusterOptions{padding-top: 16px;}.jimu-widget-InfoSummary-setting .iconOptionsText{font-weight: bold; width: 200px; display: -webkit-inline-box;}.jimu-widget-InfoSummary-setting .iconOptions{min-width: 250px; min-height: 95px;}.jimu-widget-InfoSummary-setting .checkBox {margin-left: 20px;}.jimu-rtl .jimu-widget-InfoSummary-setting .checkBox {margin-left: 20px;}.jimu-widget-InfoSummary-setting .height30{height: 30px;}.jimu-widget-InfoSummary-setting .padTop10{padding-top: 10px;}.jimu-widget-InfoSummary-setting .padTop20{padding-top: 20px;}.jimu-widget-InfoSummary-setting .padTop30{padding-top: 30px;}.jimu-widget-InfoSummary-setting .optionsText{padding-top: 25px; font-weight: bold;}.jimu-widget-InfoSummary-setting .mainPanelText{width: 340px; position: absolute; bottom: 10px;}.jimu-widget-InfoSummary-setting .refreshOptions{float:right; padding-right: 10px;}.jimu-rtl .jimu-widget-InfoSummary-setting .refreshOptions {float: left; padding-left: 10px;}.jimu-widget-InfoSummary-setting .refreshIntervalTitle{float:left;}.jimu-widget-InfoSummary-setting .refreshInterval{width:130px;}.jimu-widget-InfoSummary-setting .longSelect .dijitSelectLabel {text-align:left; text-overflow: ellipsis; overflow: hidden; max-width:295px; width:295px;}.jimu-widget-InfoSummary-setting .medSelect .dijitSelectLabel {text-align:left; text-overflow: ellipsis; overflow: hidden; max-width:150px; width: 150px;}.jimu-widget-InfoSummary-setting .loSelect .dijitSelectLabel {text-align:left; text-overflow: ellipsis; overflow: hidden; max-width: 88px; min-width: 88px;}.jimu-widget-InfoSummary-setting .goSelect .dijitSelectLabel {text-align:left; text-overflow: ellipsis; overflow: hidden; max-width: 145px; min-width: 145px}.jimu-widget-InfoSummary-setting .shortSelect .dijitSelectLabel {text-align:left; text-overflow: ellipsis; overflow: hidden; max-width: 81px; width: 81px;}.jimu-widget-InfoSummary-setting .innerMainPanelIcon {background-size: contain; width: 100%; max-width: 310px; height: 150px; background-repeat: no-repeat; background-position: 50% 50%; margin-left: 15px;}.jimu-widget-InfoSummary-setting .claro .dijitTextBox .dijitInputInner{font-size: 4px;}.jimu-widget-InfoSummary-setting .noMargin {margin-left: 0px; padding-left: 0px;}.jimu-widget-InfoSummary-setting .margin2 {margin-left: 2px;}.jimu-rtl .jimu-widget-InfoSummary-setting .margin2 {margin-right: 2px;}.jimu-widget-InfoSummary-setting .extraMargin {padding-left: 21px;}.jimu-widget-InfoSummary-setting .lyrSymbolSelected {outline: 1px solid #2196F3; background-color: aliceblue;}.jimu-widget-InfoSummary-setting .text-disabled {color: #a0acbf;}.jimu-widget-InfoSummary-setting .note-help {padding-left: 10px; font-style: italic;}.jimu-rtl .jimu-widget-InfoSummary-setting .note-help {padding-right: 10px; font-style: italic;}.jimu-widget-InfoSummary-setting .help-on {display: block;}.jimu-widget-InfoSummary-setting .help-off {display: none;}.jimu-widget-InfoSummary-setting .groupByOptions {}.jimu-rtl .jimu-widget-InfoSummary-setting .groupByOptions {}.jimu-widget-InfoSummary-setting .rdoGroupField{vertical-align: middle;}.jimu-widget-InfoSummary-setting .fieldSet {height: auto; width: 100%; border: 1px solid #a0acbf; border-radius: 5px; font-size: 14px; color: #596679; margin-bottom: 10px; min-width: 0px;}.jimu-widget-InfoSummary-setting .optionsFieldSet {padding: 15px 0px;}.jimu-widget-InfoSummary-setting .fieldSetLegend {margin-left: 20px;}.jimu-widget-InfoSummary-setting .padBottom20 {padding-bottom: 20px;}.jimu-widget-InfoSummary-setting .feature-display {padding-top: 10px; padding-bottom: 10px;}.jimu-widget-InfoSummary-setting .field-error {float: right; line-height: 0;}.jimu-rtl .jimu-widget-InfoSummary-setting .field-error {float: left; line-height: 0;}",
"*now":function(l){l(['dojo/i18n!*preload*widgets/InfoSummary/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/query dojo/dom-construct dojo/dom-class dojo/_base/declare dojo/_base/xhr dojo/_base/Color dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/LayerInfos/LayerInfos dijit/form/ValidationTextBox dijit/form/CheckBox jimu/dijit/CheckBox jimu/dijit/Popup jimu/dijit/SimpleTable jimu/dijit/ImageChooser jimu/utils jimu/dijit/Message jimu/dijit/LayerChooserFromMapWithDropbox jimu/dijit/LoadingShelter esri/request dijit/popup dojo/_base/lang dojo/DeferredList dojo/Deferred dojo/on dojo/dom-style dojo/_base/html dojo/_base/array ./MySymbolPicker ./UniqueLayerChooser dojox/form/FileUploader".split(" "),function(l,
q,p,n,b,a,f,k,d,m,y,g,w,u,x,t,C,L,A,I,G,z,H,O,B,E,c,F,K,M){return n([k,f],{baseClass:"jimu-widget-InfoSummary-setting",_layerInfos:null,mpi:null,layer_options:[],refreshLayers:[],displayPanelIcon:!1,used_layers:[],unsupported_ids:[],postCreate:function(){this.inherited(arguments);this.opLayers=this.map.itemInfo.itemData.operationalLayers;0===this.opLayers.length?(E.set(this.btnAddLayer,"display","none"),E.set(this.optionsContainer,"display","none"),E.set(this.displayOptionsContainer,"display","none"),
this._disableOk(),new C({message:this.nls.missingLayerInWebMap})):(this.shelter=new A({hidden:!0}),this._initCheckBoxes(),this.setupLayerTable(),this.setupRefreshInterval(),this._getAllLayers(),this.own(B(this.btnAddLayer,"click",z.hitch(this,this._addLayerRow))),this.own(B(this.hidePanelOptions,"change",z.hitch(this,function(a){this.hidePanel=a;this.panelCountOptions.setStatus(!a);this.panelIconOptions.setStatus(!a);this.expandListOptions.setStatus(!a);this.showAllFeaturesOptions.setStatus(!a);if(a){this.displayPanelIcon=
!1;if(a=l(".mainPanelPreviewContainerOn",this.mainPanelPreviewContainer.domNode)[0])c.removeClass(a,"mainPanelPreviewContainerOn"),c.addClass(a,"mainPanelPreviewContainerOff");p.contains(this.hidePanelHelpText,"help-off")&&c.removeClass(this.hidePanelHelpText,"help-off");c.addClass(this.hidePanelHelpText,"help-on")}else this.panelIconOptions.getValue()&&(this.displayPanelIcon=!0,a=l(".mainPanelPreviewContainerOff",this.mainPanelPreviewContainer.domNode)[0])&&(c.removeClass(a,"mainPanelPreviewContainerOff"),
c.addClass(a,"mainPanelPreviewContainerOn")),p.contains(this.hidePanelHelpText,"help-on")&&c.removeClass(this.hidePanelHelpText,"help-on"),c.addClass(this.hidePanelHelpText,"help-off")}))),this.own(B(this.panelIconOptions,"change",z.hitch(this,this._updatePanelIcon))))},_updatePanelIcon:function(){var a=(this.displayPanelIcon=this.panelIconOptions.getValue())?"mainPanelPreviewContainerOff":"mainPanelPreviewContainerOn",b=l("."+a,this.mainPanelPreviewContainer.domNode)[0];b&&(c.removeClass(b,a),c.addClass(b,
this.displayPanelIcon?"mainPanelPreviewContainerOn":"mainPanelPreviewContainerOff"))},_initCheckBoxes:function(){this.panelCountOptions=this._initCheckBox(this.nls.panelCountOption,this.div_panelCountOptions);this.panelIconOptions=this._initCheckBox(this.nls.panelIconOption,this.div_panelIconOptions);this.expandListOptions=this._initCheckBox(this.nls.expandList,this.div_expandListOptions);this.showAllFeaturesOptions=this._initCheckBox(this.nls.showAllFeatures,this.div_showAllFeaturesOptions);this.hidePanelOptions=
this._initCheckBox(this.nls.hidePanel,this.div_hidePanelOptions);this.displayClusterLayerOptions=this._initCheckBox(this.nls.displayClusterLayer,this.div_displayClusterLayerOptions);!this.config.hasOwnProperty("displayClusterLayer")||this.config.displayClusterLayer?this.displayClusterLayerOptions.check():this.config.displayClusterLayer||this.displayClusterLayerOptions.uncheck()},_initCheckBox:function(a,b){var c=new g;c.setLabel(a);c.placeAt(b);return c},startup:function(){this.inherited(arguments);
this.refreshLayers=[];this.imageChooser=new x({format:[x.GIF,x.JPEG,x.PNG],label:this.nls.uploadImage,cropImage:!1,showTip:!1,goldenWidth:10,goldenHeight:15});E.set(this.imageChooser.domNode,"font-size","14px");c.place(this.imageChooser.domNode,this.mainPanelPreviewButton,"replace");this.connect(this.imageChooser,"onImageChange","uploadImage");this.isInitalLoad=!1},setupRefreshInterval:function(){this.refreshInterval.invalidMessage=this.nls.invalidInterval;this.refreshInterval.missingMessage=this.nls.missingRefreshValue},
setupLayerTable:function(){this.displayLayerTable=new u({fields:[{name:"layer",title:this.nls.layerName,"class":"label",type:"empty",width:"320px"},{name:"label","class":"label",title:this.nls.layerLabel,type:"empty",width:"255px"},{name:"image","class":"label",title:this.nls.iconColumnText+" "+this.nls.optionsText,width:"110px",actions:["edit"],type:"actions"},{name:"refresh","class":"label",title:this.nls.layerRefresh,type:"empty",width:"80px"},{name:"actions","class":"label",title:this.nls.actions,
type:"actions",actions:["up","down","delete"],width:"93px"}],selectable:!1,autoHeight:!0});this.displayLayerTable.placeAt(this.layerTable);this.displayLayerTable.startup();this.own(B(this.displayLayerTable,"actions-edit",z.hitch(this,this._pickSymbol)));this.own(B(this.displayLayerTable,"row-delete",z.hitch(this,this._rowDeleted)))},_getAllLayers:function(){this.map.itemId&&d.getInstance(this.map,this.map.itemInfo).then(z.hitch(this,function(a){this.operLayerInfos=a;this.wmLayerInfos=a.getLayerInfoArrayOfWebmap();
this.configLayerInfos=this.config.layerInfos;this._updateLayerIDs();this.config.upgradeFields&&this._upgradeFields();this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this._setLayers(a.getLayerInfoArray()).then(z.hitch(this,function(){this.setConfig(this.config);this.shelter.hide()}))}))},_updateLayerIDs:function(){var a=[],b=0;for(;b<this.configLayerInfos.length;b++){var c=this.configLayerInfos[b],e=this.operLayerInfos.getLayerInfoById(c.id);if(!e){var d=!1,g=0;b:for(;g<
this.wmLayerInfos.length;g++){var f=this.wmLayerInfos[g],k=f?f.originOperLayer:void 0,l=this._compareURL(k,c),k=this._compareItemID(k,c),f=this._compareSubId(f,c);if(e=(l=l?l:k?k:f?f:void 0)?this.operLayerInfos.getLayerInfoById(l):e){this.configLayerInfos[b].id=e.id;this.configLayerInfos[b].layer=e.id;d=!0;break b}}d||e||a.push(b)}}0<a.length&&(a.sort(function(a,b){return b-a}),F.forEach(a,z.hitch(this,function(a){this.configLayerInfos.splice(a,1)})))},_compareSubId:function(a,b){if(a&&a.subId&&-1<
a.subId.indexOf(b.id)&&a.layerObject){var c=this._compareGeom(a.layerObject,b);b=this._compareFields(a.layerObject,b);if(c&&b)return a.subId}},_compareItemID:function(a,b){if(a&&a.itemId&&a.itemId===b.itemId&&a.featureCollection&&a.featureCollection.layers&&a.featureCollection.layers.hasOwnProperty("length")){a=a.featureCollection.layers;for(var c=0;c<a.length;c++){var e=a[c];if(this._compareGeom(e,b)&&this._compareFields(e,b))return e.id}}},_compareURL:function(a,b){return a&&a.url&&b.url&&a.url===
b.url?a.id:void 0},_compareGeom:function(a,b){return a&&a.geometryType&&b.geometryType?a.geometryType===b.geometryType:void 0},_compareFields:function(a,b){var c;a&&a.fields&&b.fields&&a.fields.length===b.fields.length&&(c=a.fields.filter(function(a){for(var c=0;c<b.fields.length;c++)if(a.name===b.fields[c].name)return a}).length===a.fields.length);return c},_setLayers:function(a){var b=new O,d=["esri.layers.WMSLayer","esri.layers.ArcGISImageServiceLayer","esri.layers.ArcGISImageServiceVectorLayer",
"esri.layers.ArcGISTiledMapServiceLayer","ClusterLayer"];this.gtQueries=[];this.gtQueryUrls=[];for(var e=[],h=[],g={},f=0;f<a.length;f++){var k=a[f],l=k.layerObject.hasOwnProperty("supportsDynamicLayers")?k.layerObject.supportsDynamicLayers:!0,m=k.layerObject.declaredClass,n=this._checkItemId(k,m);if(-1===d.indexOf(m)){var p=k.getRootLayerInfo();if(-1===h.indexOf(p.id)){h.push(p.id);var q=[],t=[];p.traversal(z.hitch(this,function(a){if(a.newSubLayers&&0<a.newSubLayers.length)-1===q.indexOf(p.id)&&
q.push(p.id),-1===q.indexOf(a.id)&&(q.push(a.id),t.unshift(a.title));else{var b=a.layerObject.geometryType;"undefined"===typeof b&&(b=this.setGeometryType(a.layerObject));var c=a.getUrl(),d;d=c?-1<c.indexOf("MapServer")?"Map Service Layer":"":"esri.layers.FeatureCollection"===m||"Feature Collection"===m||n?"Feature Collection":"";var h=a.layerObject.renderer,f=!1;if(p.layerObject&&p.layerObject.layerDrawingOptions){var k=p.layerObject.layerDrawingOptions;"undefined"!==typeof a.subId&&a.subId<k.length&&
k.hasOwnProperty(a.subId)&&(k=k[a.subId])&&k.renderer&&(h=k.renderer,f=!0)}var D=k=a.getInfoTemplate(),N=!0;try{z.clone(k)}catch(S){N=!1,k.constructor&&k.toJson&&(D=new k.constructor(k.toJson()))}N||(g[a.id]=D);e.push({label:0<t.length?t.join("-")+"-"+a.title:a.title,value:a.id,url:c,imageData:a.imageData,id:a.id,geometryType:b,fields:a.layerObject.fields,_type:m,renderer:h,rendererJson:h&&h.toJson?JSON.stringify(h.toJson()):!1,bypassDrawingInfo:f,itemId:n,infoTemplate:N?D:void 0,lyrType:d,panelImageData:a.panelImageData,
supportsDynamic:l,oidFieldName:a.layerObject.objectIdField,parentLayerID:p.id,subLayerId:c?parseInt(c.substr(c.lastIndexOf("/")+1),10):void 0,scaleRange:a.getScaleRange(),selfType:a.originOperLayer.selfType})}}))}}}this.layer_options=z.clone(e);F.forEach(Object.keys(g),z.hitch(this,function(a){var b=0;a:for(;b<this.layer_options.length;b++){var c=this.layer_options[b];if(c.id===a){c.infoTemplate=g[a];break a}}}));0<this.gtQueries.length?(a=new H(this.gtQueries),c.removeClass(this.btnAddLayer,"btn-add-section enable"),
c.addClass(this.btnAddLayer,"btn-add-section-disabled"),a.then(z.hitch(this,function(a){var d=[];if(a&&0<a.length){for(var e=0;e<a.length;e++){for(var h=a[e][1],g=this.gtQueryUrls[e],f,k=0;k<this.layer_options.length;k++)if(g===this.layer_options[k].url){f=k;break}if("undefined"!==typeof f)if(h.geometryType){if(this.layer_options[f].geometryType=h.geometryType,"undefined"!==typeof h.drawingInfo){this.layer_options[f].bypassDrawingInfo||(this.layer_options[f].renderer=h.drawingInfo.renderer,this.layer_options[f].drawingInfo=
h.drawingInfo);this.layer_options[f].fields=h.fields;for(var D,g=0;g<h.fields.length&&(D=h.fields[g],"esriFieldTypeOID"!==D.type);g++);this.layer_options[f].oidFieldName=D.name}}else d.push(f)}c.removeClass(this.btnAddLayer,"btn-add-section-disabled");c.addClass(this.btnAddLayer,"btn-add-section enable")}F.forEach(d.reverse(),z.hitch(this,function(a){this.unsupported_ids.push(this.layer_options[a].id);this.layer_options.splice(a,1)}));b.resolve()}))):b.resolve();return b},_checkItemId:function(a,
b){var c;if("esri.layers.FeatureCollection"===b)c=(c=a.isItemLayer())&&c.itemId?c.itemId:c;else if("esri.layers.FeatureLayer"===b||"FeatureLayer"===b)a:for(b=0;b<this.opLayers.length;b++){var e=this.opLayers[b];if(e&&e.id&&(e.id===a.id||-1<a.id.indexOf(e.id))){b=e.type;"Feature Collection"===b&&(c=e.itemId);break a}}return c},setConfig:function(a){this.config=a;if(!this.config.mapID||this.config.mapID&&this.config.mapID===this.map.itemId){this.oldConfig=!this.config.mapID;this.config.mainPanelText&&
this.mainPanelText.set("value",this.config.mainPanelText);this.config.mainPanelIcon&&(this.panelMainIcon.innerHTML=this.config.mainPanelIcon);this.config.refreshInterval&&this.refreshInterval.set("value",this.config.refreshInterval);this.config.loadStaticData&&this.chkStatic.set("value",this.config.loadStaticData);this.config.countEnabled&&this.panelCountOptions.setValue(this.config.countEnabled);this.config.displayPanelIcon&&(this.panelIconOptions.setValue(this.config.displayPanelIcon),this._updatePanelIcon());
this.config.expandList&&this.expandListOptions.setValue(this.config.expandList);this.config.hasOwnProperty("displayCluster")?this.displayClusterLayerOptions.set("value",this.config.displayClusterLayer):this.displayClusterLayerOptions.set("value",!0);this.showAllFeaturesOptions.setValue("undefined"===typeof this.config.showAllFeatures?!1:this.config.showAllFeatures);this.hidePanel="undefined"!==typeof this.config.hidePanel?this.config.hidePanel:!1;this.hidePanelOptions.setValue(this.hidePanel);this.panelCountOptions.setStatus(!this.hidePanel);
this.panelIconOptions.setStatus(!this.hidePanel);this.expandListOptions.setStatus(!this.hidePanel);this.showAllFeaturesOptions.setStatus(!this.hidePanel);this.hidePanel?(p.contains(this.hidePanelHelpText,"help-off")&&c.removeClass(this.hidePanelHelpText,"help-off"),c.addClass(this.hidePanelHelpText,"help-on")):(p.contains(this.hidePanelHelpText,"help-on")&&c.removeClass(this.hidePanelHelpText,"help-on"),c.addClass(this.hidePanelHelpText,"help-off"));this.displayLayerTable.clear();this.isInitalLoad=
!0;for(a=0;a<this.config.layerInfos.length;a++)this._populateLayerRow(this.config.layerInfos[a],a);this._updateLayerLists();a=this.displayLayerTable.getRows();for(var b=0;b<a.length;b++)this._updateRefresh(a[b]);this.displayLayerTable.getRows().length<this.layer_options.length?(c.removeClass(this.btnAddLayer,"btn-add-section-disabled"),c.addClass(this.btnAddLayer,"btn-add-section enable")):(c.addClass(this.btnAddLayer,"btn-add-section-disabled"),c.removeClass(this.btnAddLayer,"btn-add-section enable"))}},
_upgradeFields:function(){if(this.config.layerInfos)for(var a=0;a<this.config.layerInfos.length;a++){var b=this.config.layerInfos[a];if(b&&b.symbolData&&b.symbolData.featureDisplayOptions){var c=this.operLayerInfos.getLayerInfoById(b.id),e=b.symbolData.featureDisplayOptions.fields;if("undefined"===typeof e||e.hasOwnProperty("length")&&0===e.length){var d=c&&c.layerObject?c.layerObject:void 0,e=d&&d.objectIdField?d.objectIdField:void 0,g="",f="";if((d=b.fields?b.fields:d?d.fields:void 0)&&0<d.length){var k=
0;a:for(;k<d.length;k++){var l=d[k];""===g&&"esriFieldTypeOID"!==l.type&&"esriFieldTypeGeometry"!==l.type&&l.name!==e&&(g=l.name,f=l.alias||l.name);e||(e="esriFieldTypeOID"===l.type?l.name:void 0);if(e&&""!==g)break a}}k=d="";b=b.infoTemplate&&b.infoTemplate.info&&b.infoTemplate.info.fieldInfos?b.infoTemplate:c?c.getInfoTemplate():void 0;if(!b)a:for(c=c.getSubLayers(),l=0;l<c.length;l++){var m=c[l];if(m.title&&m.layerObject&&m.layerObject.name&&m.title===m.layerObject.name){b=m.getInfoTemplate?m.getInfoTemplate():
b;break a}}c=b?b.info.fieldInfos:[];b=0;a:for(;b<c.length;b++)if((l=c[b])&&l.visible&&(!e||e!==l.fieldName)){d=l.fieldName;k=l.label||l.fieldName;break a}this.config.layerInfos[a].symbolData.featureDisplayOptions.fields=[{name:d?d:g,label:d?k:f}]}}}},_updateStyleColor:function(a){var c=this.appConfig.theme.name,d=this.appConfig.appId;""===d&&(d=window.location.href.split("id\x3d")[1]);b.get({url:"./apps/"+d+"/themes/"+c+"/manifest.json",sync:!0,handleAs:"json",load:z.hitch(this,function(b){b=b.styles;
for(var c=0;c<b.length;c++){var d=b[c];if(d.name===a){this._styleColor=d.styleColor;this._styleColorName=d.name;break}}})})},updateThemeClusterSymbol:function(b,c){var d=b.symbolData;this.appConfig.theme.styles&&this.appConfig.theme.styles[0]&&"undefined"===typeof this._styleColor&&this._updateStyleColor(this.appConfig.theme.styles[0]);if(this._styleColor){var e=a.fromHex(this._styleColor);c+=1;var h=0<c?30*c:30,g=0===c%2,f=e.g,k=e.b,e=e.r-h;g&&(255<e?e-=255:0>e&&(e+=255));k-=h;0===c%3&&g&&(255<k?
k-=255:0>k&&(k+=255));h=f-h;0===c%5&&g&&(255<h?h-=255:0>h&&(h+=255));d.clusterType="CustomCluster";d.clusterSymbol={color:[e,h,k,128],outline:{color:[0,0,0,255],width:0,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"};b.symbolData=d}return b},_rowDeleted:function(a){a&&(a=a.selectLayers.getSelectedItem())&&a.layerInfo&&a.layerInfo.id&&this._removeRefreshLayer(a.layerInfo.id);this._updateLayerLists();this.displayLayerTable.getRows().length<this.layer_options.length&&(c.removeClass(this.btnAddLayer,
"btn-add-section-disabled"),c.addClass(this.btnAddLayer,"btn-add-section enable"))},_addLayerRow:function(){this.isInitalLoad=!1;if(!(this.displayLayerTable.getRows().length>=this.layer_options.length)){this.shelter.show();var a=this.displayLayerTable.addRow({});a.success&&a.tr&&(a=a.tr,c.addClass(a.cells[2],"displayOptions"),this._addLayersOption(a),this._addLabelOption(a),this._addRefreshOption(a),this._setNextLayer(a.selectLayers),this._updateLayerLists());this.shelter.hide();this.displayLayerTable.getRows().length>=
this.layer_options.length&&(c.removeClass(this.btnAddLayer,"btn-add-section enable"),c.addClass(this.btnAddLayer,"btn-add-section-disabled"))}},_setNextLayer:function(a){for(var b,c=0;c<this.layer_options.length;c++){var d=this.layer_options[c];if(-1===this.used_layers.indexOf(d.id)){b=d.id;break}}b&&(b=this.operLayerInfos.getLayerInfoById(b))&&b.getLayerObject().then(z.hitch(this,function(b){a.setSelectedLayer(b)}))},_populateLayerRow:function(a,b){var d=this.displayLayerTable.addRow({});if(d.success&&
d.tr){var e=d.tr;c.addClass(e.cells[2],"displayOptions");this._addLayersOption(e);this._addLabelOption(e);this._addRefreshOption(e);this.operLayerInfos.getLayerInfoById(a.id).getLayerObject().then(z.hitch(this,function(c){e.selectLayers.setSelectedLayer(c).then(z.hitch(this,function(){"ThemeCluster"===a.symbolData.clusterType&&(a=this.updateThemeClusterSymbol(a,b));var c=this._getLayerOptionByValue(e);c.filter=a.filter;c.imageData=a.imageData;c.symbolData=a.symbolData;e.symbolData=a.symbolData;this.validateFields(e.symbolData,
e)}))}));e.labelText.set("value",a.label);e.refreshBox.set("checked",a.refresh);e.imageData=a.panelImageData;(d=l(".imageDataGFX",e.cells[2])[0])&&e.cells[2].removeChild(d);q.create("div",{"class":"imageDataGFX margin2",innerHTML:[a.imageData],title:this.nls.iconColumnText},e.cells[2])}},_addLayersOption:function(a){var b=this._createLayerChooserSelect(a);b&&(b.tr=a,b.parent=this,a.selectLayers=b)},_createLayerChooserSelect:function(a){var b=l(".simple-table-cell",a)[0],c;b&&(a=new M({showTable:!1,
onlyShowVisible:!1,createMapResponse:this.map.webMapResponse,parent:this,row:a}),a.startup(),c=new L({layerChooser:a}),c.placeAt(b),c.startup(),this.own(B(c,"selection-change",this._onLayerChanged)));return c},_onLayerChanged:function(){var a=this.getSelectedItem();a&&(a=a&&a.layerInfo&&a.layerInfo.id?a.layerInfo.id:void 0,this.tr.layerID&&a&&a!==this.tr.layerID&&(this.parent._removeRefreshLayer(this.tr.layerID),this.tr.refreshBox.set("checked",!1)),this.tr.layerID=a,this.parent.isInitalLoad||(z.hitch(this.parent,
this.parent._updateRefresh(this.tr)),z.hitch(this.parent,this.parent._updateLayerLists()),z.hitch(this.parent,this.parent._addDefaultSymbol(this.tr)),this.tr.labelText.set("value","")))},_updateLayerLists:function(){this.used_layers=[];for(var a=this.displayLayerTable.getRows(),b=0;b<a.length;b++){var c=a[b],d=c.selectLayers.getSelectedItem();d&&d.layerInfo&&d.layerInfo.id&&(this.used_layers.push(d.layerInfo.id),c.layerID=d.layerInfo.id)}for(b=0;b<a.length;b++)a[b].selectLayers.layerChooser._onLayerInfosChanged()},
_addLabelOption:function(a){var b=l(".simple-table-cell",a)[1];c.setStyle(b,"verticalAlign","middle");c.setStyle(b,"line-height","inherit");var d=new m({style:{width:"100%",height:"28px"}});d.placeAt(b);d.startup();a.labelText=d},_addRefreshOption:function(a){var b=l(".simple-table-cell",a)[3];c.setStyle(b,"verticalAlign","middle");c.setStyle(b,"line-height","inherit");var d=new y({"class":"checkBox",onChange:function(a){var b=this.tr.selectLayers.getSelectedItem();b&&b.layerInfo&&b.layerInfo.id&&
(a?this.parent._addRefreshLayer(b.layerInfo.id):this.parent._removeRefreshLayer(b.layerInfo.id))}});d.placeAt(b);d.startup();d.parent=this;d.tr=a;a.refreshBox=d;this._updateRefresh(a)},_addRefreshLayer:function(a){this.refreshLayers.push(a);if(a=l(".refreshOff",this.refreshOptions.domNode)[0])c.removeClass(a,"refreshOff"),c.addClass(a,"refreshOn");this.refreshInterval.isValid()||this._disableOk()},_removeRefreshLayer:function(a){a=this.refreshLayers.indexOf(a);if(-1<a&&(this.refreshLayers.splice(a,
1),0===this.refreshLayers.length)){if(a=l(".refreshOn",this.refreshOptions.domNode)[0])c.removeClass(a,"refreshOn"),c.addClass(a,"refreshOff");this._enableOk()}},_updateRefresh:function(a){var b=this._getLayerOptionByValue(a);a&&a.refreshBox&&(a=a.refreshBox,b&&"Feature Collection"===b.lyrType&&b.itemId?(a.set("disabled",!1),a.set("title",this.nls.enableRefresh)):(a.set("disabled",!0),a.set("title",this.nls.disableRefresh)))},_updateOK:function(){this.refreshInterval.isValid()?this._enableOk():this._disableOk()},
_disableOk:function(){var a=l(".button-container")[0];E.set(a.children[2],"display","none");E.set(a.children[3],"display","inline-block")},_enableOk:function(){var a=l(".button-container")[0];E.set(a.children[2],"display","inline-block");E.set(a.children[3],"display","none")},_addDefaultSymbol:function(a){var b=l(".simple-table-cell",a)[0];this.curRow=a;if(b){c.setStyle(b,"line-height","inherit");c.setStyle(b,"margin-left","0px");var b=this._getLayerOptionByValue(a),d=a.selectLayers.getSelectedItem();
if(d&&d.layerInfo){var d=d.layerInfo.id,e=!1;"undefined"!==typeof this.curRow.symbolData&&(e=this.curRow.symbolData,e=e.userDefinedSymbol&&e.layerId===d);e&&"undefined"!==typeof b.symbolData?((a=l(".imageDataGFX",this.curRow.cells[2])[0])&&this.curRow.cells[2].removeChild(a),this.curRow.symbolData=b.symbolData,this.validateFields(this.curRow.symbolData,this.curRow),a=q.create("div",{"class":"imageDataGFX margin2"},this.curRow.cells[2]),a.appendChild(this.curRow.symbolData.svg),this.curRow.imageData=
this.curRow.symbolData.panelHTML):(b=new K({nls:this.nls,callerRow:a,layerInfo:b,value:d,symbolInfo:e?this.curRow.symbolData:b.symbolData,map:this.map,ac:this.appConfig,hidePanel:this.hidePanel,loadSymbolPicker:!1}),b._setSymbol(),(a=l(".imageDataGFX",this.curRow.cells[2])[0])&&this.curRow.cells[2].removeChild(a),this.curRow.symbolData=b.symbolInfo,this.validateFields(this.curRow.symbolData,this.curRow),a=q.create("div",{"class":"imageDataGFX margin2"},this.curRow.cells[2]),null!==this.curRow.symbolData.svg&&
"undefined"!==typeof this.curRow.symbolData.svg&&a.appendChild(this.curRow.symbolData.svg),this.curRow.imageData=this.curRow.symbolData.panelHTML,this.curRow=null,b.destroy(),b=null)}}},_getLayerOptionByValue:function(a){if(a=(a=a.selectLayers.getSelectedItem())&&a.layerInfo?a.layerInfo.id:void 0)for(var b=0;b<this.layer_options.length;b++){var c=this.layer_options[b];if(c.id===a)return c}},validateFields:function(a,b){a=a&&a.featureDisplayOptions&&a.featureDisplayOptions.fields?0<a.featureDisplayOptions.fields.length:
!1;var c=l(".simple-table-cell",b)[4];c&&!a?b.errorDiv?E.set(b.errorSpan,"display","inline-block"):(b.errorDiv=q.create("div",{"class":"field-error"},c),b.errorSpan=q.create("span",{"class":"jimu-icon jimu-icon-error",title:this.nls.fieldsWarning},b.errorDiv)):a&&b.errorSpan&&E.set(b.errorSpan,"display","none")},_pickSymbol:function(a){var b=this._getLayerOptionByValue(a);this.curRow=a;var c=new K({nls:this.nls,callerRow:a,layerInfo:b,value:b.id,symbolInfo:"undefined"!==typeof this.curRow.symbolData?
this.curRow.symbolData:b.symbolData,map:this.map,ac:this.appConfig,hidePanel:this.hidePanel,loadSymbolPicker:!0}),d=new w({width:420,autoHeight:!0,content:c,titleLabel:this.nls.sympolPopupTitle});this.own(B(c,"customSymbolButtonClicked",z.hitch(this,function(){p.add(c.btnOk,"jimu-state-disabled")})));this.own(B(c,"onImageSelected",z.hitch(this,function(){p.remove(c.btnOk,"jimu-state-disabled")})));this.own(B(c,"enableOkButton",z.hitch(this,function(){p.remove(c.btnOk,"jimu-state-disabled")})));this.own(B(c,
"ok",z.hitch(this,function(a){if(!p.contains(c.btnOk,"jimu-state-disabled")){var b=l(".imageDataGFX",this.curRow.cells[2])[0];b&&this.curRow.cells[2].removeChild(b);this.curRow.symbolData=a;this.validateFields(this.curRow.symbolData,this.curRow);q.create("div",{"class":"imageDataGFX margin2"},this.curRow.cells[2]).appendChild(a.svg);this.curRow.imageData=a.panelHTML;this.curRow=null;c.destroy();c=null;d.close()}})));this.own(B(c,"cancel",z.hitch(this,function(){this.curRow=null;c.destroy();c=null;
d.close()})))},setGeometryType:function(a){var b=!0,c;if(a.url&&a.url.indexOf)-1<a.url.indexOf("MapServer")&&(this.gtQueries.push(I({url:a.url+"?f\x3djson"})),this.gtQueryUrls.push(a.url));else if(a.featureInfos&&a.featureInfos.hasOwnProperty("length")){var d=["esriGeometryPoint","esriGeometryLine","esriGeometryPolygon"];F.forEach(a.featureInfos,function(a){a.type&&-1<d.indexOf(a.type)&&(c=a.type,c!==a.type&&(b=!1))})}return b&&c?c:void 0},uploadImage:function(a){this.panelMainIcon.innerHTML="";this.mpi=
a;q.create("div",{"class":"innerMainPanelIcon",style:"background-image: url("+a+");",title:this.nls.mainPanelIcon},this.panelMainIcon)},getConfig:function(){G.close();var a=this.displayLayerTable.getRows(),b=[],c;F.forEach(a,z.hitch(this,function(a){var d,e=a.selectLayers.getSelectedItem();e&&e.layerInfo&&e.layerInfo.id&&(d=e.layerInfo.id);var e=t.stripHTML(a.labelText.value),g=a.refreshBox,f=this._getLayerOptionByValue(a),h=a.symbolData?a.symbolData:f.symbolData;c={layer:d,label:""!==e?e:f.label,
refresh:g.getValue(),url:f.url,type:f.type,id:f.id,symbolData:h,geometryType:f.geometryType,itemId:f.itemId,parentLayerID:f.parentLayerID,renderer:f.renderer,drawingInfo:f.drawingInfo,fields:f.fields,oidFieldName:f.oidFieldName,subLayerId:f.subLayerId,infoTemplate:f.infoTemplate,rendererJson:f.rendererJson,bypassDrawingInfo:f.bypassDrawingInfo};a.imageData&&(c.panelImageData=a.imageData);a=l(".imageDataGFX",a)[0];c.imageData="undefined"!==typeof a?a.innerHTML:"\x3cdiv\x3e\x3c/div\x3e";b.push(c)}));
this.config.mapID=this.map.itemId;this.config.layerInfos=b;this.config.mainPanelText=t.stripHTML(this.mainPanelText.value);this.config.mainPanelIcon=this.panelMainIcon.innerHTML;this.config.refreshInterval=t.stripHTML(this.refreshInterval.value);this.config.refreshEnabled=0<this.refreshLayers.length?!0:!1;this.config.countEnabled=this.panelCountOptions.getValue();this.config.displayPanelIcon=this.panelIconOptions.getValue();this.config.hidePanel=this.hidePanelOptions.getValue();this.config.continuousRefreshEnabled=
this.hidePanelOptions.getValue();this.config.expandList=this.expandListOptions.getValue();this.config.showAllFeatures=this.showAllFeaturesOptions.getValue();this.config.upgradeFields=!1;this.config.displayClusterLayer=this.displayClusterLayerOptions.checked;return this.config},destroy:function(){G.close();this.inherited(arguments)}})});